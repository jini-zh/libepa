<!DOCTYPE html>
<html>
  <head>
    <title>libepa Programmer Reference</title>
    <meta charset="utf-8">
<style>
span.type {
  color: green;
  font-weight: bold;
}

span.literal {
  color: magenta
}

span.comment {
  color: blue;
}

span.macro {
  color: darkblue;
}

div.def {
  border: 1px solid black;
  margin: 5px;
  padding: 5px;
  overflow: auto;
}

div.def span.def {
  font-weight: bold
}

td {
  padding: 0px 1ex;
  white-space: nowrap;
}

div.table {
  overflow-x: scroll;
}

math {
  white-space: nowrap;
}

</style>
  </head>
  <body>

<h1><code>libepa</code> Programmer reference</h1>

<h2>Contents</h2>

<ul>
  <li><a href="#index">Index</a></li>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#assumptions">Assumptions</a></li>
  <li><a href="#notation">Notation</a></li>
  <li><a href="#overview">Overview</a></li>
  <li>
    <a href="#api">API Reference</a>
    <ul>
      <li>
        <a href="#epa"><code>EPA</code></a>
        <ul>
          <li><a href="#error-handling">Error handling</a></li>
          <li><a href="#epa-constants">Constants</a></li>
          <li><a href="#epa-integrators">Integrators</a></li>
          <li><a href="#epa-form-factors">Form factors</a></li>
          <li><a href="#epa-spectra">Equivalent photon spectra</a></li>
          <li><a href="#epa-luminosities">Luminosities</a></li>
          <li>
            <a href="#epa-xsections">
              Cross sections of ultraperipheral collisions
            </a>
          </li>
          <li>
            <a href="#epa-xsections-gg">
              Cross sections of photons fusion
            </a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#proton">Proton</a>
        <ul>
          <li><a href="#proton-constants">Constants</a></li>
          <li><a href="#proton-form-factors">Form Factor</a></li>
          <li><a href="#proton-spectrum">Equivalent photon spectrum</a></li>
          <li><a href="#proton-luminosity">Luminosity</a></li>
          <li><a href="#proton-xsection">Cross sections</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="index">Index</h2>

<ul>
  <li><a href="#alpha"><code>alpha</code></a></li>
  <li><a href="#amu"><code>amu</code></a></li>
  <li><a href="#barn"><code>barn</code></a></li>
  <li><a href="#cquad_integrator"><code>cquad_integrator</code></a></li>
  <li>
    <a href="#default_absolute_error"><code>default_absolute_error</code></a>
  </li>
  <li>
    <a href="#default_cquad_integration_limit">
      <code>default_cquad_integration_limit</code>
    </a>
  </li>
  <li><a href="#default_error_step"><code>default_error_step</code></a></li>
  <li>
    <a href="#default_integration_limit">
      <code>default_integration_limit</code>
    </a>
  </li>
  <li>
    <a href="#default_integration_method">
      <code>default_integration_method</code>
    </a>
  </li>
  <li><a href="#default_integrator"><code>default_integrator</code></a></li>
  <li>
    <a href="#default_relative_error"><code>default_relative_error</code></a>
  </li>
  <li><a href="#electron_charge"><code>electron_charge</code></a></li>
  <li><a href="#fm"><code>fm</code></a></li>
  <li><a href="#FormFactor"><code>FormFactor</code></a></li>
  <li><a href="#form_factor_dipole"><code>form_factor_dipole</code></a></li>
  <li><a href="#form_factor_monopole"><code>form_factor_monopole</code></a></li>
  <li><a href="#infinity"><code>infinity</code></a></li>
  <li><a href="#Integrator"><code>Integrator</code></a></li>
  <li><a href="#light_speed"><code>light_speed</code></a></li>
  <li><a href="#Luminosity"><code>Luminosity</code></a></li>
  <li><a href="#Luminosity_b"><code>Luminosity_b</code></a></li>
  <li><a href="#Luminosity_fid"><code>Luminosity_fid</code></a></li>
  <li><a href="#Luminosity_fid_b"><code>Luminosity_fid_b</code></a></li>
  <li><a href="#Luminosity_y"><code>Luminosity_y</code></a></li>
  <li><a href="#Luminosity_y_b"><code>Luminosity_y_b</code></a></li>
  <li><a href="#luminosity"><code>luminosity</code></a></li>
  <li><a href="#luminosity_b"><code>luminosity_b</code></a></li>
  <li><a href="#luminosity_fid"><code>luminosity_fid</code></a></li>
  <li><a href="#luminosity_fid_b"><code>luminosity_fid_b</code></a></li>
  <li><a href="#luminosity_y"><code>luminosity_y</code></a></li>
  <li><a href="#luminosity_y_b"><code>luminosity_y_b</code></a></li>
  <li><a href="#pi"><code>pi</code></a></li>
  <li><a href="#photons_to_fermions"><code>photons_to_fermions</code></a></li>
  <li>
    <a href="#photons_to_fermions_b"><code>photons_to_fermions_b</code></a>
  </li>
  <li>
    <a href="#photons_to_fermions_pT"><code>photons_to_fermions_pT</code></a>
  </li>
  <li>
    <a href="#photons_to_fermions_pT_b">
      <code>photons_to_fermions_pT_b</code>
    </a>
  </li>
  <li><a href="#planck"><code>planck</code></a></li>
  <li><a href="#Polarization"><code>Polarization</code></a></li>
  <li><a href="#pp_elastic_slope"><code>pp_elastic_slope</code></a></li>
  <li><a href="#pp_luminosity"><code>pp_luminosity</code></a></li>
  <li><a href="#pp_luminosity_b"><code>pp_luminosity_b</code></a></li>
  <li><a href="#pp_luminosity_fid"><code>pp_luminosity_fid</code></a></li>
  <li><a href="#pp_luminosity_fid_b"><code>pp_luminosity_fid_b</code></a></li>
  <li><a href="#pp_luminosity_y"><code>pp_luminosity_y</code></a></li>
  <li><a href="#pp_luminosity_y_b"><code>pp_luminosity_y_b</code></a></li>
  <li><a href="#pp_upc_probability"><code>pp_upc_probability</code></a></li>
  <li><a href="#pp_to_ppll"><code>pp_to_ppll</code></a></li>
  <li><a href="#pp_to_ppll_b"><code>pp_to_ppll_b</code></a></li>
  <li>
    <a href="#pp_to_ppll_b_integrator"><code>pp_to_ppll_b_integrator</code></a>
  </li>
  <li><a href="#ppx_luminosity_b"><code>ppx_luminosity_b</code></a></li>
  <li><a href="#ppx_luminosity_y_b"><code>ppx_luminosity_y_b</code></a></li>
  <li><a href="#ppx_luminosity_fid_b"><code>ppx_luminosity_fid_b</code></a></li>
  <li><a href="#print_backtrace"><code>print_backtrace</code></a></li>
  <li>
    <a href="#proton_dipole_form_factor">
      <code>proton_dipole_form_factor</code>
    </a>
  </li>
  <li>
    <a href="#proton_dipole_form_factor_lambda2">
      <code>proton_dipole_form_factor_lambda2</code>
    </a>
  </li>
  <li>
    <a href="#proton_dipole_spectrum"><code>proton_dipole_spectrum</code></a>
  </li>
  <li>
    <a href="#proton_dipole_spectrum_b_Dirac">
      <code>proton_dipole_spectrum_b_Dirac</code>
    </a>
  </li>
  <li>
    <a href="#proton_dipole_spectrum_Dirac">
      <code>proton_dipole_spectrum_Dirac</code>
    </a>
  </li>
  <li>
    <a href="#proton_magnetic_moment"><code>proton_magnetic_moment</code></a>
  </li>
  <li><a href="#proton_mass"><code>proton_mass</code></a></li>
  <li><a href="#proton_radius"><code>proton_radius</code></a></li>
  <li><a href="#qag_integrator"><code>qag_integrator</code></a></li>
  <li>
    <a href="#qag_integrator_generator">
      <code>qag_integrator_generator</code>
    </a>
  </li>
  <li><a href="#Spectrum"><code>Spectrum</code></a></li>
  <li><a href="#Spectrum_b"><code>Spectrum_b</code></a></li>
  <li><a href="#spectrum"><code>spectrum</code></a></li>
  <li><a href="#spectrum_b"><code>spectrum_b</code></a></li>
  <li><a href="#spectrum_b_dipole"><code>spectrum_b_dipole</code></a></li>
  <li><a href="#spectrum_b_monopole"><code>spectrum_b_monopole</code></a></li>
  <li><a href="#spectrum_b_point"><code>spectrum_b_point</code></a></li>
  <li><a href="#spectrum_dipole"><code>spectrum_dipole</code></a></li>
  <li><a href="#spectrum_monopole"><code>spectrum_monopole</code></a></li>
  <li><a href="#XSection"><code>XSection</code></a></li>
  <li><a href="#XSection_b"><code>XSection_b</code></a></li>
  <li><a href="#xsection"><code>xsection</code></a></li>
  <li><a href="#xsection_fid"><code>xsection_fid</code></a></li>
  <li><a href="#xsection_fid_b"><code>xsection_fid_b</code></a></li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>
  A charged particle at rest is surrounded by electric field which can be
  represented as a bunch of virtual photons with zero time component of the
  photons momenta. If the particle is moving with the speed close to the speed of
  light, momenta of the photons of its field acquire longitudinal component, so
  that the photons virtuality
  <math>
    <msup> <mi>q</mi> <mn>2</mn> </msup>
    <mo>&#8810;</mo>
    <msup> <mi>ω</mi> <mn>2</mn> </msup>
  </math>,
  where <math><mi>q</mi></math> is the photon 4-momentum, <math><mi>ω</mi></math>
  is the photon energy. Under the equivalent photon approximation (EPA), these
  photons are treated as real and are assumed to be distributed according to a
  known spectrum.
</p>

<p>
  In many experiments in high energy physics, collisions of two
  ultrarelativistic charged particles are studied. Particles often do not
  collide head-on, but rather pass at some distance from each other and collide
  with their electromagnetic fields. If both particles survive in the
  collision, such collision is called ultraperipheral. Ultraperipheral
  collisions (UPC) can be considered as photon-photon collisions with the
  photons meeting the requirements of the equivalent photon approximation.
</p>

<p>
  <code>libepa</code> is a library for calculation of cross sections of
  ultraperipheral collisions under the equivalent photon approximation. The
  cross sections are calculated as integrals over the convolution of the photon
  EPA spectra with the photon-photon cross section provided by the user. By
  default, the integration is performed with the help of GNU Scientific Library
  <a href="https://www.gnu.org/software/gsl">GSL</a>. The user can supply their
  own integration routines.
</p>

<h2 id="assumptions">Assumptions</h2>

<ul>
  <li>
    Equivalent photon approximation works. This requires that the colliding
    particle are ultrarelativistic
    (<math><mi>γ</mi> <mo>&#8811;</mo> <mn>1</mn></math>, where
    <math><mi>γ</mi></math> is the Lorentz factor). 
  </li>
  <li>
    No rescattering: produced particles do not interact with the source
    particles.
  </li>
  <li>
    The <code>*_b</code> family of functions deal with the case when the source
    particles interact non-electromagnetically (strongly or weakly). Other
    functions assume only electromagnetic interactions.
  </li>
</ul>

<h2 id="notation">Notation</h2>

<ul>
  <li>
    <math><mi>b</mi></math> &mdash; impact parameter of the collision or the
    distance to the source particle in the transverse plane.
  </li>
  <li>
    <math><mi>e</mi></math> &mdash;
    <a href="#electron_charge">elementary charge</a>.
  <li>
    <math>
      <mi>F</mi>
      <mo>(</mo>
      <msup> <mi>Q</mi> <mn>2</mn> </msup>
      <mo>)</mo>
    </math>
    &mdash; Dirac form factor of a particle.
  </li>
  <li>
     <math>
       <msub> <mi>I</mi> <mi>n</mi> </msub>
       <mo>(</mo> <mi>x</mi> <mo>)</mo>
     </math>
     &mdash; Modified Bessel function of the first kind.
  <li>
    <math>
      <msub> <mi>J</mi> <mi>n</mi> </msub>
      <mo>(</mo> <mi>x</mi> <mo>)</mo>
    </math>
    &mdash; Bessel function of the first kind.
  </li>
  <li>
    <math>
      <msub> <mi>K</mi> <mi>n</mi> </msub>
      <mo>(</mo> <mi>x</mi> <mo>)</mo>
    </math>
    &mdash; Modified Bessel function of the second kind (the Macdonald function).
  </li>
  <li>
    <math><mi>L</mi></math> &mdash; integrated photon-photon luminosity.
  <li>
    <math>
      <mi>n</mi> <mo>(</mo> <mi>ω</mi> <mo>)</mo>
    </math>,
    <math>
      <mi>n</mi> <mo>(</mo> <mi>b</mi>, <mi>ω</mi> <mo>)</mo>
    </math>
    &mdash; equivalent photon spectrum;
    <math>
      <mi>n</mi> <mo>(</mo> <mi>ω</mi> <mo>)</mo>
      <mo>=</mo>
      &int;
      <mi>n</mi> <mo>(</mo> <mi>b</mi>, <mi>ω</mi> <mo>)</mo>
      <msup><mtext>d</mtext> <mn>2</mn></msup> <mi>b</mi>
    </math>.
  </li>
  <li>
    <math> <msub> <mi>p</mi> <mi>T</mi> </msub> </math> &mdash; transverse
    momentum of a particle.
  </li>
  <li>
    <math>
      <msup> <mi>Q</mi> <mn>2</mn> </msup>
      <mo>=</mo>
      <msubsup> <mi>q</mi> <mo>&perp;</mo> <mn>2</mn> </msubsup>
      <mo>+</mo>
      <msup>
        <mrow> <mo>(</mo> <mi>ω</mi> <mo>/</mo> <mi>γ</mi> <mo>)</mo> </mrow>
        <mn>2</mn>
      </msup>
    </math>
    &mdash; photon 3-momentum squared.
  </li>
  <li>
    <math> <msub> <mi>q</mi> <mo>&perp;</mo> </msub></math> &mdash; transverse component
    of the photon momentum.
  </li>
  <li>
    <math><msqrt><mi>s</mi></msqrt></math> &mdash; invariant mass of the colliding
    photons (of the produced system); <math><mi>s</mi></math> is the Mandelstam
    variable for the photon-photon collision.
  </li>
  <li>
    <math><mi>y</mi></math> &mdash; rapidity.
  <li>
    <math><mi>Z</mi></math> &mdash; particle charge in units of elementary
    charge <math><mi>e</mi></math>.
  </li>
  <li>
    <math><mi>α</mi></math> &mdash; <a href="#alpha">fine structure constant</a>,
    <math>
      <mi>α</mi>
      <mo>=</mo>
      <msup> <mi>e</mi> <mn>2</mn> </msup>
      <mo>/</mo>
      <mn>4</mn>
      <mi>π</mi>
    </math>.
  </li>
  <li>
    <math><mi>γ</mi></math> &mdash; Lorentz factor of the source particle.
  </li>
  <li>
    <math><mi>η</mi></math> &mdash; pseudorapidity of a particle.
  <li>
    <math><mi>ω</mi></math> &mdash; photon energy.
  </li>
</ul>

<h2 id="overview">Overview</h2>

<p>
  <code>libepa</code> is build around anonymous (lambda) functions and their
  composition.  Consider calculation of the cross section for the production of
  a pair of muons with invariant mass 100 GeV in ultraperipheral collisions of
  two protons with the energy 13 TeV:
</p>
<pre>
    <span class="type">const double</span> muon_mass = <span class="literal">105.6583745e-3</span>; <span class="comment">// GeV</span>
    <span class="type">const double</span> collision_energy = <span class="literal">13e3</span>; <span class="comment">// GeV</span>
    <span class="type">const double</span> invariant_mass = <span class="literal">100</span>; <span class="comment">// GeV</span>
    <span class="type">auto</span> luminosity = <a href="#pp_luminosity">pp_luminosity</a>(collision_energy);
    <span class="type">auto</span> photons_to_muons = <a href="#photons_to_fermions">photons_to_fermions</a>(muon_mass);
    <span class="type">auto</span> cross_section = <a href="#xsection">xsection</a>(photons_to_muons, luminosity);
    <span class="type">double</span> result = cross_section(invariant_mass); <span class="comment">// barn</span>
</pre>
<p>
  Here <a href="#pp_luminosity">pp_luminosity</a> returns an anonymous function
  with the signature
  <code><span class="type">double</span> (<span class="type">double</span> rs)</code>.
  The function calculates photon-photon
  <a href="#luminosity">luminosity</a> in the proton-proton collision with the
  energy 13 TeV for the photons invariant mass <code>rs</code>
  (<math><msqrt> <mi>s</mi> </msqrt></math>, where <math><mi>s</mi></math> is
  the Mandelstam variable). The collision energy is captured by the function.
  <a href="#photons_to_fermions"><code>photons_to_fermions</code></a> returns a
  function with the same signature, but it calculates the cross section for the
  production of a pair of muons in barns taking the square of the muons
  invariant mass as the argument. These functions are passed to
  <a href="#xsection"><code>xsection</code></a> which returns a function with
  the same signature again, computing the wanted cross section
  (<code>xsection</code>'s function simply computes the product of the
  luminosity and the photon-photon cross section; other cross section functions
  are more complicated).
</p>

<p>
  Many functions calculate numerical integrals. For example,
  <a href="#pp_luminosity">pp_luminosity</a>
  calculates the integral of the product of photon spectra of the protons.
  Integration routines are decoupled from EPA calculations and are passed in
  forms of <a href="#Integrator"><em>integrators</em></a> &mdash; functions
  with the signature
  <code><span class="type">double</span>
    (<span class="type">const</span> std::function&lt;<span class="type">double</span> (<span class="type">double</span>)&gt;&amp; f, <span class="type">double</span> a, <span class="type">double</span> b)</code>.
  Integrator computes the integral of <code>f</code> from <code>a</code> to
  <code>b</code>. To denote (semi-)infinite intervals, <code>a</code> can be
  set to <code>-<a href="#infinity">infinity</a></code>, and <code>b</code> can
  be set to <code><a href="#infinity">infinity</a></code>. <code>libepa</code>
  uses GNU Scientific Library
  (<a href="https://www.gnu.org/software/gsl">GSL</a>)
  for integration and provides convenient functions producing integrators based
  on GSL algorithms, see
  <code><a href="#qag_integrator">qag_integrator</a></code> and
  <code><a href="#cquad_integrator">cquad_integrator</a></code>.
  GSL routines use estimations of absolute and relative errors to control the
  accuracy of calculation. Calculation continues until either the absolute or
  the relative change in the estimation of the integral value between
  succeeding iterations is less than the parameters <code>epsabs</code> or
  <code>epsrel</code>, see the
  <a href="https://www.gnu.org/software/gsl/doc/html/integration.html#qag-adaptive-integration">
    GSL documentation on numerical integration
  </a>. In <code>libepa</code>, these are referred to as
  <code>relative_error</code> and <code>absolute_error</code>. They are
  captured by integrators. Their default values used by the <code>libepa</code>
  wrappers are controlled by the variables
  <code><a href="#default_absolute_error">default_absolute_error</a></code> and
  <code><a href="#default_relative_error">default_relative_error</a></code>.
  Note that to correctly utilize <code>absolute_error</code>, one has to know
  the magnitude of the integral in advance. This is rather inconvenient, so by
  default this value is not used (<code>default_absolute_error</code> is set to
  0). The default value for <code>default_relative_error</code> is
  10<sup>-3</sup> meaning that the default accuracy of numerical integration
  should not be much worse than 0.1%.
</p>

<p>
  Many functions calculate manifold numerical integrals. For example,
  calculation of differential fiducial cross section taking into account the
  probability of strong interaction between the colliding particles (the
  survival probability also known as the survival factor) provided by the
  function <code><a href="#xsection_fid_b">xsection_fid_b</a></code> requires
  calculation of five-fold integrals of the phase space parameters, assuming
  that the photon spectra are known analytically. Add an extra level of
  integration if the integrated cross section is desired. In this case, to
  avoid accumulation of numerical errors, each inner integral has to be
  calculated with significantly greater accuracy than the outer integral. The
  recommended approach in this case is to reduce the
  <code>relative_error</code> parameter for each inner integral by
  an order of magnitude. In <code>libepa</code> functions, this reduction is controlled by
  the <code><a href="#default_error_step">default_error_step</a></code>
  parameter. Default values of these parameters sometimes result in
  computations taking unbearably long time or in numerical errors spoiling the
  calculation. Increasing
  <code><a href="#default_relative_error">default_relative_error</a></code> and
  <code><a href="#default_error_step">default_error_step</a></code>
  might help in this case.
</p>

In <code>libepa</code> language, <em>integration level</em> of an integral is
the nesting number of the integral in the calculation. For example, when
computing
<math>
  <mo>&int;</mo>
  <mi>dx</mi>
  <mo>&int;</mo>
  <mi>dy</mi>
  <mi>f</mi>
  <mo>(</mo>
  <mi>x</mi>
  <mo>,</mo>
  <mi>y</mi>
  <mi>)</mi>
</math>,
the integral with respect to <math><mi>dx</mi></math> is of integration level
0, and the integral with respect to <math><mi>dy</mi></math> is of
integration level 1. <em>Integrator generator</em> is a function producing
integrators for different integration levels. The difference between these
integrators is in their captured <code>relative_error</code> parameter with
is calculated as follows:
<div class="equation">
  <code>relative_error</code>
  = <code>default_relative_error</code>
  &times; <code>default_error_step</code><sup><i>integration level</i></sup>.
</div>
Available integrator generators based on GSL routines are
<code><a href="#qag_integrator">qag_integrator</a></code> and
<code><a href="#cquad_integrator">cquad_integrator</a></code>

<p>
  GSL integration routines require workspace which is allocated while
  constructing the integrator. The workspace is wrapped in
  <code>std::shared_ptr</code>, so copying the integrator is cheap, and the
  workspace is deallocated along with the integrator.  Note, however, that two
  copies of such integrator cannot be used in parallel. To add a compile-time
  constraint on that, copying of the workspace will probably be forbidden in
  the future.
</p>

<h2 id="api">API Reference</h2>

<h3 id="epa">EPA</h3>

<pre>
    <span class="macro">#include</span> <span class="literal">&lt;epa/epa.hpp&gt;</span>
</pre>

<p>
  All <code>libepa</code> symbols are defined in namespace <code>epa</code>.
  All values are in units of powers of GeV except cross sections which are in
  barns. Calculations assume
  <math><mi>ħ</mi> <mo>=</mo> <mi>c</mi> <mo>=</mo> <mn>1</mn></math>
  where <math><mi>ħ</mi></math> is the Planck constant, and
  <math><mi>c</mi></math> is the speed of light.
</p>

<h5 id="error-handling">Error handling</h5>

<p>
  When encountering an error, <code>libepa</code> throws an exception. For
  integration errors, these are exceptions of class <code>gsl::Error</code>.
  Standard exceptions might be thrown by the functions from the standard
  library.  To help with debugging, the variable
  <a id="print_backtrace"></a><code>bool print_backtrace</code> can be set to
  <code><span class="literal">true</span></code>. In this case
  <code>libepa</code> will print to the standard error output the backtrace of
  the calculation.
</p>

<h5 id="epa-constants">Constants</h5>

The following constants are used in the functions (some of the constants are
only used to define other constants):
<div class="table">
  <table>
    <tr>
      <th>Type</th>
      <th>Constant</th>
      <th>Value</th>
      <th>Units</th>
      <th>Comment</th>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td><a id="infinity"></a><code>infinity</code></td>
      <td><code><span class="literal">INF</span></code></td>
      <td></td>
      <td>Double precision positive infinity</td>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td><a id="pi"></a><code>pi</code></td>
      <td><code><span class="literal">M_PI</span></code></td>
      <td></td>
      <td>The value of <math><mi>π</mi></math></td>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td><a id="alpha"></a><code>alpha</code></td>
      <td><code><span class="literal">7.2973525693e-3</span></code>
      <td></td>
      <td>Fine structure constant <math><mi>α</mi></math> *</td>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td><a id="planck"></a><code>planck</code></td>
      <td><code><span class="literal">0.1973269804</span></code></td>
      <td>GeV fm</td>
      <td>Planck constant <math><mi>ħ</mi></math> *</td>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td><a id="barn"></a><code>barn</code></td>
      <td>
        <math>
          <msup> <mi>ħ</mi> <mn>2</mn> </msup>
          <mo>&times;</mo>
          <msup> <mn>10</mn> <mn>-2</mn> </msup>
        </math>
      </td>
      <td>GeV<sup>2</sup> barn</td>
      <td>Coefficient converting GeV<sup>&minus;2</sup> to barns</td>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td><a id="fm"></a><code>fm</code></td>
      <td>
        <math>
          <mn>1</mn>
          <mo>/</mo>
          <mo>(</mo>
          <mn>10</mn>
          <msqrt><mtext>barn</mtext></msqrt>
          <mo>)</mo>
        </math>
      </td>
      <td>(GeV fm)<sup>&minus;1</sup></td>
      <td>Coefficient converting fm to GeV<sup>&minus;1</sup></td>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td><a id="electron_charge"></a><code>electron_charge</code></td>
      <td><code><span class="literal">1.602176634e-19</span></code></td>
      <td>Cl</td>
      <td>Electron charge in SI units (<math><mi>e</mi></math>) *</td>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td><a id="light_speed"></a><code>light_speed</code></td>
      <td><code><span class="literal">299792458</span></code></td>
      <td>m/s</td>
      <td>Speed of light in SI units (<math><mi>c</mi></math>) *</td>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td><a id="amu"></a><code>amu</code></td>
      <td>
        <math>
          <mo>(</mo>
          <mi>1.66053906660</mi>
          <mo>&middot;</mo>
          <msup> <mn>10</mn> <mn>-27</mn> </msup>
          <mo>&middot;</mo>
          <msup> <mi>c</mi> <mn>2</mn> </msup>
          <mo>/</mo>
          <mi>e</mi>
          <mo>)</mo>
          <mo>&times;</mo>
          <msup> <mn>10</mn> <mn>9</mn> </msup>
        </math>
      </td>
      <td>GeV</td>
      <td>Atomic mass unit in GeV *</td>
    </tr>
  </table>
</div>
Constants denoted with * were taken from E. Tiesinga, P. J. Mohr, D. B. Newell,
B. N. Taylor, <i>CODATA recommended values of the fundamental physical
  constants: 2018</i>,
<a href="https://doi.org/10.1103/RevModPhys.93.025010">Reviews of Modern Physics 93, 025010 (2021)</a>.

<h5 id="epa-integrators">Integrators</h5>

<div id="Integrator" class="def">
  <span class="def"><code>Integrator</code></span>
  <pre>
    <span class="type">typedef</span> std::function&lt;
      <span class="type">double</span> (
        <span class="type">const</span> std::function&lt;<span class="type">double</span> (<span class="type">double</span>)&gt;&amp;, <span class="comment">// f(x)</span>
        <span class="type">double</span>, <span class="comment">// a</span>
        <span class="type">double</span>  <span class="comment">// b</span>
      )
    &gt; Integrator;
  </pre>
  Integrator is a function taking as a parameter a function of one argument (f(x))
  and computing an integral of this function on a given interval [a, b].
</div>

Parameters governing GSL integration routines:
<div class="table">
  <table id="gsl-integration-parameters">
    <tr>
      <th>Type</th>
      <th>Variable</th>
      <th>Default value</th>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td>
        <a id="default_absolute_error"></a><code>default_absolute_error</code>
      </td>
      <td><code><span class="literal">0</span></code></td>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td>
        <a id="default_relative_error"></a><code>default_relative_error</code>
      </td>
      <td><code><span class="literal">1e-3</span></code></td>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td><a id="default_error_step"></a><code>default_error_step</code></td>
      <td><code><span class="literal">1e-1</span></code></td>
    </tr>
    <tr>
      <td><code><span class="type">size_t</span></code></td>
      <td>
        <a id="default_integration_limit"></a>
        <code>default_integration_limit</code>
      </td>
      <td><code><span class="literal">1000</span></code></td>
    </tr>
    <tr>
      <td><code><span class="type">size_t</span></code></td>
      <td>
        <a id="default_cquad_integration_limit"></a>
        <code>default_cquad_integration_limit</code>
      </td>
      <td><code><span class="literal">100</span></code></td>
    </tr>
    <tr>
      <td><code>gsl::integration::QAGMethod</code></td>
      <td>
        <a id="default_integration_method"></a>
        <code>default_integration_method</code>
      </td>
      <td><code>gsl::integration::GAUSS41</code></td>
    </tr>
    <tr>
      <td><code>Integrator</code></td>
      <td><a id="default_integrator"></a><code>default_integrator</code></td>
      <td><code>qag_integrator</code></td>
    </tr>
  </table>
</div>

<p>
  GSL integration routines perform integration by dividing the integration
  region into successively smaller intervals and estimating the integral value
  across these intervals using different approaches. At each iteration, the
  integral value is computed and compared to that of the previous iteration.
  Iterations stop when the absolute or the relative difference between these
  values is smaller than the provided parameters <code>epsabs</code> and
  <code>epsrel</code> respectively. In the following routines
  <code>epsabs</code> is referred to as <code>absolute_error</code> and
  <code>epsrel</code> is referred to as <code>relative_error</code>.
  Default values of these parameters are provided by 
  <code>default_absolute_error</code> and <code>default_relative_error</code>.
  Correct application of <code>absolute_error</code> requires estimation of the
  order of magnitude of the integral, so its usage is discouraged and its
  default value is set to zero.
</p>

<p>
  Integration of inner integrals requires higher accuracy than that of outer
  integrals. For this reason integrator generators reduce
  <code>relative_error</code> by multiplying it by <code>error_step</code> at
  each integration level. <code>default_error_step</code> provides the default
  value of <code>error_step</code>.
</p>

<p>
  GSL integration routines use preallocated workspace.
  <code>default_integration_limit</code> and
  <code>default_cquad_integration_limit</code> define the default size of the
  workspace for the
  <a href="https://www.gnu.org/software/gsl/doc/html/integration.html#qag-adaptive-integration">QAG</a>
  and
  <a href="https://www.gnu.org/software/gsl/doc/html/integration.html#cquad-doubly-adaptive-integration">CQUAD</a>
  algorithms. When the integration runs out of workspace, an exception of type
  <code>gsl::Error</code> is thrown.
</p>

<p>
  GSL
  <a href="https://www.gnu.org/software/gsl/doc/html/integration.html#qag-adaptive-integration">
    QAG integration
  </a>
  routine divides the integration region into subintervals by calculating the
  function value at <math><mi>n</mi></math> points, where
  <math><mi>n</mi></math> is defined by the <code>integration_method</code>
  parameter. Supported values are those defined in 
  <code><span class="type">enum</span> gsl::integration::QAGMethod</code>:
  <code>GAUSS15</code>, <code>GAUSS21</code>, <code>GAUSS31</code>,
  <code>GAUSS41</code>, <code>GAUSS51</code>, <code>GAUSS61</code>.
  The default value is provided by <code>default_integration_method</code>.
</p>

<p>
  <code>default_integrator</code> defines the default integrator generator.
</p>

<div id="qag_integrator" class="def">
  <span class="def"><code>qag_integrator</code></span>
  <div class="def">
    <pre>
    Integrator qag_integrator(
      <span class="type">double</span> absolute_error = default_absolute_error,
      <span class="type">double</span> relative_error = default_relative_error,
      gsl::integration::QAGMethod integration_method = default_integration_method,
      std::shared_ptr&lt;gsl::integration::QAGWorkspace&gt; workspace = <span class="literal">nullptr</span>
    );
    </pre>
    Returns an integrator based on quadratic adaptive integration routines for
    general (used-defined) integrand implemented in GSL
    (<a href="https://www.gnu.org/software/gsl/doc/html/integration.html#qag-adaptive-integration">QAG</a>).
    See <a href="#gsl-integration-parameters">above</a> for the description of
    the parameters. If
    <code>workspace</code> is
    <code><span class="literal">nullptr</span></code>, a new workspace
    sufficient for <code>default_integration_limit</code> is allocated.
  </div>

  <div class="def">
    <pre>
    <span class="type">struct</span> qag_integrator_keys {
      <span class="type">double</span> absolute_error = default_absolute_error;
      <span class="type">double</span> relative_error = default_relative_error;
      gsl::integration::QAGMethod method = default_integration_method;
      std::shared_ptr&lt;gsl::integration::QAGWorkspace&gt; workspace;
    };

    Integrator qag_integrator(<span class="type">const</span> qag_integrator_keys);
    </pre>
    A keyword variant of <code>qag_integrator</code>. Use as follows:
    <pre>
    <span class="type">auto</span> integrate = qag_integrator({ .method = gsl::integration::GAUSS21 });
    </pre>
  </div>

  <div class="def">
    <pre>
    Integrator qag_integrator(<span class="type">unsigned</span> level)
    </pre>
    Returns a QAG integrator with <code>relative_error</code> =
    <code>default_relative_error</code> &times;
    <code>default_error_step</code><sup><code>level</code></sup>. Other
    parameters are initialized with defaults.
  </div>
</div>

<div id="qag_integrator_generator" class="def">
  <span class="def"><code>qag_integrator_generator</code></span>
  <pre>
    std::function&lt;Integrator (<span class="type">unsigned</span> <span class="comment">/* integration_level */</span>)&gt; qag_integrator_generator(
      <span class="type">double</span> relative_error = default_relative_error,
      <span class="type">double</span> error_step     = default_error_step
    );
  </pre>
  Returns a generator of QAG integrators with <code>relative_error</code> =
  <code>relative_error</code> &times;
  <code>error_step</code><sup><code>level</code></sup>. Other parameters are
  initialized with defaults.
</div>

<div id="cquad_integrator" class="def">
  <span class="def"><code>cquad_integrator</code></span>
  <div class="def">
    <pre>
    Integrator cquad_integrator(
      <span class="type">double</span> absolute_error = default_absolute_error,
      <span class="type">double</span> relative_error = default_relative_error,
      std::shared_ptr&lt;gsl::integration::CQuadWorkspace&gt; workspace = <span class="literal">nullptr</span>
    );
    </pre>
    Returns an integrator based on
    <a href="https://www.gnu.org/software/gsl/doc/html/integration.html#cquad-doubly-adaptive-integration">CQUAD doubly-adaptive algorithm</a>
    implemented in GSL. See <a href="#gsl-integration-parameters">above</a> for
    the description of the parameters. If
    <code>workspace</code> is <code><span
    class="literal">nullptr</span></code>, a new workspace sufficient
    for <code>default_cquad_integration_limit</code> is allocated.
  </div>

  <div class="def">
    <pre>
    <span class="type">struct</span> cquad_integrator_keys {
      <span class="type">double</span> absolute_error = default_absolute_error;
      <span class="type">double</span> relative_error = default_relative_error;
      std::shared_ptr&lt;gsl::integration::CQuadWorkspace&gt; workspace;
    };

    Integrator cquad_integrator(<span class="type">const</span> cquad_integrator_keys&amp;);
    </pre>
    A keyword variant of <code>cquad_integrator</code>. Use as follows:
    <pre>
    <span class="type">auto</span> integrate = cquad_integrator({ .relative_error = <span class="literal">1e-2</span> });
    </pre>
  </div>

  <div class="def">
    <pre>
    Integrator cquad_integrator(<span class="type">unsigned</span> level = <span class="literal">0</span>);
    </pre>
    Returns a CQUAD integrator with <code>relative_error</code> =
    <code>relative_error</code> &times;
    <code>error_step</code><sup><code>level</code></sup>. Other parameters are
    initialized with defaults.
  </div>
</div>

<h5 id="epa-form-factors">Form factors</h5>

<div id="FormFactor" class="def">
  <span class="def"><code>FormFactor</code></span>
  <pre>
    <span class="type">typedef</span> std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* Q^2 */</span>)&gt; FormFactor;
  </pre>
  Electromagnetic form factor is used to describe the structure of elementary
  particle as seen in electromagnetic interactions. For the theory, refer to S.
  Pacetti, R. B. Ferroli, E. Tomasi-Gustaffson, <i>Proton electromagnetic form
    factors: Basic notions, present achievements and future perspectives,</i>
  <a href="http://dx.doi.org/10.1016/j.physrep.2014.09.005">Phys.  Rep. 550-1 (2015)</a>.
  Form factor of a pointlike particle equals 1. Form factor of a finite
  size particle is a function mapping the photon 3-momentum squared
  <math><msup> <mi>Q</mi> <mn>2</mn> </msup></math> to
  <math>
    <mo>[</mo>
    <mn>0</mn>
    <mo>;</mo>
    <mn>1</mn>
    <mo>]</mo>
  </math>.
</div>

<div id="form_factor_monopole" class="def">
  <span class="def"><code>form_factor_monopole</code></span>
  <pre>
    FormFactor form_factor_monopole(<span class="type">double</span> lambda2);
  </pre>
  Monopole form factor:
  <math display="block">
    <msub> <mi>F</mi> <mn>1</mn> </msub>
    <mo>(</mo>
    <msup> <mi>Q</mi> <mn>2</mn> </msup>
    <mo>)</mo>
    <mo>=</mo>
    <mfrac>
      <mn>1</mn>
      <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mfrac>
          <msup> <mi>Q</mi> <mn>2</mn> </msup>
          <msup> <mn>Λ</mn> <mn>2</mn> </msup>
        </mfrac>
      </mrow>
    </mfrac>.
  </math>
  <code>lambda2</code> is <math><msup> <mn>Λ</mn> <mn>2</mn> </msup></math> in
  GeV<sup>2</sup>.
</div>

<div id="form_factor_dipole" class="def">
  <span class="def"><code>form_factor_dipole</code></span>
  <pre>
    FormFactor form_factor_dipole(<span class="type">double</span> lambda2);
  </pre>
  Dipole form factor:
  <math display="block">
    <msub> <mi>F</mi> <mn>2</mn> </msub>
    <mo>(</mo>
    <msup> <mi>Q</mi> <mn>2</mn> </msup>
    <mo>)</mo>
    <mo>=</mo>
    <mfrac>
      <mn>1</mn>
      <msup>
        <mrow>
          <mo>(</mo>
          <mn>1</mn>
          <mo>+</mo>
          <mfrac>
            <msup> <mi>Q</mi> <mn>2</mn> </msup>
            <msup> <mn>Λ</mn> <mn>2</mn> </msup>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <mn>2</mn>
      </msup>
    </mfrac>.
  </math>
  <code>lambda2</code> is <math><msup> <mn>Λ</mn> <mn>2</mn> </msup></math> in
  GeV<sup>2</sup>.
</div>

<h5 id="epa-spectra">Equivalent photon spectra</h5>

<div id="Spectrum" class="def">
  <span class="def"><code>Spectrum</code></span>
  <pre>
    <span class="type">typedef</span> std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* ω */</span>)&gt; Spectrum;
  </pre>
  Equivalent photon spectrum describes the distribution of photons moving along
  with the particle with respect to the photons energy ω.
</div>

<div id="spectrum" class="def">
  <span class="def"><code>spectrum</code></span>
  <pre>
    Spectrum spectrum(
      <span class="type">unsigned</span> Z,
      <span class="type">double</span> gamma,
      <a href="#FormFactor">FormFactor</a>, <span class="comment">// F</span>
      <a href="#Integrator">Integrator</a> = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>)
    );
  </pre>
  Equivalent photon spectrum defined as an integral of the particle form factor:
  <math display="block">
    <mi>n</mi>
    <mo>(</mo>
    <mi>ω</mi>
    <mo>)</mo>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mn>2</mn>
        <msup> <mi>Z</mi> <mn>2</mn> </msup>
        <mi>α</mi>
      </mrow>
      <mrow>
        <mi>π</mi>
        <mi>ω</mi>
      </mrow>
    </mfrac>
    <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
    <msup>
      <mrow>
        <mo>[</mo>
        <mfrac>
          <mrow>
            <mi>F</mi>
            <mo>(</mo>
            <msubsup> <mi>q</mi> <mo>&perp;</mo> <mn>2</mn> </msubsup>
            <mo>+</mo>
            <msup>
              <mrow>
                <mo>(</mo>
                <mi>ω</mi>
                <mo>/</mo>
                <mi>γ</mi>
                <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
            <mo>)</mo>
          </mrow>
          <mrow>
            <msubsup> <mi>q</mi> <mo>&perp;</mo> <mn>2</mn> </msubsup>
            <mo>+</mo>
            <msup>
              <mrow>
                <mo>(</mo>
                <mi>ω</mi>
                <mo>/</mo>
                <mi>γ</mi>
                <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
          </mrow>
        </mfrac>
        <mo>]</mo>
      </mrow>
      <mn>2</mn>
    </msup>
    <msubsup> <mi>q</mi> <mo>&perp;</mo> <mn>3</mn> </msubsup>
    <mtext>d</mtext>
    <msub><mi>q</mi> <mo>&perp;</mo></msub>.
  </math>
</div>

Note that the equivalent photon spectrum of a pointlike particle is divergent.

<div id="spectrum_monopole" class="def">
  <span class="def"><code>spectrum_monopole</code></span>
  <pre>
    Spectrum spectrum_monopole(<span class="type">unsigned</span> Z, <span class="type">double</span> gamma, <span class="type">double</span> lambda2);
  </pre>
  Equivalent photon spectrum for the
  <a href="#form_factor_monopole">monopole form factor</a>:
  <math display="block">
    <msub> <mi>n</mi> <mn>1</mn> </msub>
    <mo>(</mo> <mi>ω</mi> <mo>)</mo>
    <mo>=</mo>
    <mfrac>
     <mrow>
       <msup> <mi>Z</mi> <mn>2</mn> </msup>
       <mi>α</mi>
     </mrow>
     <mrow>
       <mi>π</mi>
       <mi>ω</mi>
     </mrow>
    </mfrac>
    <mrow>
      <mo>[</mo>
      <mo>(</mo>
      <mn>2</mn>
      <mi>a</mi>
      <mo>+</mo>
      <mn>1</mn>
      <mo>)</mo>
      <mtext>ln</mtext>
      <mo>(</mo>
      <mn>1</mn>
      <mo>+</mo>
      <mfrac> <mn>1</mn> <mi>a</mi> </mfrac>
      <mo>)</mo>
      <mo>-</mo>
      <mn>2</mn>
      <mo>]</mo>
    </mrow>,
  </math>
  where
  <math>
    <mi>a</mi>
    <mo>=</mo>
    <msup>
      <mrow>
        <mo>(</mo>
        <mi>ω</mi>
        <mo>/</mo>
        <mn>Λ</mn>
        <mi>γ</mi>
        <mo>)</mo>
      </mrow>
      <mn>2</mn>
    </msup>.
  </math>
</div>

<div id="spectrum_dipole" class="def">
  <span class="def"><code>spectrum_dipole</code></span>
  <pre>
    Spectrum spectrum_dipole(<span class="type">unsigned</span> Z, <span class="type">double</span> gamma, <span class="type">double</span> lambda2);
  </pre>
  Equivalent photon spectrum for the
  <a href="#form_factor_dipole">dipole form factor</a>:
  <math display="block">
    <msub> <mi>n</mi> <mn>2</mn> </msub>
    <mo>(</mo> <mi>ω</mi> <mo>)</mo>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <msup> <mi>Z</mi> <mn>2</mn> </msup>
        <mi>α</mi>
      </mrow>
      <mrow>
        <mi>π</mi>
        <mi>ω</mi>
      </mrow>
    </mfrac>
    <mrow>
      <mo>[</mo>
      <mo>(</mo>
      <mn>4</mn>
      <mi>a</mi>
      <mo>+</mo>
      <mn>1</mn>
      <mo>)</mo>
      <mtext>ln</mtext>
      <mo>(</mo>
      <mn>1</mn>
      <mo>+</mo>
      <mfrac> <mn>1</mn> <mi>a</mi> </mfrac>
      <mo>)</mo>
      <mo>-</mo>
      <mfrac>
        <mrow>
          <mn>24</mn>
          <msup> <mi>a</mi> <mn>2</mn> </msup>
          <mo>+</mo>
          <mn>42</mn>
          <mi>a</mi>
          <mo>+</mo>
          <mn>17</mn>
        </mrow>
        <mrow>
          <mn>6</mn>
          <msup>
            <mrow>
              <mo>(</mo>
              <mi>a</mi>
              <mo>+</mo>
              <mn>1</mn>
              <mo>)</mo>
            </mrow>
            <mn>2</mn>
          </msup>
        </mrow>
      </mfrac>
      <mo>]</mo>,
    </mrow>
  </math>
  where
  <math>
    <mi>a</mi>
    <mo>=</mo>
    <msup>
      <mrow>
        <mo>(</mo>
        <mi>ω</mi>
        <mo>/</mo>
        <mn>Λ</mn>
        <mi>γ</mi>
        <mo>)</mo>
      </mrow>
      <mn>2</mn>
    </msup>.
  </math>
</div>

<div id="Spectrum_b" class="def">
  <span class="def"><code>Spectrum_b</code></span>
  <pre>
    <span class="type">typedef</span> std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* b */</span>, <span class="type">double</span> <span class="comment">/* ω */</span>)&gt; Spectrum_b;
  </pre>
  Distribution of photons moving along with the particle at distance b in the
  transverse plane with respect to photons energy ω. It is also referred to as
  the equivalent photon spectrum throughout this documentation.
</div>

<div id="spectrum_b" class="def">
  <span class="def"><code>spectrum_b</code></span>
  <pre>
    Spectrum_b spectrum_b(
      <span class="type">unsigned</span> Z,
      <span class="type">double</span> gamma,
      <a href="#FormFactor">FormFactor</a>, <span class="comment">// F</span>
      <a href="#Integrator">Integrator</a> = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>)
    );
  </pre>
  Equivalent photon spectrum defined as an integral of the particle form factor:
  <math display="block">
    <mi>n</mi>
    <mo>(</mo>
    <mi>b</mi>
    <mo>,</mo>
    <mi>ω</mi>
    <mo>)</mo>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <msup> <mi>Z</mi> <mn>2</mn> </msup>
        <mi>α</mi>
      </mrow>
      <mrow>
        <msup> <mi>π</mi> <mn>2</mn> </msup>
        <mi>ω</mi>
      </mrow>
    </mfrac>
    <msup>
      <mrow>
        <mo>[</mo>
        <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>&infin;</mn> </msubsup>
        <mfrac>
          <mrow>
            <mi>F</mi>
            <mo>(</mo>
            <msubsup> <mi>q</mi> <mo>&perp;</mo> <mn>2</mn> </msubsup>
            <mo>+</mo>
            <msup>
              <mrow>
                <mo>(</mo>
                <mi>ω</mi>
                <mo>/</mo>
                <mi>γ</mi>
                <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
            <mo>)</mo>
          </mrow>
          <mrow>
            <msubsup> <mi>q</mi> <mo>&perp;</mo> <mn>2</mn> </msubsup>
            <mo>+</mo>
            <msup>
              <mrow>
                <mo>(</mo>
                <mi>ω</mi>
                <mo>/</mo>
                <mi>γ</mi>
                <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
          </mrow>
        </mfrac>
        <mrow>
          <msub> <mi>J</mi> <mn>1</mn> </msub>
          <mo>(</mo>
          <mi>b</mi>
          <msub><mi>q</mi> <mo>&perp;</mo></msub>
          <mo>)</mo>
          <mspace width="3pt"/>
          <msubsup> <mi>q</mi> <mo>&perp;</mo> <mn>2</mn> </msubsup>
        </mrow>
        <mtext>d</mtext>
        <msub><mi>q</mi> <mo>&perp;</mo></msub>
        <mo>]</mo>
      </mrow>
      <mn>2</mn>
    </msup>.
  </math>
  Note that the form factor is weighted with an oscillating function (the
  Bessel function <math><msub><mi>J</mi> <mn>1</mn></msub></math>) and
  integrated over semi-infinite interval. For small values of
  <math><mi>b</mi></math> this integration is very difficult to perform
  numerically. Take care with the default quadrature integrator.
</div>

<div id="spectrum_b_point" class="def">
  <span class="def"><code>spectrum_b_point</code></span>
  <pre>
    Spectrum_b spectrum_b_point(<span class="type">unsigned</span> Z, <span class="type">double</span> gamma);
  </pre>
  Equivalent photon spectrum for pointlike particle:
  <math display="block">
    <msub> <mi>n</mi> <mn>0</mn> </msub>
    <mo>(</mo> <mi>b</mi> <mo>,</mo> <mi>ω</mi> <mo>)</mo>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <msup> <mi>Z</mi> <mn>2</mn> </msup>
        <mi>α</mi>
        <mi>ω</mi>
      </mrow>
      <mrow>
        <msup> <mi>π</mi> <mn>2</mn> </msup>
        <msup> <mi>γ</mi> <mn>2</mn> </msup>
      </mrow>
    </mfrac>
    <msubsup> <mi>K</mi> <mn>1</mn> <mn>2</mn> </msubsup>
    <mrow>
      <mo>(</mo>
      <mfrac>
        <mrow> <mi>b</mi> <mi>ω</mi> </mrow>
        <mi>γ</mi>
      </mfrac>
      <mo>)</mo>
    </mrow>.
  </math>
</div>

<div id="spectrum_b_monopole" class="def">
  <span class="def"><code>spectrum_b_monopole</code></span>
  <pre>
    Spectrum_b spectrum_b_monopole(<span class="type">unsigned</span> Z, <span class="type">double</span> gamma, <span class="type">double</span> lambda2);
  </pre>
  Equivalent photon spectrum for the
  <a href="#form_factor_monopole">monopole form factor</a>:
  <math display="block">
    <msub> <mi>n</mi> <mn>1</mn> </msub>
    <mo>(</mo> <mi>b</mi> <mo>,</mo> <mi>ω</mi> <mo>)</mo>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <msup> <mi>Z</mi> <mn>2</mn> </msup>
        <mi>α</mi>
      </mrow>
      <mrow>
        <msup> <mi>π</mi> <mn>2</mn> </msup>
        <mi>ω</mi>
      </mrow>
    </mfrac>
    <msup>
      <mrow>
        <mo>[</mo>
        <mfrac> <mi>ω</mi> <mi>γ</mi> </mfrac>
        <msub> <mi>K</mi> <mn>1</mn> </msub>
        <mrow>
          <mo>(</mo>
          <mfrac>
            <mrow> <mi>b</mi> <mi>ω</mi> </mrow>
            <mi>γ</mi>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <mo>-</mo>
        <msqrt>
          <mrow>
            <msup> <mn>Λ</mn> <mn>2</mn> </msup>
            <mo>+</mo>
            <msup>
              <mrow>
                <mo>(</mo>
                <mfrac> <mi>ω</mi> <mi>γ</mi> </mfrac>
                <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
          </mrow>
        </msqrt>
        <msub> <mi>K</mi> <mn>1</mn> </msub>
        <mrow>
          <mo>(</mo>
          <mi>b</mi>
          <msqrt>
            <mrow>
              <msup> <mn>Λ</mn> <mn>2</mn> </msup>
              <mo>+</mo>
              <msup>
                <mrow>
                  <mo>(</mo>
                  <mfrac> <mi>ω</mi> <mi>γ</mi> </mfrac>
                  <mo>)</mo>
                </mrow>
                <mn>2</mn>
              </msup>
            </mrow>
          </msqrt>
          <mo>)</mo>
        </mrow>
        <mo>]</mo>
      </mrow>
      <mn>2</mn>
    </msup>.
  </math>
</div>

<div id="spectrum_b_dipole" class="def">
  <span class="def"><code>spectrum_b_dipole</code></span>
  <pre>
    Spectrum_b spectrum_b_dipole(<span class="type">unsigned</span> Z, <span class="type">double</span> gamma, <span class="type">double</span> lambda2);
  </pre>
  Equivalent photon spectrum for the
  <a href="#dipole_form_factor">dipole form factor</a>:
  <math display="block">
    <msub> <mi>n</mi> <mn>2</mn> </msub>
    <mo>(</mo> <mi>b</mi> <mo>,</mo> <mi>ω</mi> <mo>)</mo>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <msup> <mi>Z</mi> <mn>2</mn> </msup>
        <mi>α</mi>
      </mrow>
      <mrow>
        <msup> <mi>π</mi> <mn>2</mn> </msup>
        <mi>ω</mi>
      </mrow>
    </mfrac>
    <msup>
      <mrow>
        <mo>[</mo>
        <mfrac> <mi>ω</mi> <mi>γ</mi> </mfrac>
        <msub> <mi>K</mi> <mn>1</mn> </msub>
        <mrow>
          <mo>(</mo>
          <mfrac>
            <mrow> <mi>b</mi> <mi>ω</mi> </mrow>
            <mi>γ</mi>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <mo>-</mo>
        <msqrt>
          <mrow>
            <msup> <mn>Λ</mn> <mn>2</mn> </msup>
            <mo>+</mo>
            <msup>
              <mrow>
                <mo>(</mo>
                <mfrac> <mi>ω</mi> <mi>γ</mi> </mfrac>
                <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
          </mrow>
        </msqrt>
        <msub> <mi>K</mi> <mn>1</mn> </msub>
        <mrow>
          <mo>(</mo>
          <mi>b</mi>
          <msqrt>
            <mrow>
              <msup> <mn>Λ</mn> <mn>2</mn> </msup>
              <mo>+</mo>
              <msup>
                <mrow>
                  <mo>(</mo>
                  <mfrac> <mi>ω</mi> <mi>γ</mi> </mfrac>
                  <mo>)</mo>
                </mrow>
                <mn>2</mn>
              </msup>
            </mrow>
          </msqrt>
          <mo>)</mo>
        </mrow>
        <mo>-</mo>
        <mfrac>
          <mrow>
            <mi>b</mi>
            <msup> <mn>Λ</mn> <mn>2</mn> </msup>
          </mrow>
          <mn>2</mn>
        </mfrac>
        <msub> <mi>K</mi> <mn>0</mn> </msub>
        <mrow>
          <mo>(</mo>
          <mi>b</mi>
          <msqrt>
            <mrow>
              <msup> <mn>Λ</mn> <mn>2</mn> </msup>
              <mo>+</mo>
              <msup>
                <mrow>
                  <mfrac>
                    <mi>ω</mi>
                    <mi>γ</mi>
                  </mfrac>
                </mrow>
                <mn>2</mn>
              </msup>
            </mrow>
          </msqrt>
          <mo>)</mo>
        </mrow>
        <mo>]</mo>
      </mrow>
      <mn>2</mn>
    </msup>.
  </math>
</div>

<h5 id="epa-luminosities">Luminosities</h5>

<div id="Luminosity" class="def">
  <span class="def"><code>Luminosity</code></span>
  <pre>
    <span class="type">typedef</span> std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* <math><msqrt> <mi>s</mi> </msqrt></math> */</span>)&gt; Luminosity;
  </pre>
  Luminosity <math><mi>L</mi></math> is the number of photons coming from both
  of the colliding particles during the collision. <code>Luminosity</code> is
  differentiated with respect to the invariant mass <math><msqrt> <mi>s</mi>
  </msqrt></math> of the photon-photon system
  <math>
    <mo>(</mo>
    <mtext>d</mtext>
    <mi>L</mi>
    <mo>/</mo>
    <mtext>d</mtext>
    <msqrt> <mi>s</mi> </msqrt>
    <mo>)</mo>
  </math>.
</div>

<div id="Luminosity_y" class="def">
  <span class="def"><code>Luminosity_y</code></span>
  <pre>
    <span class="type">typedef</span> std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* <math><msqrt><mi>s</mi></msqrt></math> */</span>, <span class="type">double</span> <span class="comment">/* y */</span>)&gt; Luminosity_y;
  </pre>
  <code>Luminosity_y</code> is the luminosity differentiated with respect to
  the invariant mass <math><msqrt><mi>s</mi></msqrt></math> and rapidity
  <code>y</code> of the photon-photon system
  <math>
    <mo>(</mo>
    <mtext>d</mtext>
    <mi>L</mi>
    <mo>/</mo>
    <mtext>d</mtext>
    <mi>y</mi>
    <mspace width="3pt"/>
    <mtext>d</mtext>
    <msqrt> <mi>s</mi> </msqrt>
    <mo>)</mo>
  </math>.
</div>

<div id="Luminosity_fid" class="def">
  <span class="def"><code>Luminosity_fid</code></span>
  <pre>
    <span class="type">typedef</span> std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* <math><msqrt><mi>s</mi></msqrt></math> */</span>, <span class="type">double</span> <span class="comment">/* ymin */</span>, <span class="type">double</span> <span class="comment">/* ymax */</span>)&gt; Luminosity_fid;
  </pre>
  <code>Luminosity_fid</code> is used to calculate fiducial cross section. It is
  differentiated with respect to invariant mass
  <math><msqrt><mi>s</mi></msqrt></math> of the photon-photon system 
  <math>
    <mo>(</mo>
    <mtext>d</mtext>
    <mi>L</mi>
    <mo>/</mo>
    <mtext>d</mtext>
    <msqrt> <mi>s</mi> </msqrt>
    <mo>)</mo>
  </math>
  and integrated with respect to rapidity of the photon-photon system in the range
  [ <code>ymin</code>, <code>ymax</code> ] instead of [&minus;∞; ∞].
</div>

<div id="luminosity" class="def">
  <span class="def"><code>luminosity</code></span>
  <div class="def">
    <pre>
    Luminosity luminosity(<a href="#Spectrum">Spectrum</a> nA, <a href="#Spectrum">Spectrum</a> nB, <a href="#Integrator">Integrator</a> = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>));
    </pre>
    Photon-photon luminosity in ultraperipheral collision of particles
    <math><mi>A</mi></math> and <math><mi>B</mi></math> differentiated with
    respect to the invariant mass <math><msqrt><mi>s</mi></msqrt></math> of the
    photon-photon system:
    <math display="block">
      <mfrac>
        <mrow>
          <mtext>d</mtext>
          <msub> <mi>L</mi> <mrow> <mi>A</mi> <mi>B</mi> </mrow> </msub>
        </mrow>
        <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
      </mfrac>
      <mrow> <mo>(</mo> <msqrt><mi>s</mi></msqrt> <mo>)</mo> </mrow>
      <mo>=</mo>
      <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
      <mrow>
        <msubsup>
          <mo>&int;</mo>
          <mrow> <mo>-</mo> <mn>∞</mn> </mrow>
          <mn>∞</mn>
        </msubsup>
        <msub> <mi>n</mi> <mi>A</mi> </msub>
        <mrow>
          <mo>(</mo>
          <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
          <msup> <mn>e</mn> <mi>y</mi> </msup>
          <mo>)</mo>
        </mrow>
        <mspace width="3pt"/>
        <msub> <mi>n</mi> <mi>B</mi> </msub>
        <mrow>
          <mo>(</mo>
          <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
          <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
          <mo>)</mo>
        </mrow>
        <mtext>d</mtext> <mi>y</mi>.
      </mrow>
    </math>
  </div>
  <div class="def">
    <pre>
    Luminosity luminosity(<a href="#Spectrum">Spectrum</a> n, <a href="#Integrator">Integrator</a> = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>));
    </pre>
    Convenience function for the collision of identical particles. It takes
    into account the symmetry of the integrand, improving on convergence and
    calculation time:
    <math display="block">
      <mfrac>
        <mrow> <mtext>d</mtext> <mi>L</mi> </mrow>
        <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
      </mfrac>
      <mrow>
        <mo>(</mo>
        <msqrt> <mi>s</mi> </msqrt>
        <mo>)</mo>
      </mrow>
      <mo>=</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mrow>
        <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
        <mi>n</mi>
        <mrow>
          <mo>(</mo>
          <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
          <msup> <mn>e</mn> <mi>y</mi> </msup>
          <mo>)</mo>
        </mrow>
        <mspace width="3pt"/>
        <mi>n</mi>
        <mrow>
          <mo>(</mo>
          <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
          <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
          <mo>)</mo>
        </mrow>
        <mtext>d</mtext> <mi>y</mi>.
      </mrow>
    </math>
  </div>
</div>

<div id="luminosity_y" class="def">
  <span class="def"><code>luminosity_y</code></span>
  <div class="def">
    <pre>
    Luminosity_y luminosity_y(<a href="#Spectrum">Spectrum</a> nA, <a href="#Spectrum">Spectrum</a> nB);
    </pre>
    Photon-photon luminosity in ultraperipheral collision of particles
    <math><mi>A</mi></math> and <math><mi>B</mi></math> differentiated with
    respect to both invariant mass of the photons
    <math><msqrt> <si>s</si> </msqrt></math> and rapidity of the system
    <math><mi>y</mi></math>:
    <math display="block">
      <mfrac>
        <mrow>
          <mtext>d</mtext>
          <msub> <mi>L</mi> <mrow> <mi>A</mi> <mi>B</mi> </mrow> </msub>
        </mrow>
        <mrow>
          <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
          <mspace width="3pt"/>
          <mtext>d</mtext> <mi>y</mi>
        </mrow>
      </mfrac>
      <mrow>
        <mo>(</mo>
        <msqrt><mi>s</mi></msqrt>
        <mo>,</mo>
        <mi>y</mi>
        <mo>)</mo>
      </mrow>
      <mo>=</mo>
      <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
      <msub> <mi>n</mi> <mi>A</mi> </msub>
      <mrow>
        <mo>(</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mi>y</mi> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <msub> <mi>n</mi> <mi>B</mi> </msub>
      <mrow>
        <mo>(</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup>
          <mn>e</mn>
          <mrow> <mo>-</mo> <mi>y</mi> </mrow>
        </msup>
        <mo>)</mo>
      </mrow>
    </math>
  </div>
  <div class="def">
    <pre>
    Luminosity_y luminosity_y(<a href="#Spectrum">Spectrum</a>);
    </pre>
    Convenience function for the collision of identical particles.
  </div>
</div>


<div id="luminosity_fid" class="def">
  <span class="def"><code>luminosity_fid</code></span>
  <div class="def">
    <pre>
    Luminosity_fid luminosity_fid(<a href="#Spectrum">Spectrum</a> nA, <a href="#Spectrum">Spectrum</a> nB, <a href="#Integrator">Integrator</a> = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>));
    </pre>
    Photon-photon luminosity in ultraperipheral collisions of particles
    <math><mi>A</mi></math> and <math><mi>B</mi></math> differentiated with
    respect to the invariant mass of the photons
    <math><msqrt><mi>s</mi></msqrt></math> with parameterized bounds for the
    rapidity integral:
    <math display="block">
      <mfrac>
        <mrow>
          <mtext>d</mtext>
          <msub> <mi>L</mi> <mrow> <mi>A</mi> <mi>B</mi> </mrow> </msub>
        </mrow>
        <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
      </mfrac>
      <mrow>
        <mo>(</mo>
        <msqrt><mi>s</mi></msqrt>
        <mo>,</mo>
        <msub> <mi>y</mi> <mtext>min</mtext> </msub>
        <mo>,</mo>
        <msub> <mi>y</mi> <mtext>max</mtext> </msub>
        <mo>)</mo>
      </mrow>
      <mo>=</mo>
      <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
      <mrow>
        <msubsup>
          <mo>&int;</mo>
          <msub> <mi>y</mi> <mtext>min</mtext> </msub>
          <msub> <mi>y</mi> <mtext>max</mtext> </msub>
        </msubsup>
        <msub> <mi>n</mi> <mi>A</mi> </msub>
        <mrow>
          <mo>(</mo>
          <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
          <msup> <mn>e</mn> <mi>y</mi> </msup>
          <mo>)</mo>
        </mrow>
        <mspace width="3pt"/>
        <msub> <mi>n</mi> <mi>B</mi> </msub>
        <mrow>
          <mo>(</mo>
          <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
          <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
          <mo>)</mo>
        </mrow>
        <mtext>d</mtext> <mi>y</mi>.
      </mrow>
    </math>
  </div>
  <div class="def">
    <pre>
    Luminosity_fid luminosity_fid(<a href="#Spectrum">Spectrum</a>, <a href="#Integrator">Integrator</a> = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>));
    </pre>
    Convenience function for the collision of identical particles. In the case when
    <math>
      <msub> <mi>y</mi> <mtext>min</mtext> </msub>
      <mo>=</mo>
      <mo>-</mo>
      <msub> <mi>y</mi> <mtext>max</mtext> </msub>,
    </math>
    it takes into account the symmetry of the integrand, improving on
    convergence and calculation time.
  </div>
</div>

<div id="Polarization" class="def">
  <span class="def"><code>Polarization</code></span>
  <pre>
    <span class="type">struct</span> Polarization {
      <span class="type">double</span> parallel;
      <span class="type">double</span> perpendicular;
    };
  </pre>
  Describes the relative polarization of colliding photons.
</div>

<div id="Luminosity_b" class="def">
  <a id="Luminosity_y_b"></a>
  <a id="Luminosity_fid_b"></a>
  <span class="def">
    <code>Luminosity_b</code>,
    <code>Luminosity_y_b</code>,
    <code>Luminosity_fid_b</code>
  </span>
  <pre>
    <span class="type">typedef</span> std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* <math><msqrt><mi>s</mi></msqrt></math> */</span>, <a href="#Polarization">Polarization</a> <span class="comment">/* p */</span>)&gt; Luminosity_b

    <span class="type">typedef</span> std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* <math><msqrt><mi>s</mi></msqrt></math> */</span>, <span class="type">double</span> <span class="comment">/* y */</span>, <a href="#Polarization">Polarization</a> <span class="comment">/* p */</span>)&gt; Luminosity_y_b;

    <span class="type">typedef</span> std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* <math><msqrt><mi>s</mi></msqrt></math> */</span>, <a href="#Polarization">Polarization</a> <span class="comment">/* p */</span>, <span class="type">double</span> <span class="comment">/* ymin */</span>, <span class="type">double</span> <span class="comment">/* ymax */</span>)&gt; Luminosity_fid_b;
  </pre>
  When non-electromagnetic interactions between the colliding particles are
  taken into account, part of the collision plane is excluded, and in this case
  polarization of the colliding photons is not summed over. Luminosity
  functions taking into account non-electromagnetic interactions compute two
  values, one for the photons with parallel polarization, another for the
  photons with perpendicular polarization. The <code>p</code> parameter
  provides the weights to multiply these values. Pass
  <code>p.parallel = 1</code>, <code>p.perpendicular = 0</code> to take only
  the parallel photon polarizations into account, <code>p.parallel = 1</code>,
  <code>p.perpendicular = 1</code> to take both polarizations into account. Use
  the values calculated by <a href="#XSection_b">XSection_b</a> functions to
  calculate the cross section.
</div>

<div id="luminosity_b" class="def">
  <span class="def"><code>luminosity_b</code></span>
  <pre>
    Luminosity_b luminosity_b(
      <a href="#Spectrum_b">Spectrum_b</a> nA,
      <a href="#Spectrum_b">Spectrum_b</a> nB,
      std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* b */</span>)&gt; upc_probability,
      <span class="type">const</span> std::function&lt;<a href="#Integrator">Integrator</a> (<span class="type">unsigned</span>)&gt;&amp; = <a href="#default_integrator">default_integrator</a>,
      <span class="type">unsigned</span> integration_level = <span class="literal">0</span>
    );
  </pre>
  Photon-photon luminosity in ultraperipheral collisions of particles
  <math><mi>A</mi></math> and <math><mi>B</mi></math> differentiated with
  respect to the invariant mass <math><msqrt><mi>s</mi></msqrt></math> of the
  photon-photon system:
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mrow> <mi>A</mi> <mi>B</mi> </mrow> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>,</mo>
      <mrow>
        <mo>{</mo>
        <msub> <mi>p</mi> <mo>&parallel;</mo> </msub>
        <mo>,</mo>
        <msub> <mi>p</mi> <mo>&perp;</mo> </msub>
        <mo>}</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub> <mi>p</mi> <mo>&parallel;</mo> </msub>
    <mfrac>
      <mrow>
        <mtext>d</mtext> <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow> <mo>(</mo> <msqrt><mi>s</mi></msqrt> <mo>)</mo> </mrow>
    <mo>+</mo>
    <msub> <mi>p</mi> <mo>&perp;</mo> </msub>
    <mfrac>
      <mrow>
        <mtext>d</mtext> <msub> <mi>L</mi> <mo>&perp;</mo> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow> <mo>(</mo> <msqrt><mi>s</mi></msqrt> <mo>)</mo> </mrow>
    <mo>,</mo>
  </math>
  where
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext> <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow> <mo>(</mo> <msqrt><mi>s</mi></msqrt> <mo>)</mo> </mrow>
    <mo>=</mo>
    <mfrac>
      <msqrt> <mi>s</mi> </msqrt>
      <mn>2</mn>
    </mfrac>
    <mrow>
      <msubsup>
        <mo>&int;</mo>
        <mrow> <mo>-</mo> <mn>∞</mn> </mrow>
        <mn>∞</mn>
      </msubsup>
      <mtext>d</mtext> <mi>y</mi>
      <mo>&int;</mo>
      <msup>
        <mtext>d</mtext> <mn>2</mn> </msup> <msub> <mi>b</mi> <mn>1</mn>
      </msub>
      <mo>&int;</mo>
      <msup>
        <mtext>d</mtext> <mn>2</mn> </msup> <msub> <mi>b</mi> <mn>2</mn>
      </msub>
      <mspace width="3pt"/>
      <msub> <mi>n</mi> <mi>A</mi> </msub>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>1</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mi>y</mi> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <msub> <mi>n</mi> <mi>B</mi> </msub>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>2</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <mi>P</mi> <mrow> <mo>(</mo> <mi>b</mi> <mo>)</mo> </mrow>
      <mspace width="3pt"/>
      <msup> <mtext>cos</mtext> <mn>2</mn> </msup> <mi>φ</mi>,
    </mrow>
  </math>
  <math display="block">
    <mfrac>
      <mrow> <mtext>d</mtext> <msub> <mi>L</mi> <mo>&perp;</mo> </msub> </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow> <mo>(</mo> <msqrt><mi>s</mi></msqrt> <mo>)</mo> </mrow>
    <mo>=</mo>
    <mfrac>
      <msqrt> <mi>s</mi> </msqrt>
      <mn>2</mn>
    </mfrac>
    <mrow>
      <msubsup>
        <mo>&int;</mo>
        <mrow> <mo>-</mo> <mn>∞</mn> </mrow>
        <mn>∞</mn>
      </msubsup>
      <mtext>d</mtext> <mi>y</mi>
      <mo>&int;</mo>
      <msup>
        <mtext>d</mtext>
        <mn>2</mn> </msup> <msub> <mi>b</mi> <mn>1</mn>
      </msub>
      <mo>&int;</mo>
      <msup> <mtext>d</mtext> <mn>2</mn> </msup>
      <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mspace width="3pt"/>
      <msub> <mi>n</mi> <mi>A</mi> </msub>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>1</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mi>y</mi> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <msub> <mi>n</mi> <mi>B</mi> </msub>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>2</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <mi>P</mi> <mrow> <mo>(</mo> <mi>b</mi> <mo>)</mo> </mrow>
      <mspace width="3pt"/>
      <msup> <mtext>sin</mtext> <mn>2</mn> </msup> <mi>φ</mi>,
    </mrow>
  </math>
  <math>
    <mtext>d</mtext> <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
    <mo>/</mo>
    <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
  </math>
  is the luminosity of photons with parallel polarizations, 
  <math>
    <mtext>d</mtext> <msub> <mi>L</mi> <mo>&perp;</mo> </msub>
    <mo>/</mo>
    <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
  </math>
  is the luminosity of photons with perpendicular polarizations,
  <math> <mi>P</mi> <mo>(</mo> <mi>b</mi> <mo>)</mo> </math>
  is <code>upc_probability</code>, the probability for the particles to survive
  in an ultraperipheral collision with the impact parameter
  <math><mi>b</mi></math> (the probability to avoid electromagnetic
  interactions),
  <math>
    <mi>b</mi>
    <mo>=</mo>
    <mo>|</mo>
    <mover accent="true">
      <msub> <mi>b</mi> <mn>1</mn> </msub>
      <mo>&rarr;</mo>
    </mover>
    <mo>-</mo>
    <mover accent="true">
      <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mo>&rarr;</mo>
    </mover>
    <mo>|</mo>.
  </math>
  <code>integration_level</code>  is the integration level of the outermost
  integral to be calculated by the returned function.
</div>

<div id="luminosity_y_b" class="def">
  <span class="def"><code>luminosity_y_b</code></span>
  <pre>
    Luminosity_y_b luminosity_y_b(
      <a href="#Spectrum_b">Spectrum_b</a> nA,
      <a href="#Spectrum_b">Spectrum_b</a> nB,
      std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* b */</span>)&gt; upc_probability,
      <span class="type">const</span> std::function&lt;<a href="#Integrator">Integrator</a> (<span class="type">unsigned</span>)&gt;&amp; = <a href="#default_integrator">default_integrator</a>,
      <span class="type">unsigned</span> integration_level = <span class="literal">0</span>
    );
  </pre>
  Photon-photon luminosity in ultraperipheral collisions of particles
  <math><mi>A</mi></math> and <math><mi>B</mi></math> differentiated with
  respect to the photons invariant mass <math><msqrt><mi>s</mi></msqrt></math>
  and rapidity <math><mi>y</mi></math>:
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mrow> <mi>A</mi> <mi>B</mi> </mrow> </msub>
      </mrow>
      <mrow>
        <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
        <mspace width="3pt"/>
        <mtext>d</mtext> <mi>y</mi>
      </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>,</mo>
      <mi>y</mi>
      <mo>,</mo>
      <mrow>
        <mo>{</mo>
        <msub> <mi>p</mi> <mo>&parallel;</mo> </msub>
        <mo>,</mo>
        <msub> <mi>p</mi> <mo>&perp;</mo> </msub>
        <mo>}</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub> <mi>p</mi> <mo>&parallel;</mo> </msub>
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
      </mrow>
      <mrow>
        <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> 
        <mspace width="3pt"/>
        <mtext>d</mtext> <mi>y</mi>
      </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt><mi>s</mi></msqrt>
      <mo>,</mo>
      <mi>y</mi>
      <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <msub> <mi>p</mi> <mo>&perp;</mo> </msub>
    <mfrac>
      <mrow> <mtext>d</mtext> <msub> <mi>L</mi> <mo>&perp;</mo> </msub> </mrow>
      <mrow>
        <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> 
        <mspace width="3pt"/>
        <mtext>d</mtext> <mi>y</mi>
      </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt><mi>s</mi></msqrt>
      <mo>,</mo>
      <mi>y</mi>
      <mo>)</mo>
    </mrow>
  </math>
  where
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
      </mrow>
      <mrow>
        <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
        <mspace width="3pt"/>
        <mtext>d</mtext> <mi>y</mi>
      </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt><mi>s</mi></msqrt>
      <mo>,</mo>
      <mi>y</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <msqrt> <mi>s</mi> </msqrt>
      <mn>2</mn>
    </mfrac>
    <mrow>
      <mo>&int;</mo>
      <msup> <mtext>d</mtext> <mn>2</mn> </msup>
      <msub> <mi>b</mi> <mn>1</mn> </msub>
      <mo>&int;</mo>
      <msup> <mtext>d</mtext> <mn>2</mn> </msup>
      <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mspace width="3pt"/>
      <msub> <mi>n</mi> <mi>A</mi> </msub>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>1</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mi>y</mi> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <msub> <mi>n</mi> <mi>B</mi> </msub>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>2</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <mi>P</mi> <mrow> <mo>(</mo> <mi>b</mi> <mo>)</mo> </mrow>
      <mspace width="3pt"/>
      <msup> <mtext>cos</mtext> <mn>2</mn> </msup> <mi>φ</mi>,
    </mrow>
  </math>
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext> <msub> <mi>L</mi> <mo>&perp;</mo> </msub>
      </mrow>
      <mrow>
        <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
        <mspace width="3pt"/>
        <mtext>d</mtext> <mi>y</mi>
      </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt><mi>s</mi></msqrt>
      <mo>,</mo>
      <mi>y</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <msqrt> <mi>s</mi> </msqrt>
      <mn>2</mn>
    </mfrac>
    <mrow>
      <mo>&int;</mo>
      <msup> <mtext>d</mtext> <mn>2</mn> </msup>
      <msub> <mi>b</mi> <mn>1</mn> </msub>
      <mo>&int;</mo>
      <msup> <mtext>d</mtext> <mn>2</mn> </msup>
      <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mspace width="3pt"/>
      <msub> <mi>n</mi> <mi>A</mi> </msub>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>1</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mi>y</mi> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <msub> <mi>n</mi> <mi>B</mi> </msub>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>2</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <mi>P</mi> <mrow> <mo>(</mo> <mi>b</mi> <mo>)</mo> </mrow>
      <mspace width="3pt"/>
      <msup> <mtext>sin</mtext> <mn>2</mn> </msup> <mi>φ</mi>,
    </mrow>
  </math>
  <math>
    <mtext>d</mtext> <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
    <mo>/</mo>
    <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
  </math>
  is the luminosity of photons with parallel polarizations, 
  <math>
    <mtext>d</mtext> <msub> <mi>L</mi> <mo>&perp;</mo> </msub>
    <mo>/</mo>
    <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
  </math>
  is the luminosity of photons with perpendicular polarizations,
  <math> <mi>P</mi> <mo>(</mo> <mi>b</mi> <mo>)</mo> </math>
  is <code>upc_probability</code>, the probability for the particles to survive
  in an ultraperipheral collision with the impact parameter
  <math><mi>b</mi></math> (the probability to avoid electromagnetic
  interactions),
  <math>
    <mi>b</mi>
    <mo>=</mo>
    <mo>|</mo>
    <mover accent="true">
      <msub> <mi>b</mi> <mn>1</mn> </msub>
      <mo>&rarr;</mo>
    </mover>
    <mo>-</mo>
    <mover accent="true">
      <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mo>&rarr;</mo>
    </mover>
    <mo>|</mo>.
  </math>
  <code>integration_level</code>  is the integration level of the outermost
  integral to be calculated by the returned function.
</div>

<div id="luminosity_fid_b" class="def">
  <span class="def"><code>luminosity_fid_b</code></span>
  <pre>
    Luminosity_fid_b luminosity_fid_b(
      <a href="#Spectrum_b">Spectrum_b</a> nA,
      <a href="#Spectrum_b">Spectrum_b</a> nB,
      std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* b */</span>)&gt; upc_probability,
      <span class="type">const</span> std::function&lt;<a href="#Integrator">Integrator</a> (<span class="type">unsigned</span>)&gt;&amp; = <a href="#default_integrator">default_integrator</a>,
      <span class="type">unsigned</span> integration_level = <span class="literal">0</span>
    );
  </pre>
  Photon-photon luminosity in ultraperipheral collisions of particles
  <math><mi>A</mi></math> and <math><mi>B</mi></math> differentiated with
  respect to the photons invariant mass <math><msqrt><mi>s</mi></msqrt></math>
  with parameterized bounds on the rapidity integral:
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mrow> <mi>A</mi> <mi>B</mi> </mrow> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>,</mo>
      <mrow>
        <mo>{</mo>
        <msub> <mi>p</mi> <mo>&parallel;</mo> </msub>
        <mo>,</mo>
        <msub> <mi>p</mi> <mo>&perp;</mo> </msub>
        <mo>}</mo>
      </mrow>
      <mo>,</mo>
      <msub> <mi>y</mi> <mtext>min</mtext> </msub>
      <mo>,</mo>
      <msub> <mi>y</mi> <mtext>max</mtext> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub> <mi>p</mi> <mo>&parallel;</mo> </msub>
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow> <mo>(</mo> <msqrt><mi>s</mi></msqrt> <mo>)</mo> </mrow>
    <mo>+</mo>
    <msub> <mi>p</mi> <mo>&perp;</mo> </msub>
    <mfrac>
      <mrow> <mtext>d</mtext> <msub> <mi>L</mi> <mo>&perp;</mo> </msub> </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow> <mo>(</mo> <msqrt><mi>s</mi></msqrt> <mo>)</mo> </mrow>,
  </math>
  where
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow> <mo>(</mo> <msqrt><mi>s</mi></msqrt> <mo>)</mo> </mrow>
    <mo>=</mo>
    <mfrac>
      <msqrt> <mi>s</mi> </msqrt>
      <mn>2</mn>
    </mfrac>
    <mrow>
      <msubsup>
        <mo>&int;</mo>
        <msub> <mi>y</mi> <mtext>min</mtext> </msub>
        <msub> <mi>y</mi> <mtext>max</mtext> </msub>
      </msubsup>
      <mtext>d</mtext> <mi>y</mi>
      <mo>&int;</mo>
      <msup> <mtext>d</mtext> <mn>2</mn>
      </msup> <msub> <mi>b</mi> <mn>1</mn> </msub>
      <mo>&int;</mo>
      <msup> <mtext>d</mtext> <mn>2</mn> </msup>
      <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mspace width="3pt"/>
      <msub> <mi>n</mi> <mi>A</mi> </msub>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>1</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mi>y</mi> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <msub> <mi>n</mi> <mi>B</mi> </msub>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>2</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <mi>P</mi> <mrow> <mo>(</mo> <mi>b</mi> <mo>)</mo> </mrow>
      <mspace width="3pt"/>
      <msup> <mtext>cos</mtext> <mn>2</mn> </msup> <mi>φ</mi>,
    </mrow>
  </math>
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mo>&perp;</mo> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow> <mo>(</mo> <msqrt><mi>s</mi></msqrt> <mo>)</mo> </mrow>
    <mo>=</mo>
    <mfrac>
      <msqrt> <mi>s</mi> </msqrt>
      <mn>2</mn>
    </mfrac>
    <mrow>
      <msubsup>
        <mo>&int;</mo>
        <msub> <mi>y</mi> <mtext>min</mtext> </msub>
        <msub> <mi>y</mi> <mtext>max</mtext> </msub>
      </msubsup>
      <mtext>d</mtext> <mi>y</mi>
      <mo>&int;</mo>
      <msup> <mtext>d</mtext> <mn>2</mn> </msup>
      <msub> <mi>b</mi> <mn>1</mn> </msub>
      <mo>&int;</mo>
      <msup> <mtext>d</mtext> <mn>2</mn> </msup>
      <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mspace width="3pt"/>
      <msub> <mi>n</mi> <mi>A</mi> </msub>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>1</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mi>y</mi> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <msub> <mi>n</mi> <mi>B</mi> </msub>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>2</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <mi>P</mi> <mrow> <mo>(</mo> <mi>b</mi> <mo>)</mo> </mrow>
      <mspace width="3pt"/>
      <msup> <mtext>sin</mtext> <mn>2</mn> </msup> <mi>φ</mi>,
    </mrow>
  </math>
  <math>
    <mtext>d</mtext> <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
    <mo>/</mo>
    <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
  </math>
  is the luminosity of photons with parallel polarizations, 
  <math>
    <mtext>d</mtext> <msub> <mi>L</mi> <mo>&perp;</mo> </msub>
    <mo>/</mo>
    <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
  </math>
  is the luminosity of photons with perpendicular polarizations,
  <math> <mi>P</mi> <mo>(</mo> <mi>b</mi> <mo>)</mo> </math>
  is <code>upc_probability</code>, the probability for the particles to survive
  in an ultraperipheral collision with the impact parameter
  <math><mi>b</mi></math> (the probability to avoid electromagnetic
  interactions),
  <math>
    <mi>b</mi>
    <mo>=</mo>
    <mo>|</mo>
    <mover accent="true">
      <msub> <mi>b</mi> <mn>1</mn> </msub>
      <mo>&rarr;</mo>
    </mover>
    <mo>-</mo>
    <mover accent="true">
      <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mo>&rarr;</mo>
    </mover>
    <mo>|</mo>.
  </math>
  <code>integration_level</code>  is the integration level of the outermost
  integral to be calculated by the returned function.
</div>

<h5 id="epa-xsections">Cross sections of ultraperipheral collisions</h5>

<div id="XSection" class="def">
  <span class="def"><code>XSection</code></span>
  <pre>
    <span class="type">typedef</span> std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* <math><msqrt><mi>s</mi></msqrt></math> */</span>)&gt; XSection;
  </pre>
  Cross section for the invariant mass <math><msqrt><mi>s</mi></msqrt></math>
  (<math><mi>s</mi></math> is the Mandelstam parameter).
  Some functions use this type to denote cross section differentiated with respect
  to <math><msqrt><mi>s</mi></msqrt></math>:
  <math>
    <mtext>d</mtext>
    <mi>σ</mi>
    <mo>/</mo>
    <mtext>d</mtext>
    <msqrt> <mi>s</mi> </msqrt>.
  </math>
</div>

<div id="XSection_b" class="def">
  <span class="def"><code>XSection_b</code></span>
  <pre>
    <span class="type">typedef</span> std::function&lt;<a href="#Polarization">Polarization</a> (<span class="type">double</span> <span class="comment">/* s */</span>)&gt; XSection_b;
  </pre>
  Photon fusion cross section taking into account photons polarization. Returns
  two values: cross sections for the parallel and perpendicular photons
  polarizations respectively.
</div>

<div id="xsection" class="def">
  <span class="def"><code>xsection</code></span>
  <pre>
    XSection xsection(XSection <span class="comment">/* photon_photon */</span>, <a href="#Luminosity">Luminosity</a>);
  </pre>
  Differential cross section for the production of system
  <math><mi>X</mi></math> in ultraperipheral collisions with photon-photon
  luminosity <math><mi>L</mi></math> with non-electromagnetic interactions
  neglected:
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub>
          <mi>σ</mi>
          <mrow>
            <mi>A</mi> <mi>B</mi> <mo>&rarr;</mo> <mi>A</mi> <mi>B</mi> <mi>X</mi>
          </mrow>
        </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub>
      <mi>σ</mi>
      <mrow> <mi>γ</mi> <mi>γ</mi> <mo>&rarr;</mo> <mi>X</mi> </mrow>
    </msub>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>)</mo>
    </mrow>
    <mspace width="2pt"/>
    <mo>&middot;</mo>
    <mspace width="2pt"/>
    <mfrac>
      <mrow> <mtext>d</mtext> <mi>L</mi> </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>)</mo>
    </mrow>,
  </math>
  where
  <math>
    <msub>
      <mi>σ</mi>
      <mrow> <mi>γ</mi> <mi>γ</mi> <mo>&rarr;</mo> <mi>X</mi> </mrow>
    </msub>
  </math>
  is <code>photon_photon</code>, the cross section for the fusion of two (real)
  photons.
</div>

<div id="xsection_fid" class="def">
  <span class="def"><code>xsection_fid</code></span>
  <div class="def">
    <pre>
    XSection xsection_fid(
      std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* s */</span>, <span class="type">double</span> <span class="comment">/* pT */</span>)&gt; xsection_pT,
      <a href="#Luminosity_fid">Luminosity_fid</a>,
      <span class="type">double</span> mass,   <span class="comment">// of the produced particle</span>
      <span class="type">double</span> pT_min,
      <span class="type">double</span> eta_max,
      <span class="type">double</span> ω1_min, <span class="comment">// use 0 for no limit</span>
      <span class="type">double</span> ω1_max, <span class="comment">// use infinity for no limit</span>
      <span class="type">double</span> ω2_min, <span class="comment">// use 0 for no limit</span>
      <span class="type">double</span> ω2_max, <span class="comment">// use infinity for no limit</span>
      <a href="#Integrator">Integrator</a> = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>)
    )
    </pre>
    Differential fiducial cross section for the production of a pair of particles
    <math>
      <msup><mi>χ</mi> <mo>+</mo> </msup> <msup> <mi>χ</mi> <mo>-</mo> </msup>
    </math>
    in an ultraperipheral collision of particles <math><mi>A</mi></math> and
    <math><mi>B</mi></math>
    <math>
      <mo>(</mo>
      <mi>A</mi> <mi>B</mi>
      <mo>&rarr;</mo>
      <mi>A</mi> <mi>B</mi> 
      <msup> <mi>χ</mi> <mo>+</mo> </msup> <msup> <mi>χ</mi> <mo>-</mo> </msup>
      <mo>)</mo>
    </math>
    with non-electromagnetic interactions neglected and with the constraints on phase space
    <math>
      <msubsup> <mi>p</mi> <mi>T</mi> <mn>±</mn></msubsup>
      <mo>&gt;</mo>
      <msub> <mover> <mi>p</mi> <mi>^</mi> </mover> <mi>T</mi> </msub>
    </math>,
    <math>
      <mrow>
        <mo>|</mo>
        <msup> <mi>η</mi> <mn>±</mn> </msup>
        <mo>|</mo>
      </mrow>
      <mo>&lt;</mo>
      <mover> <mi>η</mi> <mi>^</mi> </mover>
    </math>,
    <math>
      <msub> <mi>ω</mi> <mrow> <mn>1</mn>, <mtext>min</mtext> </mrow> </msub>
      <mo>&lt;</mo>
      <msub> <mi>ω</mi> <mn>1</mn> </msub>
      <mo>&lt;</mo>
      <msub> <mi>ω</mi> <mrow> <mn>1</mn>, <mtext>max</mtext> </mrow> </msub>
    </math>,
    <math>
      <msub> <mi>ω</mi> <mrow> <mn>2</mn>, <mtext>min</mtext> </mrow> </msub>
      <mo>&lt;</mo>
      <msub> <mi>ω</mi> <mn>2</mn> </msub>
      <mo>&lt;</mo>
      <msub> <mi>ω</mi> <mrow> <mn>2</mn>, <mtext>max</mtext> </mrow> </msub>
    </math>,
    where
    <math> <msubsup> <mi>p</mi> <mi>T</mi> <mn>±</mn> </msubsup> </math>
    and
    <math> <msup> <mi>η</mi> <mn>±</mn> </msup> </math>
    are the transverse momentum and pseudorapidity of
    <math> <msup> <mi>χ</mi> <mn>±</mn> </msup> </math>,
    and
    <math> <msub> <mi>ω</mi> <mn>1</mn> </msub> </math>,
    <math> <msub> <mi>ω</mi> <mn>2</mn> </msub> </math>
    are the photons energies:
    <math display="block">
      <mfrac>
        <mrow>
          <mtext>d</mtext>
          <msubsup>
            <mi>σ</mi>
            <mrow>
              <mi>A</mi>
              <mi>B</mi>
              <mo>&rarr;</mo>
              <mi>A</mi>
              <mi>B</mi>
              <msup> <mi>χ</mi> <mo>+</mo> </msup>
              <msup> <mi>χ</mi> <mo>-</mo> </msup>
            </mrow>
            <mtext>fid.</mtext>
          </msubsup>
        </mrow>
        <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
      </mfrac>
      <mo>=</mo>
      <mrow>
        <munderover>
          <mo>&int;</mo>
          <mrow>
            <mtext>max</mtext>
            <mo>(</mo>
            <msub> <mover> <mi>p</mi> <mi>^</mi> </mover> <mi>T</mi> </msub>
            <msub> <mover> <mi>p</mi> <mi>~</mi> </mover> <mi>T</mi> </msub>
            <mo>)</mo>
          </mrow>
          <mrow>
            <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
            <msqrt>
              <mrow>
                <mn>1</mn>
                <mo>-</mo>
                <mfrac>
                  <mrow>
                    <mn>4</mn>
                    <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
                  </mrow>
                  <mi>s</mi>
                </mfrac>
              </mrow>
            </msqrt>
          </mrow>
        </munderover>
        <mtext>d</mtext> <msub> <mi>p</mi> <mi>T</mi> </msub>
        <mfrac>
          <mrow>
            <mtext>d</mtext>
            <msub>
              <mi>σ</mi>
              <mrow>
                <mi>γ</mi>
                <mi>γ</mi>
                <mo>&rarr;</mo>
                <msup> <mi>χ</mi> <mo>+</mo> </msup>
                <msup> <mi>χ</mi> <mo>-</mo> </msup>
              </mrow>
            </msub>
          </mrow>
          <mrow> <mtext>d</mtext> <msub> <mi>p</mi> <mi>T</mi> </msub> </mrow>
        </mfrac>
        <mrow>
          <mo>(</mo>
          <mi>s</mi>
          <mo>,</mo>
          <msub> <mi>p</mi> <mi>T</mi> </msub>
          <mo>)</mo>
        </mrow>
        <mfrac>
          <mrow>
            <mtext>d</mtext>
            <msub> <mi>L</mi> <mrow> <mi>A</mi> <mi>B</mi> </mrow> </msub>
          </mrow>
          <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
        </mfrac>
        <mrow>
          <mo>(</mo>
          <msqrt> <mi>s</mi> </msqrt>
          <mo>,</mo>
          <mtext>max</mtext>
          <mrow>
            <mo>(</mo>
            <mo>-</mo>
            <mover> <mi>y</mi> <mi>^</mi> </mover>
            <mo>,</mo>
            <mover> <mi>y</mi> <mi>~</mi> </mover>
            <mo>)</mo>
          </mrow>
          <mo>,</mo>
          <mtext>min</mtext>
          <mrow>
            <mo>(</mo>
            <mover> <mi>y</mi> <mi>^</mi> </mover>
            <mo>,</mo>
            <mover> <mi>Y</mi> <mi>~</mi> </mover>
            <mo>)</mo>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>,
    </math>
    <math display="block">
      <msub> <mover> <mi>p</mi> <mi>~</mi> </mover> <mi>T</mi> </msub>
      <mo>=</mo>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <mtext>max</mtext>
              <mrow>
                <mo>(</mo>
                <msub> <mi>P</mi> <mi>T</mi> </msub>
                <mrow> <mo>(</mo> <mn>0</mn> <mo>)</mo> </mrow>
                <mo>,</mo>
                <msub> <mi>P</mi> <mi>T</mi> </msub>
                <mrow>
                  <mo>(</mo>
                  <mtext>max</mtext>
                  <mrow>
                    <mo>(</mo>
                    <mover> <mi>y</mi> <mi>~</mi> </mover>
                    <mo>,</mo>
                    <mo>-</mo>
                    <mover> <mi>Y</mi> <mi>~</mi> </mover>
                    <mo>)</mo>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>)</mo>
              </mrow>
              <mspace width="1ex"/> <mtext> if </mtext> <mspace width="1ex"/>
              <mfrac>
                <mrow>
                  <mn>4</mn>
                  <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
                </mrow>
                <mi>s</mi>
              </mfrac>
              <mrow>
                <mo>(</mo>
                <mn>1</mn>
                <mo>+</mo>
                <mfrac>
                  <mrow>
                    <msup> <mtext>sinh</mtext> <mn>2</mn> </msup>
                    <mo>(</mo>
                    <mtext>max</mtext>
                    <mo>(</mo>
                    <mover> <mi>y</mi> <mi>~</mi> </mover>
                    <mo>,</mo>
                    <mo>-</mo>
                    <mover> <mi>Y</mi> <mi>~</mi> </mover>
                    <mo>)</mo>
                    <mo>)</mo>
                  </mrow>
                  <mrow>
                    <msup> <mtext>cosh</mtext> <mn>2</mn> </msup>
                    <mover> <mi>η</mi> <mi>^</mi> </mover>
                  </mrow>
                </mfrac>
                <mo>)</mo>
              </mrow>
              <mo>&lt;</mo>
              <mn>1</mn>,
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <msub> <mi>P</mi> <mi>T</mi> </msub>
              <mo>(</mo>
              <mn>0</mn>
              <mo>)</mo>
              <mspace width="1ex"/> <mtext>otherwise,</mtext>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </math>
    <math display="block">
      <msub> <mi>P</mi> <mi>T</mi> </msub>
      <mrow>
        <mo>(</mo>
        <mi>Y</mi>
        <mo>)</mo>
      </mrow>
      <mo>=</mo>
      <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>4</mn> </mfrac>
      <mrow>
        <mo>[</mo>
        <mfrac>
          <mrow>
            <mn>1</mn>
            <mo>+</mo>
            <msqrt>
              <mn>1</mn>
              <mo>-</mo>
              <mfrac>
                <mrow>
                  <mn>4</mn>
                  <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
                </mrow>
                <mi>s</mi>
              </mfrac>
              <mrow>
                <mo>(</mo>
                <mn>1</mn>
                <mo>+</mo>
                <mfrac>
                  <mrow>
                    <msup> <mtext>sinh</mtext> <mn>2</mn> </msup>
                    <mi>Y</mi>
                  </mrow>
                  <mrow>
                    <msup> <mtext>cosh</mtext> <mn>2</mn> </msup>
                    <mover> <mi>η</mi> <mi>^</mi> </mover>
                  </mrow>
                </mfrac>
                <mo>)</mo>
              </mrow>
            </msqrt>
          </mrow>
          <mrow>
            <mtext>cosh</mtext>
            <mo>(</mo>
            <mi>Y</mi>
            <mo>-</mo>
            <mover> <mi>η</mi> <mi>^</mi> </mover>
            <mo>)</mo>
          </mrow>
        </mfrac>
        <mo>-</mo>
        <mfrac>
          <mrow>
            <mn>1</mn>
            <mo>-</mo>
            <msqrt>
              <mn>1</mn>
              <mo>-</mo>
              <mfrac>
                <mrow>
                  <mn>4</mn>
                  <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
                </mrow>
                <mi>s</mi>
              </mfrac>
              <mrow>
                <mo>(</mo>
                <mn>1</mn>
                <mo>+</mo>
                <mfrac>
                  <mrow>
                    <msup> <mtext>sinh</mtext> <mn>2</mn> </msup>
                    <mi>Y</mi>
                  </mrow>
                  <mrow>
                    <msup> <mtext>cosh</mtext> <mn>2</mn> </msup>
                    <mover> <mi>η</mi> <mi>^</mi> </mover>
                  </mrow>
                </mfrac>
                <mo>)</mo>
              </mrow>
            </msqrt>
          </mrow>
          <mrow>
            <mtext>cosh</mtext>
            <mo>(</mo>
            <mi>Y</mi>
            <mo>+</mo>
            <mover> <mi>η</mi> <mi>^</mi> </mover>
            <mo>)</mo>
          </mrow>
        </mfrac>
        <mo>]</mo>,
      </mrow>
    </math>
    <math display="block">
      <mover> <mi>y</mi> <mi>^</mi> </mover>
      <mo>=</mo>
      <mtext>ln</mtext>
      <mrow>
        <mo>(</mo>
        <mfrac>
          <mrow>
            <mn>2</mn>
            <msub> <mi>p</mi> <mi>T</mi> </msub>
          </mrow>
          <msqrt> <mi>s</mi> </msqrt>
        </mfrac>
        <mo>·</mo>
        <mfrac>
          <mrow>
            <mtext>sinh</mtext>
            <mover> <mi>η</mi> <mi>^</mi> </mover>
            <mo>+</mo>
            <msqrt>
              <msup> <mtext>cosh</mtext> <mn>2</mn> </msup>
              <mover> <mi>η</mi> <mi>^</mi> </mover>
              <mo>+</mo>
              <mfrac>
                <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
                <msubsup> <mi>p</mi> <mi>T</mi> <mn>2</mn> </nsubsup>
              </mfrac>
            </msqrt>
          </mrow>
          <mrow>
            <mn>1</mn>
            <mo>+</mo>
            <msqrt>
              <mn>1</mn>
              <mo>-</mo>
              <mfrac>
                <mrow>
                  <msubsup> <mi>p</mi> <mi>T</mi> <mn>2</mn> </msubsup>
                  <mo>+</mo>
                  <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
                </mrow>
                <mrow> <mi>s</mi> <mo>/</mo> <mn>4</mn> </mrow>
              </mfrac>
            </msqrt>
          </mrow>
        </mfrac>
        <mo>)</mo>,
      </mrow>
    </math>
    <math display="block">
      <mover> <mi>y</mi> <mi>~</mi> </mover>
      <mo>=</mo>
      <mtext>ln</mtext>
      <mspace width="3pt"/>
      <mtext>max</mtext>
      <mrow>
        <mo>(</mo>
        <mfrac>
          <mrow>
            <mn>2</mn>
            <msub>
              <mi>ω</mi>
              <mrow> <mn>1</mn> <mo>,</mo> <mtext>min</mtext> </mrow>
            </msub>
          </mrow>
          <mi>s</mi>
        </mfrac>
        <mo>,</mo>
        <mfrac>
          <mi>s</mi>
          <mrow>
            <mn>2</mn>
            <msub>
              <mi>ω</mi>
              <mrow> <mn>2</mn> <mo>,</mo> <mtext>max</mtext> </mrow>
            </msub>
          </mrow>
        </mfrac>
        <mo>)</mo>
      </mrow>,
    </math>
    <math display="block">
      <mover> <mi>Y</mi> <mi>~</mi> </mover>
      <mo>=</mo>
      <mtext>ln</mtext>
      <mspace width="3pt"/>
      <mtext>max</mtext>
      <mrow>
        <mo>(</mo>
        <mfrac>
          <mrow>
            <mn>2</mn>
            <msub>
              <mi>ω</mi>
              <mrow> <mn>1</mn> <mo>,</mo> <mtext>max</mtext> </mrow>
            </msub>
          </mrow>
          <mi>s</mi>
        </mfrac>
        <mo>,</mo>
        <mfrac>
          <mi>s</mi>
          <mrow>
            <mn>2</mn>
            <msub>
              <mi>ω</mi>
              <mrow> <mn>2</mn> <mo>,</mo> <mtext>min</mtext> </mrow>
            </msub>
          </mrow>
        </mfrac>
        <mo>)</mo>
      </mrow>.
    </math>
    <b>
      The third argument to max in the expression for
      <math> <msub> <mover> <mi>p</mi> <mi>~</mi> </mover> <mi>T</mi> </msub> </math>
      currently neglects the mass of <math> <mi>χ</mi> </math>. To be updated.
    </b>
  </div>

  <div class="def">
    <pre>
    XSection xsection_fid(
      std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* s */</span>, <span class="type">double</span> <span class="comment">/* pT */</span>)&gt; xsection_pT,
      <a href="#Luminosity_fid">Luminosity_fid</a> luminosity,
      <span class="type">double</span> mass,
      <span class="type">double</span> pT_min,
      <span class="type">double</span> eta_max,
      <span class="type">double</span> ω_min,
      <span class="type">double</span> ω_max,
      <a href="#Integrator">Integrator</a> integrator = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>)
    )
    </pre>
    Convenience function for the case of symmetric bounds on energy losses of
    the colliding particles. Equivalent to 
    <code>xsection_fid(xsection_pT, luminosity, mass, pT_min, eta_max, ω_min, ω_max, ω_min, ω_max, integrator)</code>.
  </div>

  <div class="def">
    <pre>
    XSection xsection_fid(
      std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* s */</span>, <span class="type">double</span> <span class="comment">/* pT */</span>)&gt; xsection_pT,
      <a href="#Luminosity_fid">Luminosity_fid</a> luminosity,
      <span class="type">double</span> mass,
      <span class="type">double</span> pT_min,
      <span class="type">double</span> eta_max,
      <a href="#Integrator">Integrator</a> integrator = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>)
    )
    </pre>
    Convenience function for no bounds on the energy losses of the colliding
    particles. Equivalent to
    <code>xsection_fid(xsection_pT, luminosity, mass, pT_min, eta_max, <span class="literal">0</span>, infinity, <span class="literal">0</span>, integrator)</code>.
  </div>
</div>

<div id="xsection_fid_b" class="def">
  <span class="def"><code>xsection_fid_b</code></span>
  <div class="def">
    <pre>
    XSection xsection_fid_b(
      std::function&lt;<a href="#Polarization">Polarization</a> (<span class="type">double</span> <span class="comment">/* s */</span>, <span class="type">double</span> <span class="comment">/* pT */</span>)&gt; xsection_pT,
      <a href="#Luminosity_fid_b">Luminosity_fid_b</a>,
      <span class="type">double</span> mass,   <span class="comment">// of the produced particle</span>
      <span class="type">double</span> pT_min,
      <span class="type">double</span> eta_max,
      <span class="type">double</span> ω1_min, <span class="comment">// use 0 for no limit</span>
      <span class="type">double</span> ω1_max, <span class="comment">// use infinity for no limit</span>
      <span class="type">double</span> ω2_min, <span class="comment">// use 0 for no limit</span>
      <span class="type">double</span> ω2_max, <span class="comment">// use infinity for no limit</span>
      <a href="#Integrator">Integrator</a> = <a href="#cquad_integrator">cquad_integrator</a>(<span class="literal">0u</span>)
    )
    </pre>
    Differential fiducial cross section for the production of a pair of particles
    <math>
      <msup><mi>χ</mi> <mo>+</mo> </msup> <msup> <mi>χ</mi> <mo>-</mo> </msup>
    </math>
    in an ultraperipheral collision of particles <math><mi>A</mi></math> and
    <math><mi>B</mi></math>
    <math>
      <mo>(</mo>
      <mi>A</mi> <mi>B</mi>
      <mo>&rarr;</mo>
      <mi>A</mi> <mi>B</mi> 
      <msup> <mi>χ</mi> <mo>+</mo> </msup> <msup> <mi>χ</mi> <mo>-</mo> </msup>
      <mo>)</mo>
    </math>
    with non-electromagnetic interactions taken into account and with the
    constraints on phase space
    <math>
      <msubsup> <mi>p</mi> <mi>T</mi> <mn>±</mn></msubsup>
      <mo>&gt;</mo>
      <msub> <mover> <mi>p</mi> <mi>^</mi> </mover> <mi>T</mi> </msub>
    </math>,
    <math>
      <mrow>
        <mo>|</mo>
        <msup> <mi>η</mi> <mn>±</mn> </msup>
        <mo>|</mo>
      </mrow>
      <mo>&lt;</mo>
      <mover> <mi>η</mi> <mi>^</mi> </mover>
    </math>,
    <math>
      <msub> <mi>ω</mi> <mrow> <mn>1</mn>, <mtext>min</mtext> </mrow> </msub>
      <mo>&lt;</mo>
      <msub> <mi>ω</mi> <mn>1</mn> </msub>
      <mo>&lt;</mo>
      <msub> <mi>ω</mi> <mrow> <mn>1</mn>, <mtext>max</mtext> </mrow> </msub>
    </math>,
    <math>
      <msub> <mi>ω</mi> <mrow> <mn>2</mn>, <mtext>min</mtext> </mrow> </msub>
      <mo>&lt;</mo>
      <msub> <mi>ω</mi> <mn>2</mn> </msub>
      <mo>&lt;</mo>
      <msub> <mi>ω</mi> <mrow> <mn>2</mn>, <mtext>max</mtext> </mrow> </msub>
    </math>,
    where
    <math> <msubsup> <mi>p</mi> <mi>T</mi> <mn>±</mn> </msubsup> </math>
    and
    <math> <msup> <mi>η</mi> <mn>±</mn> </msup> </math>
    are the transverse momentum and pseudorapidity of
    <math> <msup> <mi>χ</mi> <mn>±</mn> </msup> </math>, and
    <math> <msub> <mi>ω</mi> <mn>1</mn> </msub> </math>,
    <math> <msub> <mi>ω</mi> <mn>2</mn> </msub> </math>
    are the photons energies:
    <math display="block">
      <mfrac>
        <mrow>
          <mtext>d</mtext>
          <msubsup>
            <mi>σ</mi>
            <mrow>
              <mi>A</mi>
              <mi>B</mi>
              <mo>&rarr;</mo>
              <mi>A</mi>
              <mi>B</mi>
              <msup> <mi>χ</mi> <mo>+</mo> </msup>
              <msup> <mi>χ</mi> <mo>-</mo> </msup>
            </mrow>
            <mtext>fid.</mtext>
          </msubsup>
        </mrow>
        <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
      </mfrac>
      <mrow>
        <mo>(</mo>
        <msqrt> <mi>s</mi> </msqrt>
        <mo>)</mo>
      </mrow>
      <mo>=</mo>
      <mrow>
        <munderover>
          <mo>&int;</mo>
          <mrow>
            <mtext>max</mtext>
            <mrow>
              <mo>(</mo>
              <msub> <mover> <mi>p</mi> <mi>^</mi> </mover> <mi>T</mi> </msub>
              <mo>,</mo>
              <msub> <mover> <mi>p</mi> <mi>~</mi> </mover> <mi>T</mi> </msub>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mrow>
            <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
            <msqrt>
              <mn>1</mn>
              <mo>-</mo>
              <mfrac>
                <mrow>
                  <mn>4</mn>
                  <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
                </mrow>
                <mi>s</mi>
              </mfrac>
            </msqrt>
          </mrow>
        </munderover>
        <mtext>d</mtext> <msub> <mi>p</mi> <mi>T</mi> </msub>
        <mfrac>
          <mrow>
            <mtext>d</mtext>
            <msub> <mi>L</mi> <mrow> <mi>A</mi> <mi>B</mi> </mrow> </msub>
          </mrow>
          <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
        </mfrac>
        <mrow>
          <mo>(</mo>
          <msqrt> <mi>s</mi> </msqrt>
          <mo>,</mo>
          <mrow>
            <mo>{</mo>
            <mfrac>
              <mrow>
                <mtext>d</mtext>
                <msubsup>
                  <mi>σ</mi>
                  <mrow>
                    <mi>γ</mi>
                    <mi>γ</mi>
                    <mo>&rarr;</mo>
                    <msup> <mi>χ</mi> <mo>+</mo> </msup>
                    <msup> <mi>χ</mi> <mo>-</mo> </msup>
                  </mrow>
                  <mo>&parallel;</mo>
                </msubsup>
              </mrow>
              <mrow>
                <mtext>d</mtext>
                <msub> <mi>p</mi> <mi>T</mi> </msub>
              </mrow>
            </mfrac>
            <mrow> <mo>(</mo> <mi>s</mi> <mo>)</mo> </mrow>
            <mo>,</mo>
            <mfrac>
              <mrow>
                <mtext>d</mtext>
                <msubsup>
                  <mi>σ</mi>
                  <mrow>
                    <mi>γ</mi>
                    <mi>γ</mi>
                    <mo>&rarr;</mo>
                    <msup> <mi>χ</mi> <mo>+</mo> </msup>
                    <msup> <mi>χ</mi> <mo>-</mo> </msup>
                  </mrow>
                  <mo>&perp;</mo>
                </msubsup>
              </mrow>
              <mrow>
                <mtext>d</mtext>
                <msub> <mi>p</mi> <mi>T</mi> </msub>
              </mrow>
            </mfrac>
            <mrow> <mo>(</mo> <mi>s</mi> <mo>)</mo> </mrow>
            <mo>}</mo>
          </mrow>
          <mo>,</mo>
          <mtext>max</mtext>
          <mrow>
            <mo>(</mo>
            <mo>-</mo>
            <mover> <mi>y</mi> <mi>^</mi> </mover>
            <mo>,</mo>
            <mover> <mi>y</mi> <mi>~</mi> </mover>
            <mo>)</mo>
          </mrow>
          <mo>,</mo>
          <mtext>min</mtext>
          <mrow>
            <mo>(</mo>
            <mover> <mi>y</mi> <mi>^</mi> </mover>
            <mo>,</mo>
            <mover> <mi>Y</mi> <mi>~</mi> </mover>
            <mo>)</mo>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>,
    </math>
    where
    <math>
      <mfrac>
        <mrow>
          <mtext>d</mtext>
          <msubsup>
            <mi>σ</mi>
            <mrow>
              <mi>γ</mi>
              <mi>γ</mi>
              <mo>&rarr;</mo>
              <msup> <mi>χ</mi> <mo>+</mo> </msup>
              <msup> <mi>χ</mi> <mo>-</mo> </msup>
            </mrow>
            <mo>&parallel;</mo>
          </msubsup>
        </mrow>
        <mrow> <mtext>d</mtext> <msub> <mi>p</mi> <mi>T</mi> </msub> </mrow>
      </mfrac>
      <mrow> <mo>(</mo> <mi>s</mi> <mo>)</mo> </mrow>
    </math>
    and
    <math>
      <mfrac>
        <mrow>
          <mtext>d</mtext>
          <msubsup>
            <mi>σ</mi>
            <mrow>
              <mi>γ</mi>
              <mi>γ</mi>
              <mo>&rarr;</mo>
              <msup> <mi>χ</mi> <mo>+</mo> </msup>
              <msup> <mi>χ</mi> <mo>-</mo> </msup>
            </mrow>
            <mo>&perp;</mo>
          </msubsup>
        </mrow>
        <mrow> <mtext>d</mtext> <msub> <mi>p</mi> <mi>T</mi> </msub> </mrow>
      </mfrac>
      <mrow> <mo>(</mo> <mi>s</mi> <mo>)</mo> </mrow>
    </math>
    are the cross sections for the fusion of photons with parallel and
    perpendicular polarizations respectively provided by the function
    <code>xsection_pT</code>. See <a href="#xsection_fid">xsection_fid</a> for
    the definitions of
    <math>
      <msub> <mover> <mi>p</mi> <mi>~</mi> </mover> <mi>T</mi> </msub>
    </math>,
    <math> <mover> <mi>y</mi> <mi>^</mi> </mover> </math>,
    <math> <mover> <mi>y</mi> <mi>~</mi> </mover> </math> and
    <math> <mover> <mi>Y</mi> <mi>~</mi> </mover> </math>.
  </div>

  <div class="def">
    <pre>
    XSection xsection_fid_b(
      std::function&lt;<a href="#Polarization">Polarization</a> (<span class="type">double</span> <span class="comment">/* s */</span>, <span class="type">double</span> <span class="comment">/* pT */</span>)&gt; xsection_pT,
      <a href="#Luminosity_fid">Luminosity_fid</a> luminosity,
      <span class="type">double</span> mass,
      <span class="type">double</span> pT_min,
      <span class="type">double</span> eta_max,
      <span class="type">double</span> ω_min,
      <span class="type">double</span> ω_max,
      <a href="#Integrator">Integrator</a> integrator = <a href="#cquad_integrator">cquad_integrator</a>(<span class="literal">0u</span>)
    )
    </pre>
    Convenience function for symmetric bounds on energy losses of the colliding
    particles. Equivalent to <code>xsection_fid_b(xsection_pT, luminosity,
    mass, pT_min, eta_max, ω_min, ω_max, ω_min, ω_max, integrator)</code>.
  </div>

  <div class="def">
    <pre>
    XSection xsection_fid_b(
      std::function&lt;<a href="#Polarization">Polarization</a> (<span class="type">double</span> <span class="comment">/* s */</span>, <span class="type">double</span> <span class="comment">/* pT */</span>)&gt; xsection_pT,
      <a href="#Luminosity_fid">Luminosity_fid</a> luminosity,
      <span class="type">double</span> mass,
      <span class="type">double</span> pT_min,
      <span class="type">double</span> eta_max,
      <a href="#Integrator">Integrator</a> integrator = <a href="#cquad_integrator">cquad_integrator</a>(<span class="literal">0u</span>)
    )
    </pre>
    Convenience function for no bounds on energy losses of the colliding
    particles. Equivalent to
    <code>xsection_fid_b(xsection_pT, luminosity, mass, pT_min, eta_max, <span class="literal">0</span>, infinity, <span class="literal">0</span>, infinity, integrator)</code>.
  </div>
</div>

<h5 id="epa-xsections-gg">Cross sections of photons fusion</h5>

<div id="photons_to_fermions" class="def">
  <span class="def"><code>photons_to_fermions</code></span>
  <pre>
    std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* s */</span>)&gt; photons_to_fermions(<span class="type">double</span> mass, <span class="type">double</span> charge = <span class="literal">1</span>);
  </pre>
  Cross section for the reaction
  <math>
    <mi>γ</mi>
    <mi>γ</mi>
    <mo>&rarr;</mo>
    <msup> <mi>χ</mi> <mo>+</mo> </msup>
    <msup> <mi>χ</mi> <mo>-</mo> </msup>:
  </math>
  <math display="block">
    <msub>
      <mi>σ</mi>
      <mrow>
        <mi>γ</mi>
        <mi>γ</mi>
        <mo>&rarr;</mo>
        <msup> <mi>χ</mi> <mo>+</mo> </msup>
        <msup> <mi>χ</mi> <mo>-</mo> </msup>
      </mrow>
    </msub>
    <mrow> <mo>(</mo> <mi>s</mi> <mo>)</mo> </mrow>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mn>4</mn>
        <mi>π</mi>
        <msup> <mi>α</mi> <mn>2</mn> </msup>
        <msup> <mi>Z</mi> <mn>4</mn> </msup>
      </mrow>
      <mi>s</mi>
    </mfrac>
    <mrow>
      <mo>[</mo>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>+</mo>
        <mfrac>
          <mrow>
            <mn>4</mn> <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
          </mrow>
          <mi>s</mi>
        </mfrac>
        <mo>-</mo>
        <mfrac>
          <mrow>
            <mn>8</mn> <msubsup> <mi>m</mi> <mi>χ</mi> <mn>4</mn> </msubsup>
          </mrow>
          <mi>s</mi>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <mtext>ln</mtext>
      <mfrac>
        <mrow>
          <mn>1</mn>
          <mo>+</mo>
          <msqrt>
            <mrow>
              <mn>1</mn>
              <mo>-</mo>
              <mn>4</mn>
              <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
              <mo>/</mo>
              <mi>s</mi>
            </mrow>
          </msqrt>
        </mrow>
        <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <msqrt>
            <mrow>
              <mn>1</mn>
              <mo>-</mo>
              <mn>4</mn>
              <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
              <mo>/</mo>
              <mi>s</mi>
            </mrow>
          </msqrt>
        </mrow>
      </mfrac>
      <mo>-</mo>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>+</mo>
        <mfrac>
          <mrow>
            <mn>4</mn> <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
          </mrow>
          <mi>s</mi>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <msqrt>
        <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mfrac>
            <mrow>
            <mn>4</mn> <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
            </mrow>
            <mi>s</mi>
          </mfrac>
        </mrow>
      </msqrt>
      <mo>]</mo>,
    </mrow>
  </math>
  where <math> <msup> <mi>χ</mi> <mn>±</mn> </msup> </math> is a fermion with
  the mass <math> <msub> <mi>m</mi> <mi>χ</mi> </msub> </math>
  (<code>mass</code>) and charge <math><mi>Z</mi></math> (<code>charge</code>),
  <math><msqrt><mi>s</mi></msqrt></math> is the invariant mass of the photons.
</div>

<div id="photons_to_fermions_pT" class="def">
  <span class="def"><code>photons_to_fermions_pT</code></span>
  <pre>
    std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* s */</span>, <span class="type">double</span> <span class="comment">/* pT */</span>)&gt; photons_to_fermions_pT(<span class="type">double</span> mass, <span class="type">double</span> charge = <span class="literal">1</span>);
  </pre>
  Differential cross section
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub>
          <mi>σ</mi>
          <mrow>
            <mi>γ</mi>
            <mi>γ</mi>
            <mo>&rarr;</mo>
            <msup> <mi>χ</mi> <mo>+</mo> </msup>
            <msup> <mi>χ</mi> <mo>-</mo> </msup>
          </mrow>
        </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msub> <mi>p</mi> <mi>T</mi> </msub> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <mi>s</mi>
      <mo>,</mo>
      <msub> <mi>p</mi> <mi>T</mi> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mn>8</mn>
        <mi>π</mi>
        <msup> <mi>α</mi> <mn>2</mn> </msup>
        <msup> <mi>Z</mi> <mn>4</mn> </msup>
        <msub> <mi>p</mi> <mi>T</mi> </msub>
      </mrow>
      <mrow>
        <mi>s</mi>
        <mo>(</mo>
        <msubsup> <mi>p</mi> <mi>T</mi> <mn>2</mn> </msubsup>
        <mo>+</mo>
        <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
        <mo>)</mo>
      </mrow>
    </mfrac>
    <mo>&middot;</mo>
    <mfrac>
      <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mfrac>
          <mrow>
            <mn>2</mn>
            <mo>(</mo>
            <msubsup> <mi>p</mi> <mi>T</mi> <mn>4</mn> </msubsup>
            <mo>+</mo>
            <msubsup> <mi>m</mi> <mi>χ</mi> <mn>4</mn> </msubsup>
            <mo>)</mo>
          </mrow>
          <mrow>
            <mi>s</mi>
            <mo>(</mo>
            <msubsup> <mi>p</mi> <mi>T</mi> <mn>2</mn> </msubsup>
            <mo>+</mo>
            <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
            <mo>)</mo>
          </mrow>
        </mfrac>
      </mrow>
      <msqrt>
        <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mfrac>
            <mrow>
              <mn>4</mn>
              <mo>(</mo>
              <msubsup> <mi>p</mi> <mi>T</mi> <mn>2</mn> </msubsup>
              <mo>+</mo>
              <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
              <mo>)</mo>
            </mrow>
            <mi>s</mi>
          </mfrac>
        </mrow>
      </msqrt>
    </mfrac>,
  </math>
  where <math> <msup> <mi>χ</mi> <mn>±</mn> </msup> </math> is a fermion with
  the mass <math> <msub> <mi>m</mi> <mi>χ</mi> </msub> </math>
  (<code>mass</code>) and charge <math><mi>Z</mi></math> (<code>charge</code>),
  <math><msqrt><mi>s</mi></msqrt></math> is the invariant mass of the photons,
  <math><msub><mi>p</mi><mi>T</mi></msub></math> is the transverse momentum of
  each of the fermions in the center of mass system.
</div>

<div id="photons_to_fermions_b" class="def">
  <span class="def"><code>photons_to_fermions_b</code></span>
  <pre>
    std::function&lt;<a href="#Polarization">Polarization</a> (<span class="type">double</span> <span class="comment">/* s */</span>)&gt; photons_to_fermions_b(<span class="type">double</span> mass, <span class="type">double</span> charge = <span class="literal">1</span>);
  </pre>
  Cross section for the reaction
  <math>
    <mi>γ</mi>
    <mi>γ</mi>
    <mo>&rarr;</mo>
    <msup> <mi>χ</mi> <mo>+</mo> </msup>
    <msup> <mi>χ</mi> <mo>-</mo> </msup>
  </math>
  with polarized photons. Returns two values:
  <math display="block">
    <msubsup>
      <mi>σ</mi>
      <mrow>
        <mi>γ</mi>
        <mi>γ</mi>
        <mo>&rarr;</mo>
        <msup> <mi>χ</mi> <mo>+</mo> </msup>
        <msup> <mi>χ</mi> <mo>-</mo> </msup>
      </mrow>
      <mo>&parallel;</mo>
    </msubsup>
    <mrow> <mo>(</mo> <mi>s</mi> <mo>)</mo> </mrow>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mn>4</mn>
        <mi>π</mi>
        <msup> <mi>α</mi> <mn>2</mn> </msup>
        <msup> <mi>Z</mi> <mn>4</mn> </msup>
      </mrow>
      <mi>s</mi>
    </mfrac>
    <mrow>
      <mo>[</mo>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>+</mo>
        <mfrac>
          <mrow>
            <mn>4</mn> <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
          </mrow>
          <mi>s</mi>
        </mfrac>
        <mo>-</mo>
        <mfrac>
          <mrow>
            <mn>12</mn> <msubsup> <mi>m</mi> <mi>χ</mi> <mn>4</mn> </msubsup>
          </mrow>
          <mi>s</mi>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <mtext>ln</mtext>
      <mfrac>
        <mrow>
          <mn>1</mn>
          <mo>+</mo>
          <msqrt>
            <mrow>
              <mn>1</mn>
              <mo>-</mo>
              <mn>4</mn>
              <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
              <mo>/</mo>
              <mi>s</mi>
            </mrow>
          </msqrt>
        </mrow>
        <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <msqrt>
            <mrow>
              <mn>1</mn>
              <mo>-</mo>
              <mn>4</mn>
              <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
              <mo>/</mo>
              <mi>s</mi>
            </mrow>
          </msqrt>
        </mrow>
      </mfrac>
      <mo>-</mo>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>+</mo>
        <mfrac>
          <mrow>
            <mn>6</mn> <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
          </mrow>
          <mi>s</mi>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <msqrt>
        <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mfrac>
            <mrow>
              <mn>4</mn> <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
            </mrow>
            <mi>s</mi>
          </mfrac>
        </mrow>
      </msqrt>
      <mo>]</mo>,
    </mrow>
  </math>
  <math display="block">
    <msubsup>
      <mi>σ</mi>
      <mrow>
        <mi>γ</mi>
        <mi>γ</mi>
        <mo>&rarr;</mo>
        <msup> <mi>χ</mi> <mo>+</mo> </msup>
        <msup> <mi>χ</mi> <mo>-</mo> </msup>
      </mrow>
      <mo>&perp;</mo>
    </msubsup>
    <mrow> <mo>(</mo> <mi>s</mi> <mo>)</mo> </mrow>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mn>4</mn>
        <mi>π</mi>
        <msup> <mi>α</mi> <mn>2</mn> </msup>
        <msup> <mi>Z</mi> <mn>4</mn> </msup>
      </mrow>
      <mi>s</mi>
    </mfrac>
    <mrow>
      <mo>[</mo>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>+</mo>
        <mfrac>
          <mrow>
            <mn>4</mn> <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
          </mrow>
          <mi>s</mi>
        </mfrac>
        <mo>-</mo>
        <mfrac>
          <mrow>
            <mn>4</mn> <msubsup> <mi>m</mi> <mi>χ</mi> <mn>4</mn> </msubsup>
          </mrow>
          <mi>s</mi>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <mtext>ln</mtext>
      <mfrac>
        <mrow>
          <mn>1</mn>
          <mo>+</mo>
          <msqrt>
            <mrow>
              <mn>1</mn>
              <mo>-</mo>
              <mn>4</mn>
              <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
              <mo>/</mo>
              <mi>s</mi>
            </mrow>
          </msqrt>
        </mrow>
        <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <msqrt>
            <mrow>
              <mn>1</mn>
              <mo>-</mo>
              <mn>4</mn>
              <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
              <mo>/</mo>
              <mi>s</mi>
            </mrow>
          </msqrt>
        </mrow>
      </mfrac>
      <mo>-</mo>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>+</mo>
        <mfrac>
          <mrow>
            <mn>2</mn> <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
          </mrow>
          <mi>s</mi>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <msqrt>
        <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mfrac>
            <mrow>
              <mn>4</mn> <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
            </mrow>
            <mi>s</mi>
          </mfrac>
        </mrow>
      </msqrt>
      <mo>]</mo>.
    </mrow>
  </math>
  Here 
  <math>
    <msubsup>
      <mi>σ</mi>
      <mrow>
        <mi>γ</mi>
        <mi>γ</mi>
        <mo>&rarr;</mo>
        <msup> <mi>χ</mi> <mo>+</mo> </msup>
        <msup> <mi>χ</mi> <mo>-</mo> </msup>
      </mrow>
      <mo>&parallel;</mo>
    </msubsup>
    <mrow> <mo>(</mo> <mi>s</mi> <mo>)</mo> </mrow>
  </math>
  is the cross section for the photons with parallel polarization,
  <math>
    <msubsup>
      <mi>σ</mi>
      <mrow>
        <mi>γ</mi>
        <mi>γ</mi>
        <mo>&rarr;</mo>
        <msup> <mi>χ</mi> <mo>+</mo> </msup>
        <msup> <mi>χ</mi> <mo>-</mo> </msup>
      </mrow>
      <mo>&perp;</mo>
    </msubsup>
    <mrow> <mo>(</mo> <mi>s</mi> <mo>)</mo> </mrow>
  </math>
  is the cross section for the photons with perpendicular polarization, <math>
  <msup> <mi>χ</mi> <mn>±</mn> </msup> </math> is a fermion with the mass
  <math> <msub> <mi>m</mi> <mi>χ</mi> </msub> </math> (<code>mass</code>) and
  charge <math><mi>Z</mi></math> (<code>charge</code>),
  <math><msqrt><mi>s</mi></msqrt></math> is the invariant mass of the photons.
</div>

<div id="photons_to_fermions_pT_b" class="def">
  <span class="def"><code>photons_to_fermions_pT_b</code></span>
  <pre>
    std::function&lt;Polarization (<span class="type">double</span> <span class="comment">/* s */</span>, <span class="type">double</span> <span class="comment">/* pT */</span>)&gt; photons_to_fermions_pT_b(<span class="type">double</span> mass, <span class="type">double</span> charge = <span class="literal">1</span>);
  </pre>
  Differential cross section returning two values:
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msubsup>
          <mi>σ</mi>
          <mrow>
            <mi>γ</mi>
            <mi>γ</mi>
            <mo>&rarr;</mo>
            <msup> <mi>χ</mi> <mo>+</mo> </msup>
            <msup> <mi>χ</mi> <mo>-</mo> </msup>
          </mrow>
          <mo>&parallel;</mo>
        </msubsup>
      </mrow>
      <mrow> <mtext>d</mtext> <msub> <mi>p</mi> <mi>T</mi> </msub> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <mi>s</mi>
      <mo>,</mo>
      <msub> <mi>p</mi> <mi>T</mi> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mn>8</mn>
        <mi>π</mi>
        <msup> <mi>α</mi> <mn>2</mn> </msup>
        <msup> <mi>Z</mi> <mn>4</mn> </msup>
        <msub> <mi>p</mi> <mi>T</mi> </msub>
      </mrow>
      <mrow>
        <mi>s</mi>
        <mo>(</mo>
        <msubsup> <mi>p</mi> <mi>T</mi> <mn>2</mn> </msubsup>
        <mo>+</mo>
        <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
        <mo>)</mo>
      </mrow>
    </mfrac>
    <mo>&middot;</mo>
    <mfrac>
      <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mfrac>
          <mrow>
            <mn>2</mn>
            <mo>(</mo>
            <msubsup> <mi>p</mi> <mi>T</mi> <mn>4</mn> </msubsup>
            <mo>+</mo>
            <mn>2</mn>
            <msubsup> <mi>m</mi> <mi>χ</mi> <mn>4</mn> </msubsup>
            <mo>)</mo>
          </mrow>
          <mrow>
            <mi>s</mi>
            <mo>(</mo>
            <msubsup> <mi>p</mi> <mi>T</mi> <mn>2</mn> </msubsup>
            <mo>+</mo>
            <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
            <mo>)</mo>
          </mrow>
        </mfrac>
      </mrow>
      <msqrt>
        <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mfrac>
            <mrow>
              <mn>4</mn>
              <mo>(</mo>
              <msubsup> <mi>p</mi> <mi>T</mi> <mn>2</mn> </msubsup>
              <mo>+</mo>
              <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
              <mo>)</mo>
            </mrow>
            <mi>s</mi>
          </mfrac>
        </mrow>
      </msqrt>
    </mfrac>,
  </math>
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msubsup>
          <mi>σ</mi>
          <mrow>
            <mi>γ</mi>
            <mi>γ</mi>
            <mo>&rarr;</mo>
            <msup> <mi>χ</mi> <mo>+</mo> </msup>
            <msup> <mi>χ</mi> <mo>-</mo> </msup>
          </mrow>
          <mo>&perp;</mo>
        </msubsup>
      </mrow>
      <mrow> <mtext>d</mtext> <msub> <mi>p</mi> <mi>T</mi> </msub> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <mi>s</mi>
      <mo>,</mo>
      <msub> <mi>p</mi> <mi>T</mi> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mn>8</mn>
        <mi>π</mi>
        <msup> <mi>α</mi> <mn>2</mn> </msup>
        <msup> <mi>Z</mi> <mn>4</mn> </msup>
        <msub> <mi>p</mi> <mi>T</mi> </msub>
      </mrow>
      <mrow>
        <mi>s</mi>
        <mo>(</mo>
        <msubsup> <mi>p</mi> <mi>T</mi> <mn>2</mn> </msubsup>
        <mo>+</mo>
        <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
        <mo>)</mo>
      </mrow>
    </mfrac>
    <mo>&middot;</mo>
    <mfrac>
      <mrow>
        <mn>1</mn>
        <mo>-</mo>
        <mfrac>
          <mrow>
            <mn>2</mn>
            <msubsup> <mi>p</mi> <mi>T</mi> <mn>4</mn> </msubsup>
          </mrow>
          <mrow>
            <mi>s</mi>
            <mo>(</mo>
            <msubsup> <mi>p</mi> <mi>T</mi> <mn>2</mn> </msubsup>
            <mo>+</mo>
            <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
            <mo>)</mo>
          </mrow>
        </mfrac>
      </mrow>
      <msqrt>
        <mrow>
          <mn>1</mn>
          <mo>-</mo>
          <mfrac>
            <mrow>
              <mn>4</mn>
              <mo>(</mo>
              <msubsup> <mi>p</mi> <mi>T</mi> <mn>2</mn> </msubsup>
              <mo>+</mo>
              <msubsup> <mi>m</mi> <mi>χ</mi> <mn>2</mn> </msubsup>
              <mo>)</mo>
            </mrow>
            <mi>s</mi>
          </mfrac>
        </mrow>
      </msqrt>
    </mfrac>,
  </math>
  Here 
  <math>
    <msubsup>
      <mi>σ</mi>
      <mrow>
        <mi>γ</mi>
        <mi>γ</mi>
        <mo>&rarr;</mo>
        <msup> <mi>χ</mi> <mo>+</mo> </msup>
        <msup> <mi>χ</mi> <mo>-</mo> </msup>
      </mrow>
      <mo>&parallel;</mo>
    </msubsup>
    <mrow> <mo>(</mo> <mi>s</mi> <mo>)</mo> </mrow>
  </math>
  is the cross section for the photons with parallel polarization,
  <math>
    <msubsup>
      <mi>σ</mi>
      <mrow>
        <mi>γ</mi>
        <mi>γ</mi>
        <mo>&rarr;</mo>
        <msup> <mi>χ</mi> <mo>+</mo> </msup>
        <msup> <mi>χ</mi> <mo>-</mo> </msup>
      </mrow>
      <mo>&perp;</mo>
    </msubsup>
    <mrow> <mo>(</mo> <mi>s</mi> <mo>)</mo> </mrow>
  </math>
  is the cross section for the photons with perpendicular polarization, <math>
  <msup> <mi>χ</mi> <mn>±</mn> </msup> </math> is a fermion with the mass
  <math> <msub> <mi>m</mi> <mi>χ</mi> </msub> </math> (<code>mass</code>) and
  charge <math><mi>Z</mi></math> (<code>charge</code>),
  <math><msqrt><mi>s</mi></msqrt></math> is the invariant mass of the photons,
  <math><msub><mi>p</mi><mi>T</mi></msub></math> is the transverse momentum of
  each of the fermions in the center of mass system.
</div>

<h4 id="proton">Proton</h4>

<pre>
  <span class="macro">#include</span> <span class="literal">&lt;epa/proton.hpp&gt;</span>
</pre>

This section is devoted to functions specific for proton and proton-proton
collisions. They are defined in the <code>epa</code> namespace as well.

<h5 id="proton-constants">Constants</h5>

<div class="table">
  <table>
    <tr>
      <th>Type</th>
      <th>Constant</th>
      <th>Value</th>
      <th>Units</th>
      <th>Comment</th>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td><a id="proton_mass"></a><code>proton_mass</code></td>
      <td><code><span class="literal">0.93827208816</span></code></td>
      <td>GeV</td>
      <td>Proton mass</td>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td><a id="proton_radius"></a><code>proton_radius</code></td>
      <td><code><span class="literal">0.8414</span> * fm</code></td>
      <td>GeV<sup>&minus;1</sup></td>
      <td>Proton radius</td>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td>
        <a id="proton_magnetic_moment"></a><code>proton_magnetic_moment</code>
      </td>
      <td><code><span class="literal">2.79284734463</span></code></td>
      <td><math><msub><mi>μ</mi><mi>B</mi></msub></math></td>
      <td>Proton magnetic moment in units of Bohr magneton</td>
    </tr>
    <tr>
      <td><code><span class="type">double</span></code></td>
      <td>
        <a id="proton_dipole_form_factor_lambda2"></a>
        <code>proton_dipole_form_factor_lambda2</code>
      </td>
      <td><span class="literal">12.0</span> / (proton_radius * proton_radius)</td>
      <td>GeV<sup>2</sup></td>
      <td>
        The <math><msup> <mn>Λ</mn> <mn>2</mn> </msup></math> parameter of the
        proton form factor
      </td>
    </tr>
  </table>
</div>

Numerical values are taken from E. Tiesinga, P. J. Mohr, D. B. Newell,
B. N. Taylor, <i>CODATA recommended values of the fundamental physical
constants: 2018</i>,
<a href="https://doi.org/10.1103/RevModPhys.93.025010">Reviews of Modern Physics 93, 025010 (2021)</a>.

<h5 id="proton-form-factors">Form factor</h5>

<div id="proton_dipole_form_factor" class="def">
  <span class="def"><code>proton_dipole_form_factor</code></span>
  <pre>
    <a href="#FormFactor">FormFactor</a> proton_dipole_form_factor(<span class="type">double</span> lambda2 = proton_dipole_form_factor_lambda2);
  </pre>
  Proton Dirac form factor in dipole approximation:
  <math display="block">
    <msub> <mi>F</mi> <mi>p</mi> </msub>
    <mrow>
      <mo>(</mo>
      <msup> <mi>Q</mi> <mn>2</mn> </msup>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mn>1</mn>
      <msup>
        <mrow>
          <mo>(</mo>
          <mn>1</mn>
          <mo>+</mo>
          <mfrac>
            <msup> <mi>Q</mi> <mn>2</mn> </msup>
            <msup> <mn>Λ</mn> <mn>2</mn> </msup>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <mn>2</mn>
      </msup>
    </mfrac>
    <mo>&middot;</mo>
    <mfrac>
      <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mfrac>
          <mrow>
            <msub> <mi>μ</mi> <mi>p</mi> </msub>
            <msup> <mi>Q</mi> <mn>2</mn> </msup>
          </mrow>
          <mrow>
            <mn>4</mn>
            <msubsup> <mi>m</mi> <mi>p</mi> <mn>2</mn> </msubsup>
          </mrow>
        </mfrac>
      </mrow>
      <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mfrac>
          <msup> <mi>Q</mi> <mn>2</mn> </msup>
          <mrow>
            <mn>4</mn>
            <msubsup> <mi>m</mi> <mi>p</mi> <mn>2</mn> </msubsup>
          </mrow>
        </mfrac>
      </mrow>
    </mfrac>,
  </math>
  where <math> <msub> <mi>μ</mi> <mi>p</mi> </msub> </math> is the proton
  magnetic moment, <math> <msub> <mi>m</mi> <mi>p</mi> </msub> </math> is the
  proton mass, <math> <msup> <mn>Λ</mn> <mn>2</mn> </msup> </math> is
  <code>lambda2</code>.
</div>

<h5 id="proton-spectrum">Equivalent photon spectrum</h5>

<div id="proton_dipole_spectrum" class="def">
  <span class="def"><code>proton_dipole_spectrum</code></span>
  <pre>
    <a href="#Spectrum">Spectrum</a> proton_dipole_spectrum(<span class="type">double</span> energy, <span class="type">double</span> lambda2 = proton_dipole_form_factor_lambda2);
  </pre>
  Equivalent photon spectrum for a proton of given energy with the form factor
  taken in dipole approximation and both Dirac and Pauli current terms taken
  into account:
  <math display="block">
    <msub>
      <mi>n</mi>
      <mi>p</mi>
    </msub>
    <mrow>
      <mo>(</mo>
      <mi>ω</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mi>α</mi>
      <mrow> <mi>π</mi> <mi>ω</mi> </mrow>
    </mfrac>
    <mrow>
      <mo>{</mo>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>+</mo>
        <mn>4</mn> <mi>u</mi>
        <mo>-</mo>
        <mrow>
          <mo>(</mo>
          <msubsup> <mi>μ</mi> <mi>p</mi> <mn>2</mn> </msubsup>
          <mo>-</mo>
          <mn>1</mn>
          <mo>)</mo>
        </mrow>
        <mfrac> <mi>u</mi> <mi>v</mi> </mfrac>
        <mo>)</mo>
      </mrow>
      <mtext>ln</mtext>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>+</mo>
        <mfrac> <mn>1</mn> <mi>u</mi> </mfrac>
        <mo>)</mo>
      </mrow>
      <mo>-</mo>
      <mfrac>
        <mrow>
          <mn>24</mn>
          <msup> <mi>u</mi> <mn>2</mn> </msup>
          <mo>+</mo>
          <mn>42</mn>
          <mi>u</mi>
          <mo>+</mo>
          <mn>17</mn>
        </mrow>
        <mrow>
          <mn>6</mn>
          <msup>
            <mrow>
              <mo>(</mo>
              <mi>u</mi>
              <mo>+</mo>
              <mn>1</mn>
              <mo>)</mo>
            </mrow>
            <mn>2</mn>
          </msup>
        </mrow>
      </mfrac>
      <mo>-</mo>
      <mfrac>
        <mrow>
          <msubsup> <mi>μ</mi> <mi>p</mi> <mn>2</mn> </msubsup>
          <mo>-</mo>
          <mn>1</mn>
        </mrow>
        <msup>
          <mrow>
            <mo>(</mo>
            <mi>v</mi>
            <mo>-</mo>
            <mn>1</mn>
            <mo>)</mo>
          </mrow>
          <mn>3</mn>
        </msup>
      </mfrac>
      <mrow>
        <mo>[</mo>
        <mfrac>
          <mrow>
            <mn>1</mn>
            <mo>+</mo>
            <mi>u</mi>
            <mo>/</mo>
            <mi>v</mi>
          </mrow>
          <mrow>
            <mi>v</mi>
            <mo>-</mo>
            <mn>1</mn>
          </mrow>
        </mfrac>
        <mtext>ln</mtext>
        <mfrac>
          <mrow> <mi>u</mi> <mo>+</mo> <mi>v</mi> </mrow>
          <mrow> <mi>u</mi> <mo>+</mo> <mn>1</mn> </mrow>
        </mfrac>
        <mo>-</mo>
        <mfrac>
          <mrow>
            <mn>6</mn>
            <msup> <mi>u</mi> <mn>2</mn> </msup>
            <mrow>
              <mo>(</mo>
              <msup> <mi>v</mi> <mn>2</mn> </msup>
              <mo>-</mo>
              <mn>3</mn>
              <mi>v</mi>
              <mo>+</mo>
              <mn>3</mn>
              <mo>)</mo>
            </mrow>
            <mo>+</mo>
            <mn>3</mn>
            <mi>u</mi>
            <mrow>
              <mo>(</mo>
              <mn>3</mn>
              <msup> <mi>v</mi> <mn>2</mn> </msup>
              <mo>-</mo>
              <mn>9</mn>
              <mi>v</mi>
              <mo>+</mo>
              <mn>10</mn>
              <mo>)</mo>
            </mrow>
            <mo>+</mo>
            <mn>2</mn>
            <msup> <mi>v</mi> <mn>2</mn> </msup>
            <mo>-</mo>
            <mn>7</mn>
            <mi>v</mi>
            <mo>+</mo>
            <mn>11</mn>
          </mrow>
          <mrow>
            <mn>6</mn>
            <msup>
              <mrow>
                <mo>(</mo>
                <mi>u</mi>
                <mo>+</mo>
                <mn>1</mn>
                <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
          </mrow>
        </mfrac>
        <mo>]</mo>
      </mrow>
      <mo>}</mo>
    </mrow>,
  </math>
  where
  <math display="block">
    <mi>u</mi>
    <mo>=</mo>
    <msup>
      <mrow>
        <mo>(</mo>
        <mfrac>
          <mi>ω</mi>
          <mrow> <mn>Λ</mn> <mi>γ</mi> </mrow>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <mn>2</mn>
    </msup>
    ,
    <mspace width="2em"/>
    <mi>v</mi>
    <mo>=</mo>
    <msup>
      <mrow>
        <mo>(</mo>
        <mfrac>
          <mrow>
            <mn>2</mn>
            <msub> <mi>m</mi> <mi>p</mi> </msub>
          </mrow>
          <mn>Λ</mn>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <mn>2</mn>
    </msup>.
  </math>
  This spectrum is obtained by integrating the function
  <math display="block">
    <msub> <mi>n</mi> <mi>p</mi> </msub>
    <mrow> <mo>(</mo> <mi>ω</mi> <mo>)</mo> </mrow>
    <mo>=</mo>
    <mfrac>
      <mrow> <mn>2</mn> <mi>α</mi> </mrow>
      <mrow> <mi>π</mi> <mi>ω</mi> </mrow>
    </mfrac>
    <mrow>
      <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
      <mfrac>
        <mrow>
          <mi>D</mi>
          <mrow>
            <mo>(</mo>
            <msubsup> <mi>q</mi> <mo>&perp;</mo> <mn>2</mn> </msubsup>
            <mo>+</mo>
            <msup>
              <mrow>
                <mo>(</mo>
                <mi>ω</mi>
                <mo>/</mo>
                <mi>γ</mi>
                <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
            <mo>)</mo>
          </mrow>
        </mrow>
        <msup>
          <mrow>
            <mo>(</mo>
            <msubsup> <mi>q</mi> <mo>&perp;</mo> <mn>2</mn> </msubsup>
            <mo>+</mo>
            <msup>
              <mrow>
                <mo>(</mo>
                <mi>ω</mi>
                <mo>/</mo>
                <mi>γ</mi>
                <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
            <mo>)</mo>
          </mrow>
          <mn>2</mn>
        </msup>
      </mfrac>
      <msubsup> <mi>q</mi> <mo>&perp;</mo> <mn>3</mn> </msubsup>
      <mtext>d</mtext> <msub> <mi>q</mi> <mo>&perp;</mo> </msub>,
    </mrow>
  </math>
  where
  <math display="block">
    <mi>D</mi>
    <mrow>
      <mo>(</mo>
      <msup> <mi>Q</mi> <mn>2</mn> </msup>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <msubsup> <mi>G</mi> <mi>E</mi> <mn>2</mn> </msubsup>
        <mrow>
          <mo>(</mo>
          <msup> <mi>Q</mi> <mn>2</mn> </msup>
          <mo>)</mo>
        </mrow>
        <mo>+</mo>
        <mfrac>
          <msup> <mi>Q</mi> <mn>2</mn> </msup>
          <mrow>
            <mn>4</mn>
            <msubsup> <mi>m</mi> <mi>p</mi> <mn>2</mn> </msubsup>
          </mrow>
        </mfrac>
        <msubsup> <mi>G</mi> <mi>M</mi> <mn>2</mn> </msubsup>
        <mrow>
          <mo>(</mo>
          <msup> <mi>Q</mi> <mn>2</mn> </msup>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mrow>
        <mn>1</mn>
        <mo>+</mo>
        <mfrac>
          <msup> <mi>Q</mi> <mn>2</mn> </msup>
          <mrow>
            <mn>4</mn>
            <msubsup> <mi>m</mi> <mi>p</mi> <mn>2</mn> </msubsup>
          </mrow>
        </mfrac>
      </mrow>
    </mfrac>,
  </math>
  <math>
    <msub> <mi>G</mi> <mi>E</mi> </msub>
    <mrow>
      <mo>(</mo>
      <msup> <mi>Q</mi> <mn>2</mn> </msup>
      <mo>)</mo>
    </mrow>
  </math>
  and
  <math>
    <msub> <mi>G</mi> <mi>M</mi> </msub>
    <mrow>
      <mo>(</mo>
      <msup> <mi>Q</mi> <mn>2</mn> </msup>
      <mo>)</mo>
    </mrow>
  </math>
  are the Sachs electric and magnetic form factors taken in the dipole
  approximation:
  <math display="block">
    <msub> <mi>G</mi> <mi>E</mi> </msub>
    <mrow>
      <mo>(</mo>
      <msup> <mi>Q</mi> <mn>2</mn> </msup>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mn>1</mn>
      <msup>
        <mrow>
          <mo>(</mo>
          <mn>1</mn>
          <mo>+</mo>
          <mfrac>
            <msup> <mi>Q</mi> <mn>2</mn> </msup>
            <msup> <mn>Λ</mn> <mn>2</mn> </msup>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <mn>2</mn>
      </msup>
    </mfrac>
    ,
    <mspace width="2em"/>
    <msub> <mi>G</mi> <mi>M</mi> </msub>
    <mrow>
      <mo>(</mo>
      <msup> <mi>Q</mi> <mn>2</mn> </msup>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <msub> <mi>μ</mi> <mi>p</mi> </msub>
      <msup>
        <mrow>
          <mo>(</mo>
          <mn>1</mn>
          <mo>+</mo>
          <mfrac>
            <msup> <mi>Q</mi> <mn>2</mn> </msup>
            <msup> <mn>Λ</mn> <mn>2</mn> </msup>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <mn>2</mn>
      </msup>
    </mfrac>,
  </math>
  This is the correct spectrum, but its <code>_b</code> counterpart has not
  been derived yet.
</div>

<div id="proton_dipole_spectrum_Dirac" class="def">
  <span class="def"><code>proton_dipole_spectrum_Dirac</code></span>
  <pre>
    <a href="#Spectrum">Spectrum</a> proton_dipole_spectrum_Dirac(<span class="type">double</span> energy, <span class="type">double</span> lambda2 = proton_dipole_form_factor_lambda2);
  </pre>
  Equivalent photon spectrum for a proton of given energy with the form factor
  taken in dipole approximation and only the Dirac current term taken into
  account:
  <math display="block">
    <msub>
     <mi>n</mi>
     <mrow> <mi>p</mi>, <mtext>Dirac</mtext> </mrow>
    </msub>
    <mrow>
      <mo>(</mo>
      <mi>ω</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mi>α</mi>
      <mrow> <mi>π</mi> <mi>ω</mi> </mrow>
    </mfrac>
    <mrow>
      <mo>{</mo>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>+</mo>
        <mn>4</mn>
        <mi>u</mi>
        <mo>-</mo>
        <mn>2</mn>
        <mrow>
          <mo>(</mo>
          <msub> <mi>μ</mi> <mi>p</mi> </msub>
          <mo>-</mo>
          <mn>1</mn>
          <mo>)</mo>
        </mrow>
        <mfrac> <mi>u</mi> <mi>v</mi> </mfrac>
        <mo>)</mo>
      </mrow>
      <mtext>ln</mtext>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>+</mo>
        <mfrac> <mn>1</mn> <mi>u</mi> </mfrac>
        <mo>)</mo>
      </mrow>
      <mo>+</mo>
      <mfrac>
        <mrow>
          <msub> <mi>μ</mi> <mi>p</mi> </msub>
          <mo>-</mo>
          <mn>1</mn>
        </mrow>
        <msup>
          <mrow>
            <mo>(</mo>
            <mi>v</mi>
            <mo>-</mo>
            <mn>1</mn>
            <mo>)</mo>
          </mrow>
          <mn>4</mn>
        </msup>
      </mfrac>
      <mrow>
        <mo>(</mo>
        <mfrac>
          <mrow>
            <msub> <mi>μ</mi> <mi>p</mi> </msub>
            <mo>-</mo>
            <mn>1</mn>
          </mrow>
          <mrow> <mi>v</mi> <mo>-</mo> <mn>1</mn> </mrow>
        </mfrac>
        <mrow>
          <mo>(</mo>
          <mn>1</mn>
          <mo>+</mo>
          <mn>4</mn>
          <mi>u</mi>
          <mo>+</mo>
          <mn>3</mn>
          <mi>v</mi>
          <mo>)</mo>
        </mrow>
        <mo>-</mo>
        <mn>2</mn>
        <mrow>
          <mo>(</mo>
          <mn>1</mn>
          <mo>+</mo>
          <mfrac> <mi>u</mi> <mi>v</mi> </mfrac>
          <mo>)</mo>
        </mrow>
        <mo>)</mo>
      </mrow>
      <mtext>ln</mtext>
      <mfrac>
        <mrow> <mi>u</mi> <mo>+</mo> <mi>v</mi> </mrow>
        <mrow> <mi>u</mi> <mo>+</mo> <mn>1</mn> </mrow>
      </mfrac>
      <mo>-</mo>
      <mrow>
        <mo>(</mo>
        <mn>4</mn>
        <mo>+</mo>
        <mfrac>
          <mn>1</mn>
          <mrow> <mi>u</mi> <mo>+</mo> <mn>1</mn> </mrow>
        </mfrac>
        <mo>+</mo>
        <mfrac>
          <mn>1</mn>
          <mrow>
            <mn>6</mn>
            <msup>
              <mrow>
                <mo>(</mo>
                <mi>u</mi>
                <mo>+</mo>
                <mn>1</mn>
                <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
          </mrow>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <mo>+</mo>
      <mn>2</mn>
      <mrow>
        <mo>(</mo>
        <msub> <mi>μ</mi> <mi>p</mi> </msub>
        <mo>-</mo>
        <mn>1</mn>
        <mo>)</mo>
      </mrow>
      <mrow>
        <mo>[</mo>
        <mrow>
          <mo>(</mo>
          <mfrac> <mi>u</mi> <mi>v</mi> </mfrac>
          <mo>+</mo>
          <mfrac>
            <mrow>
              <mn>1</mn>
              <mo>+</mo>
              <mi>u</mi>
              <mo>/</mo>
              <mi>v</mi>
            </mrow>
            <msup>
              <mrow>
                <mo>(</mo> <mi>v</mi> <mo>-</mo> <mn>1</mn> <mo>)</mo>
              </mrow>
              <mn>3</mn>
            </msup>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <mfrac>
          <mn>1</mn>
          <mrow> <mi>u</mi> <mo>+</mo> <mn>1</mn> </mrow>
        </mfrac>
        <mo>+</mo>
        <mfrac> <mn>1</mn> <mn>2</mn> </mfrac>
        <mrow>
          <mo>(</mo>
          <mfrac> <mi>u</mi> <mi>v</mi> </mfrac>
          <mo>-</mo>
          <mfrac>
            <mrow>
              <mn>1</mn>
              <mo>+</mo>
              <mi>u</mi>
              <mo>/</mo>
              <mi>v</mi>
            </mrow>
            <msup>
              <mrow>
                <mo>(</mo> <mi>v</mi> <mo>-</mo> <mn>1</mn> <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <mfrac>
          <mn>1</mn>
          <msup>
            <mrow>
              <mo>(</mo>
              <mi>u</mi>
              <mo>+</mo>
              <mn>1</mn>
              <mo>)</mo>
            </mrow>
            <mn>2</mn>
          </msup>
        </mfrac>
        <mo>+</mo>
        <mfrac> <mn>1</mn> <mn>3</mn> </mfrac>
        <mrow>
          <mo>(</mo>
          <mfrac> <mi>u</mi> <mi>v</mi> </mfrac>
          <mo>+</mo>
          <mfrac>
            <mrow>
              <mn>1</mn>
              <mo>+</mo>
              <mi>u</mi>
              <mo>/</mo>
              <mi>v</mi>
            </mrow>
            <mrow> <mi>v</mi> <mo>-</mo> <mn>1</mn> </mrow>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <mfrac>
          <mn>1</mn>
          <msup>
            <mrow>
              <mo>(</mo>
              <mi>u</mi>
              <mo>+</mo>
              <mn>1</mn>
              <mo>)</mo>
            </mrow>
            <mn>3</mn>
          </msup>
        </mfrac>
        <mo>]</mo>
      </mrow>
      <mo>-</mo>
      <msup>
        <mrow>
          <mo>(</mo>
          <msub> <mi>μ</mi> <mi>p</mi> </msub>
          <mo>-</mo>
          <mn>1</mn>
          <mo>)</mo>
        </mrow>
        <mn>2</mn>
      </msup>
      <mrow>
        <mo>[</mo>
        <mfrac>
          <mn>1</mn>
          <msup>
            <mrow>
              <mo>(</mo>
              <mi>v</mi>
              <mo>-</mo>
              <mn>1</mn>
              <mo>)</mo>
            </mrow>
            <mn>4</mn>
          </msup>
        </mfrac>
        <mo>+</mo>
        <mfrac>
          <mrow>
            <mn>1</mn>
            <mo>+</mo>
            <mn>3</mn>
            <mi>u</mi>
            <mo>+</mo>
            <mn>2</mn>
            <mi>v</mi>
          </mrow>
          <mrow>
            <mrow>
              <mo>(</mo>
              <mi>u</mi>
              <mo>+</mo>
              <mn>1</mn>
              <mo>)</mo>
            </mrow>
            <msup>
              <mrow>
                <mo>(</mo>
                <mi>v</mi>
                <mo>-</mo>
                <mn>1</mn>
                <mo>)</mo>
              </mrow>
              <mn>4</mn>
            </msup>
          </mrow>
        </mfrac>
        <mo>-</mo>
        <mfrac>
          <mrow>
            <mn>1</mn>
            <mo>+</mo>
            <mn>2</mn>
            <mi>u</mi>
            <mo>+</mo>
            <mi>v</mi>
          </mrow>
          <mrow>
            <mn>2</mn>
            <msup>
              <mrow>
                <mo>(</mo>
                <mi>u</mi>
                <mo>+</mo>
                <mn>1</mn>
                <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
            <msup>
              <mrow>
                <mo>(</mo>
                <mi>v</mi>
                <mo>-</mo>
                <mn>1</mn>
                <mo>)</mo>
              </mrow>
              <mn>3</mn>
            </msup>
          </mrow>
        </mfrac>
        <mo>+</mo>
        <mfrac>
          <mn>1</mn>
          <mrow>
            <mn>2</mn>
            <msup>
              <mrow>
                <mo>(</mo>
                <mi>u</mi>
                <mo>+</mo>
                <mn>1</mn>
                <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
            <msup>
              <mrow>
                <mo>(</mo>
                <mi>v</mi>
                <mo>-</mo>
                <mn>1</mn>
                <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
          </mrow>
        </mfrac>
        <mo>]</mo>
      </mrow>
      <mo>}</mo>
    </mrow>
  </math>
  or, equivalently,
  <math display="block">
    <msub>
     <mi>n</mi>
     <mrow> <mi>p</mi>, <mtext>Dirac</mtext> </mrow>
    </msub>
    <mrow>
      <mo>(</mo>
      <mi>ω</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mi>α</mi>
      <mrow> <mi>π</mi> <mi>ω</mi> </mrow>
    </mfrac>
    <mrow>
      <mo>{</mo>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>+</mo>
        <mn>4</mn>
        <mi>u</mi>
        <mo>-</mo>
        <mn>2</mn>
        <mrow>
          <mo>(</mo>
          <msub> <mi>μ</mi> <mi>p</mi> </msub>
          <mo>-</mo>
          <mn>1</mn>
          <mo>)</mo>
        </mrow>
        <mfrac> <mi>u</mi> <mi>v</mi> </mfrac>
        <mo>)</mo>
      </mrow>
      <mtext>ln</mtext>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>+</mo>
        <mfrac> <mn>1</mn> <mi>u</mi> </mfrac>
        <mo>)</mo>
      </mrow>
      <mo>+</mo>
      <mfrac>
        <mrow>
          <msub> <mi>μ</mi> <mi>p</mi> </msub>
          <mo>-</mo>
          <mn>1</mn>
        </mrow>
        <msup>
          <mrow>
            <mo>(</mo>
            <mi>v</mi>
            <mo>-</mo>
            <mn>1</mn>
            <mo>)</mo>
          </mrow>
          <mn>4</mn>
        </msup>
      </mfrac>
      <mrow>
        <mo>[</mo>
        <mfrac>
          <mrow>
            <msub> <mi>μ</mi> <mi>p</mi> </msub>
            <mo>-</mo>
            <mn>1</mn>
          </mrow>
          <mrow> <mi>v</mi> <mo>-</mo> <mn>1</mn> </mrow>
        </mfrac>
        <mrow>
          <mo>(</mo>
          <mn>1</mn>
          <mo>+</mo>
          <mn>4</mn>
          <mi>u</mi>
          <mo>+</mo>
          <mn>3</mn>
          <mi>v</mi>
          <mo>)</mo>
        </mrow>
        <mo>-</mo>
        <mn>2</mn>
        <mrow>
          <mo>(</mo>
          <mn>1</mn>
          <mo>+</mo>
          <mfrac> <mi>u</mi> <mi>v</mi> </mfrac>
          <mo>)</mo>
        </mrow>
        <mo>]</mo>
      </mrow>
      <mtext>ln</mtext>
      <mfrac>
        <mrow> <mi>u</mi> <mo>+</mo> <mi>v</mi> </mrow>
        <mrow> <mi>u</mi> <mo>+</mo> <mn>1</mn> </mrow>
      </mfrac>
      <mo>-</mo>
      <mfrac>
        <mrow>
          <mn>24</mn>
          <msup> <mi>u</mi> <mn>2</mn> </msup>
          <mo>+</mo>
          <mn>42</mn>
          <mi>u</mi>
          <mo>+</mo>
          <mn>17</mn>
        </mrow>
        <mrow>
          <mn>6</mn>
          <msup>
            <mrow>
              <mo>(</mo>
              <mi>u</mi>
              <mo>+</mo>
              <mn>1</mn>
              <mo>)</mo>
            </mrow>
            <mn>2</mn>
          </msup>
        </mrow>
      </mfrac>
      <mo>+</mo>
      <mrow>
        <mo>(</mo>
        <msub> <mi>μ</mi> <mi>p</mi> </msub>
        <mo>-</mo>
        <mn>1</mn>
        <mo>)</mo>
      </mrow>
      <mfrac>
        <mrow>
          <mn>6</mn>
          <msup> <mi>u</mi> <mn>2</mn> </msup>
          <mrow>
            <mo>(</mo>
            <msup> <mi>v</mi> <mn>2</mn> </msup>
            <mo>-</mo>
            <mn>3</mn>
            <mi>v</mi>
            <mo>+</mo>
            <mn>3</mn>
            <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <mn>3</mn>
          <mi>u</mi>
          <mrow>
            <mo>(</mo>
            <mn>3</mn>
            <msup> <mi>v</mi> <mn>2</mn> </msup>
            <mo>-</mo>
            <mn>9</mn>
            <mi>v</mi>
            <mo>+</mo>
            <mn>10</mn>
            <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <mn>2</mn>
          <msup> <mi>v</mi> <mn>2</mn> </msup>
          <mo>-</mo>
          <mn>7</mn>
          <mi>v</mi>
          <mo>+</mo>
          <mn>11</mn>
        </mrow>
        <mrow>
          <mn>3</mn>
          <msup>
            <mrow>
              <mo>(</mo>
              <mi>u</mi>
              <mo>+</mo>
              <mn>1</mn>
              <mo>)</mo>
            </mrow>
            <mn>2</mn>
          </msup>
          <msup>
            <mrow>
              <mo>(</mo>
              <mi>v</mi>
              <mo>-</mo>
              <mn>1</mn>
              <mo>)</mo>
            </mrow>
            <mn>3</mn>
          </msup>
        </mrow>
      </mfrac>
      <mo>-</mo>
      <msup>
        <mrow>
          <mo>(</mo>
          <msub> <mi>μ</mi> <mi>p</mi> </msub>
          <mo>-</mo>
          <mn>1</mn>
          <mo>)</mo>
        </mrow>
        <mn>2</mn>
      </msup>
      <mfrac>
        <mrow>
          <mn>24</mn>
          <msup> <mi>u</mi> <mn>2</mn> </msup>
          <mo>+</mo>
          <mn>6</mn>
          <mi>u</mi>
          <mrow>
            <mo>(</mo>
            <mi>v</mi>
            <mo>+</mo>
            <mn>7</mn>
            <mo>)</mo>
          </mrow>
          <mo>-</mo>
          <msup> <mi>v</mi> <mn>2</mn> </msup>
          <mo>+</mo>
          <mn>8</mn>
          <mi>v</mi>
          <mo>+</mo>
          <mn>17</mn>
        </mrow>
        <mrow>
          <mn>6</mn>
          <msup>
            <mrow>
              <mo>(</mo>
              <mi>u</mi>
              <mo>+</mo>
              <mn>1</mn>
              <mo>)</mo>
            </mrow>
            <mn>2</mn>
          </msup>
          <msup>
            <mrow>
              <mo>(</mo>
              <mi>v</mi>
              <mo>-</mo>
              <mn>1</mn>
              <mo>)</mo>
            </mrow>
            <mn>4</mn>
          </msup>
        </mrow>
      </mfrac>
      <mo>}</mo>.
    </mrow>
  </math>
  Here
  <math display="block">
    <mi>u</mi>
    <mo>=</mo>
    <msup>
      <mrow>
        <mo>(</mo>
        <mfrac>
          <mi>ω</mi>
          <mrow> <mn>Λ</mn> <mi>γ</mi> </mrow>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <mn>2</mn>
    </msup>
    ,
    <mspace width="2em"/>
    <mi>v</mi>
    <mo>=</mo>
    <msup>
      <mrow>
        <mo>(</mo>
        <mfrac>
          <mrow>
            <mn>2</mn>
            <msub> <mi>m</mi> <mi>p</mi> </msub>
          </mrow>
          <mn>Λ</mn>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <mn>2</mn>
    </msup>,
  </math>
  <math> <msub> <mi>μ</mi> <mi>p</mi> </msub> </math> is the
  <a href="#proton_magnetic_moment">proton magnetic moment</a>,
  <math> <msup> <mn>Λ</mn> <mn>2</mn> </msup> </math> is <code>lambda2</code>.
</div>

<div id="proton_dipole_spectrum_b_Dirac" class="def">
  <span class="def"><code>proton_dipole_spectrum_b_Dirac</code></span>
  <pre>
    <a href="#Spectrum_b">Spectrum_b</a> proton_dipole_spectrum_b_Dirac(
      <span class="type">double</span> energy,
      <span class="type">double</span> lambda2 = proton_dipole_form_factor_lambda2
    )
  </pre>
  Equivalent photon spectrum for a proton of given energy with the form factor
  taken in dipole approximation and only the Dirac current term taken into
  account:
  <math display="block">
    <msub>
      <mi>n</mi>
      <mrow> <mi>p</mi> <mtext>Dirac</mtext> </mrow>
    </msub>
    <mrow>
      <mo>(</mo>
      <mi>b</mi>
      ,
      <mi>ω</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mi>α</mi>
      <mrow>
        <msup> <mi>π</mi> <mn>2</mn> </msup>
        <mi>ω</mi>
      </mrow>
    </mfrac>
    <msup>
      <mrow>
        <mo>[</mo>
        <mfrac> <mi>ω</mi> <mi>γ</mi> </mfrac>
        <msub> <mi>K</mi> <mn>1</mn> </msub>
        <mrow>
          <mo>(</mo>
          <mfrac>
            <mrow> <mi>b</mi> <mi>ω</mi> </mrow>
            <mi>γ</mi>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <mo>-</mo>
        <mrow>
          <mo>(</mo>
          <mn>1</mn>
          <mo>+</mo>
          <mfrac>
            <mrow>
              <mrow>
                <mo>(</mo>
                <msub> <mi>μ</mi> <mi>p</mi> </msub>
                <mo>-</mo>
                <mn>1</mn>
                <mo>)</mo>
              </mrow>
              <mfrac>
                <msup> <mn>Λ</mn> <mn>4</mn> </msup>
                <mrow>
                  <mn>16</mn>
                  <msubsup> <mi>m</mi> <mi>p</mi> <mn>4</mn> </msubsup>
                </mrow>
              </mfrac>
            </mrow>
            <msup>
              <mrow>
                <mo>(</mo>
                <mn>1</mn>
                <mo>-</mo>
                <mfrac>
                  <msup> <mn>Λ</mn> <mn>2</mn> </msup>
                  <mrow>
                    <mn>4</mn>
                    <msubsup> <mi>m</mi> <mi>p</mi> <mn>2</mn> </msubsup>
                  </mrow>
                </mfrac>
                <mo>)</mo>
              </mrow>
              <mn>2</mn>
            </msup>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <msqrt>
          <mrow>
            <msup> <mn>Λ</mn> <mn>2</mn> </msup>
            <mo>+</mo>
            <mfrac>
              <msup> <mi>ω</mi> <mn>2</mn> </msup>
              <msup> <mi>γ</mi> <mn>2</mn> </msup>
            </mfrac>
          </mrow>
        </msqrt>
        <mspace width="3pt"/>
        <msub> <mi>K</mi> <mn>1</mn> </msub>
        <mrow>
          <mo>(</mo>
          <mi>b</mi>
          <msqrt>
            <mrow>
              <msup> <mn>Λ</mn> <mn>2</mn> </msup>
              <mo>+</mo>
              <mfrac>
                <msup> <mi>ω</mi> <mn>2</mn> </msup>
                <msup> <mi>γ</mi> <mn>2</mn> </msup>
              </mfrac>
            </mrow>
          </msqrt>
          <mo>)</mo>
        </mrow>
        <mo>+</mo>
        <mfrac>
          <mrow>
            <mrow>
              <mo>(</mo>
              <msub> <mi>μ</mi> <mi>p</mi> </msub>
              <mo>-</mo>
              <mn>1</mn>
              <mo>)</mo>
            </mrow>
            <mfrac>
              <msup> <mn>Λ</mn> <mn>4</mn> </msup>
              <mrow>
                <mn>16</mn>
                <msubsup> <mi>m</mi> <mi>p</mi> <mn>4</mn> </msubsup>
              </mrow>
            </mfrac>
          </mrow>
          <msup>
            <mrow>
              <mo>(</mo>
              <mn>1</mn>
              <mo>-</mo>
              <mfrac>
                <msup> <mn>Λ</mn> <mn>2</mn> </msup>
                <mrow>
                 <mn>4</mn>
                 <msubsup> <mi>m</mi> <mi>p</mi> <mn>4</mn> </msubsup>
                </mrow>
              </mfrac>
              <mo>)</mo>
            </mrow>
            <mn>2</mn>
          </msup>
        </mfrac>
        <msqrt>
          <mrow>
            <mn>4</mn>
            <msubsup> <mi>m</mi> <mi>p</mi> <mn>2</mn> </msubsup>
            <mo>+</mo>
            <mfrac>
              <msup> <mi>ω</mi> <mn>2</mn> </msup>
              <msup> <mi>γ</mi> <mn>2</mn> </msup>
            </mfrac>
          </mrow>
        </msqrt>
        <mspace width="3pt"/>
        <msub> <mi>K</mi> <mn>1</mn> </msub>
        <mrow>
          <mo>(</mo>
          <mi>b</mi>
          <msqrt>
            <mrow>
              <mn>4</mn>
              <msubsup> <mi>m</mi> <mi>p</mi> <mn>2</mn> </msubsup>
              <mo>+</mo>
              <mfrac>
                <msup> <mi>ω</mi> <mn>2</mn> </msup>
                <msup> <mi>γ</mi> <mn>2</mn> </msup>
              </mfrac>
            </mrow>
          </msqrt>
          <mo>)</mo>
        </mrow>
        <mo>-</mo>
        <mfrac>
          <mrow>
            <mn>1</mn>
            <mo>-</mo>
            <mfrac>
              <mrow>
                <msub> <mi>μ</mi> <mi>p</mi> </msub>
                <msup> <mn>Λ</mn> <mn>2</mn> </msup>
              </mrow>
              <mrow>
                <mn>4</mn>
                <msubsup> <mi>m</mi> <mi>p</mi> <mn>2</mn> </msubsup>
              </mrow>
            </mfrac>
          </mrow>
          <mrow>
            <mn>1</mn>
            <mo>-</mo>
            <mfrac>
              <msup> <mn>Λ</mn> <mn>2</mn> </msup>
              <mrow>
                <mn>4</mn>
                <msubsup> <mi>m</mi> <mi>p</mi> <mn>2</mn> </msubsup>
              </mrow>
            </mfrac>
          </mrow>
        </mfrac>
        <mo>&middot;</mo>
        <mfrac>
          <mrow>
            <mi>b</mi>
            <msup> <mn>Λ</mn> <mn>2</mn> </msup>
          </mrow>
          <mn>2</mn>
        </mfrac>
        <msub> <mi>K</mi> <mn>0</mn> </msub>
        <mrow>
          <mo>(</mo>
          <mi>b</mi>
          <msqrt>
            <mrow>
              <msup> <mn>Λ</mn> <mn>2</mn> </msup>
              <mo>+</mo>
              <mfrac>
                <msup> <mi>ω</mi> <mn>2</mn> </msup>
                <msup> <mi>γ</mi> <mn>2</mn> </msup>
              </mfrac>
            </mrow>
          </msqrt>
          <mo>)</mo>
        </mrow>
        <mo>]</mo>
      </mrow>
      <mn>2</mn>
    </msup>.
  </math>
  Here 
  <math> <msub> <mi>μ</mi> <mi>p</mi> </msub> </math> is the
  <a href="#proton_magnetic_moment">proton magnetic moment</a>,
  <math> <msup> <mn>Λ</mn> <mn>2</mn> </msup> </math> is <code>lambda2</code>.
</div>

<h5 id="proton-luminosity">Luminosity</h5>

<div id="pp_elastic_slope" class="def">
  <span class="def"><code>pp_elastic_slope</code></span>
  <pre>
    <span class="type">double</span> pp_elastic_slope(<span class="type">double</span> collision_energy);
  </pre>
  The slope of the cross section for elastic scattering of two protons. This is the parameter <math><mi>B</mi></math> used in arXiv:<a href="https://arxiv.org/abs/1112.3243">1112.3243</a>: 
  <math display="block">
    <mi>B</mi>
    <mo>=</mo>
    <msub> <mi>B</mi> <mn>0</mn> </msub>
    <mo>+</mo>
    <mn>2</mn>
    <msub> <mi>B</mi> <mn>1</mn> </msub>
    <mtext>ln</mtext>
    <mrow>
      <mo>(</mo>
      <mi>E</mi>
      <mo>/</mo>
      <msub> <mi>E</mi> <mn>0</mn> </msub>
      <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <mn>4</mn>
    <msub> <mi>B</mi> <mn>2</mn> </msub>
    <msup> <mtext>ln</mtext> <mn>2</mn> </msup>
    <mrow>
      <mo>(</mo>
      <mi>E</mi>
      <mo>/</mo>
      <msub> <mi>E</mi> <mn>0</mn> </msub>
      <mo>)</mo>
    </mrow>,
  </math>
  where
  <math>
    <msub> <mi>B</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <mn>12</mn>
    <mspace width="1ex"/>
    <msup> <mtext>GeV</mtext> <mrow> <mo>-</mo> <mn>2</mn> </mrow> </msup>,
  </math>
  <math>
    <msub> <mi>B</mi> <mn>1</mn> </msub>
    <mo>=</mo>
    <mo>-</mo>
    <mn>0.22</mn>
    <mo>±</mo>
    <mn>0.17</mn>
    <mspace width="1ex"/>
    <msup> <mtext>GeV</mtext> <mrow> <mo>-</mo> <mn>2</mn> </mrow> </msup>,
  </math>
  <math>
    <msub> <mi>B</mi> <mn>2</mn> </msub>
    <mo>=</mo>
    <mn>0.037</mn>
    <mo>±</mo>
    <mn>0.006</mn>
    <mspace width="1ex"/>
    <msup> <mtext>GeV</mtext> <mrow> <mo>-</mo> <mn>2</mn> </mrow> </msup>,
  </math>
  <math><mi>E</mi></math> is <code>collision_energy</code>,
  <math>
    <msub> <mi>E</mi> <mn>0</mn> </msub>
    <mo>=</mo>
    <mn>1</mn> 
    <mspace width="1ex"/>
    <mtext>GeV</mtext>.
  </math>
</div>

<div id="pp_upc_probability" class="def">
  <span class="def"><code>pp_upc_probability</code></span>
  <pre>
    std::function&lt;<span class="type">double</span> (<span class="type">double</span> <span class="comment">/* b */</span>)&gt; pp_upc_probability(<span class="type">double</span> collision_energy);
  </pre>
  The probability to avoid non-electromagnetic interactions in an
  ultraperipheral collision of two protons with the impact parameter
  <code>b</code>:
  <math display="block">
    <mi>P</mi>
    <mrow>
      <mo>(</mo>
      <mi>b</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>-</mo>
        <msup>
          <mn>e</mn>
          <mrow>
            <mo>-</mo>
            <mfrac>
              <msup> <mi>b</mi> <mn>2</mn> </msup>
              <mrow> <mn>2</mn> <mi>B</mi> </mrow>
            </mfrac>
          </mrow>
        </msup>
        <mo>)</mo>
      </mrow>
      <mn>2</mn>
    </msup>.
  </math>
  Uses <code><a href="#pp_elastic_slope">pp_elastic_slope</a></code> to obtain
  the parameter <math><mi>B</mi></math>.
</div>

<div id="pp_luminosity" class="def">
  <span class="def"><code>pp_luminosity</code></span>
  <pre>
    <a href="#Luminosity">Luminosity</a> pp_luminosity(<span class="type">double</span> collision_energy, <a href="#Integrator">Integrator</a> = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>));
  </pre>
  Photon-photon luminosity in ultraperipheral proton-proton collisions with
  non-electromagnetic interactions neglected. This function calls
  <code><a href="#proton_dipole_spectrum">proton_dipole_spectrum</a></code> and
  passes the result to <code><a href="#luminosity">luminosity</a></code>.
</div>

<div id="pp_luminosity_y" class="def">
  <span class="def"><code>pp_luminosity_y</code></span>
  <pre>
    <a href="#Luminosity_y">Luminosity_y</a> pp_luminosity_y(<span class="type">double</span> collision_energy);
  </pre>
  Photon-photon luminosity in ultraperipheral proton-proton collisions
  differentiated with respect to both invariant mass of the photons
  <math> <msqrt> <mi>s</mi> </msqrt> </math> and rapidity of the system
  <math> <mi>y</mi> </math>. This function calls
  <code><a href="#proton_dipole_spectrum">proton_dipole_spectrum</a></code> and
  passes the result to <code><a href="#luminosity_y">luminosity_y</a></code>.
</div>

<div id="pp_luminosity_fid" class="def">
  <span class="def"><code>pp_luminosity_fid</code></span>
  <pre>
    <a href="#Luminosity_fid">Luminosity_fid</a> pp_luminosity_fid(<span class="type">double</span> collision_energy, <a href="#Integrator">Integrator</a> = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>));
  </pre>
  Photon-photon luminosity in ultraperipheral proton-proton collisions with
  parameterized bounds for the rapidity integral. This function calls
  <code><a href="#proton_dipole_spectrum">proton_dipole_spectrum</a></code> and
  passes the result to <code><a href="#luminosity_fid">luminosity_fid</a></code>.
</div>

<div id="ppx_luminosity_b" class="def">
  <span class="def"><code>ppx_luminosity_b</code></span>
  <pre>
    <a href="#Luminosity_b">Luminosity_b</a> ppx_luminosity_b(
      <a href="#Spectrum">Spectrum</a>   spectrum, <span class="comment">// optional --- when provided might speed up calculations</span>
      <a href="#Spectrum_b">Spectrum_b</a> spectrum_b,
      <span class="type">double</span> B, <span class="comment">// = <a href="#pp_elastic_slope">pp_elastic_slope</a>(collision_energy)</span>
      <span class="type">const</span> std::function&lt;<a href="#Integrator">Integrator</a> (<span class="type">unsigned</span>)&gt;&amp; integrator_generator = <a href="#default_integrator">default_integrator</a>,
      <span class="type">unsigned</span> integration_level = <span class="literal">0</span>
    )
  </pre>
  Photon-photon luminosity in ultraperipheral collisions of two identical
  particles with the same probability to avoid strong interactions as protons
  but with arbitrary spectrum. Use this function if you want to try non-default
  proton spectrum.
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mrow> <mi>A</mi> <mi>B</mi> </mrow> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>,</mo>
      <mrow>
        <mo>{</mo>
        <msub> <mi>p</mi> <mo>&parallel;</mo> </msub>
        <mo>,</mo>
        <msub> <mi>p</mi> <mo>&perp;</mo> </msub>
        <mo>}</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub> <mi>p</mi> <mo>&parallel;</mo> </msub>
    <mfrac>
      <mrow>
        <mtext>d</mtext> <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <msub> <mi>p</mi> <mo>&perp;</mo> </msub>
    <mfrac>
      <mrow> <mtext>d</mtext> <msub> <mi>L</mi> <mo>&perp;</mo> </msub> </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>)</mo>
    </mrow>,
  </math>
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup> <mi>π</mi> <mn>2</mn> </msup>
    <msqrt> <mi>s</mi> </msqrt>
    <mrow>
      <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
      <msub> <mi>b</mi> <mn>1</mn> </msub>
      <mtext>d</mtext> <msub> <mi>b</mi> <mn>1</mn> </msub>
      <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
      <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mtext>d</mtext> <msub> <mi>b</mi> <mn>2</mn> </msub>
      <msubsup>
        <mo>&int;</mo>
        <mrow> <mo>-</mo> <mn>∞</mn> </mrow>
        <mn>∞</mn>
      </msubsup>
      <mtext>d</mtext> <mi>y</mi>
      <mspace width="3pt"/>
      <mi>n</mi>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>1</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mi>y</mi> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <mi>n</mi>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>2</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
        <mo>)</mo>
      </mrow>
      <mrow>
        <mo>{</mo>
        <mn>1</mn>
        <mo>-</mo>
        <mn>2</mn>
        <msup>
          <mn>e</mn>
          <mrow>
            <mo>-</mo>
            <mfrac>
              <mrow>
                <msubsup> <mi>b</mi> <mn>1</mn> <mn>2</mn> </msubsup>
                <mo>+</mo>
                <msubsup> <mi>b</mi> <mn>2</mn> <mn>2</mn> </msubsup>
              </mrow>
              <mrow> <mn>2</mn> <mi>B</mi> </mrow>
            </mfrac>
          </mrow>
        </msup>
        <mrow>
          <mo>[</mo>
          <msub> <mi>I</mi> <mn>0</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <msub> <mi>I</mi> <mn>2</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>+</mo>
        <msup>
          <mn>e</mn>
          <mrow>
            <mo>-</mo>
            <mfrac>
              <mrow>
                <msubsup> <mi>b</mi> <mn>1</mn> <mn>2</mn> </msubsup>
                <mo>+</mo>
                <msubsup> <mi>b</mi> <mn>2</mn> <mn>2</mn> </msubsup>
              </mrow>
              <mi>B</mi>
            </mfrac>
          </mrow>
        </msup>
        <mrow>
          <mo>[</mo>
          <msub> <mi>I</mi> <mn>0</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <msub> <mi>I</mi> <mn>2</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>}</mo>
      </mrow>
    </mrow>,
  </math>
  <math display="block">
    <mfrac>
      <mrow> <mtext>d</mtext> <msub> <mi>L</mi> <mo>&perp;</mo> </msub> </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup> <mi>π</mi> <mn>2</mn> </msup>
    <msqrt> <mi>s</mi> </msqrt>
    <mrow>
      <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
      <msub> <mi>b</mi> <mn>1</mn> </msub>
      <mtext>d</mtext> <msub> <mi>b</mi> <mn>1</mn> </msub>
      <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
      <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mtext>d</mtext> <msub> <mi>b</mi> <mn>2</mn> </msub>
      <msubsup>
        <mo>&int;</mo>
        <mrow> <mo>-</mo> <mn>∞</mn> </mrow>
        <mn>∞</mn>
      </msubsup>
      <mtext>d</mtext> <mi>y</mi>
      <mspace width="3pt"/>
      <mi>n</mi>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>1</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mi>y</mi> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <mi>n</mi>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>2</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
        <mo>)</mo>
      </mrow>
      <mrow>
        <mo>{</mo>
        <mn>1</mn>
        <mo>-</mo>
        <mn>2</mn>
        <msup>
          <mn>e</mn>
          <mrow>
            <mo>-</mo>
            <mfrac>
              <mrow>
                <msubsup> <mi>b</mi> <mn>1</mn> <mn>2</mn> </msubsup>
                <mo>+</mo>
                <msubsup> <mi>b</mi> <mn>2</mn> <mn>2</mn> </msubsup>
              </mrow>
              <mrow> <mn>2</mn> <mi>B</mi> </mrow>
            </mfrac>
          </mrow>
        </msup>
        <mrow>
          <mo>[</mo>
          <msub> <mi>I</mi> <mn>0</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>-</mo>
          <msub> <mi>I</mi> <mn>2</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>+</mo>
        <msup>
          <mn>e</mn>
          <mrow>
            <mo>-</mo>
            <mfrac>
              <mrow>
                <msubsup> <mi>b</mi> <mn>1</mn> <mn>2</mn> </msubsup>
                <mo>+</mo>
                <msubsup> <mi>b</mi> <mn>2</mn> <mn>2</mn> </msubsup>
              </mrow>
              <mi>B</mi>
            </mfrac>
          </mrow>
        </msup>
        <mrow>
          <mo>[</mo>
          <msub> <mi>I</mi> <mn>0</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>-</mo>
          <msub> <mi>I</mi> <mn>2</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>}</mo>
      </mrow>
    </mrow>.
  </math>
  The <code>spectrum</code> argument is optional. If provided, it it is used to
  calculate the 1 in the braces. This should improve the convergence of the
  integral and might also result in better accuracy.
  <code>B</code> is the elastic slope of the cross section, see
  <code><a href="#pp_elastic_slope">pp_elastic_slope</a></code>.
</div>

<div id="ppx_luminosity_y_b" class="def">
  <span class="def"><code>ppx_luminosity_y_b</code></span>
  <pre>
    <a href="#Luminosity_y_b">Luminosity_y_b</a> ppx_luminosity_y_b(
      <a href="#Spectrum_b">Spectrum_b</a> spectrum_b,
      <span class="type">double</span> B, <span class="comment">// = <a href="#pp_elastic_slope">pp_elastic_slope</a>(collision_energy)</span>
      <span class="type">const</span> std::function&lt;<a href="#Integrator">Integrator</a> (<span class="type">unsigned</span>)&gt;&amp; integrator_generator = <a href="#default_integrator">default_integrator</a>,
      <span class="type">unsigned</span> integration_level = <span class="literal">0</span>
    )
  </pre>
  Photon-photon luminosity differentiated with respect to the rapidity of the
  system <math><mi>y</mi></math> in ultraperipheral collisions of two identical
  particles with the same probability to avoid strong interactions as protons
  but with arbitrary spectrum. Use this function if you want to try non-default
  proton spectrum.
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mrow> <mi>A</mi> <mi>B</mi> </mrow> </msub>
      </mrow>
      <mrow>
        <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
        <mspace width="3pt"/>
        <mtext>d</mtext> <mi>y</mi>
      </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>,</mo>
      <mi>y</mi>
      <mo>,</mo>
      <mrow>
        <mo>{</mo>
        <msub> <mi>p</mi> <mo>&parallel;</mo> </msub>
        <mo>,</mo>
        <msub> <mi>p</mi> <mo>&perp;</mo> </msub>
        <mo>}</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub> <mi>p</mi> <mo>&parallel;</mo> </msub>
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
      </mrow>
      <mrow>
        <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
        <mspace width="3pt"/>
        <mtext>d</mtext> <mi>y</mi>
      </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>,</mo>
      <mi>y</mi>
      <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <msub> <mi>p</mi> <mo>&perp;</mo> </msub>
    <mfrac>
      <mrow> <mtext>d</mtext> <msub> <mi>L</mi> <mo>&perp;</mo> </msub> </mrow>
      <mrow>
        <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
        <mspace width="3pt"/>
        <mtext>d</mtext> <mi>y</mi>
      </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>,</mo>
      <mi>y</mi>
      <mo>)</mo>
    </mrow>,
  </math>
  where
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
      </mrow>
      <mrow>
        <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
        <mspace width="3pt"/>
        <mtext>d</mtext> <mi>y</mi>
      </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>,</mo>
      <mi>y</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup> <mi>π</mi> <mn>2</mn> </msup>
    <msqrt> <mi>s</mi> </msqrt>
    <mrow>
      <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
      <msub> <mi>b</mi> <mn>1</mn> </msub>
      <mtext>d</mtext> <msub> <mi>b</mi> <mn>1</mn> </msub>
      <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
      <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mtext>d</mtext> <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mspace width="3pt"/>
      <mi>n</mi>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>1</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mi>y</mi> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <mi>n</mi>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>2</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
        <mo>)</mo>
      </mrow>
      <mrow>
        <mo>{</mo>
        <mn>1</mn>
        <mo>-</mo>
        <mn>2</mn>
        <msup>
          <mn>e</mn>
          <mrow>
            <mo>-</mo>
            <mfrac>
              <mrow>
                <msubsup> <mi>b</mi> <mn>1</mn> <mn>2</mn> </msubsup>
                <mo>+</mo>
                <msubsup> <mi>b</mi> <mn>2</mn> <mn>2</mn> </msubsup>
              </mrow>
              <mrow> <mn>2</mn> <mi>B</mi> </mrow>
            </mfrac>
          </mrow>
        </msup>
        <mrow>
          <mo>[</mo>
          <msub> <mi>I</mi> <mn>0</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <msub> <mi>I</mi> <mn>2</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>+</mo>
        <msup>
          <mn>e</mn>
          <mrow>
            <mo>-</mo>
            <mfrac>
              <mrow>
                <msubsup> <mi>b</mi> <mn>1</mn> <mn>2</mn> </msubsup>
                <mo>+</mo>
                <msubsup> <mi>b</mi> <mn>2</mn> <mn>2</mn> </msubsup>
              </mrow>
              <mi>B</mi>
            </mfrac>
          </mrow>
        </msup>
        <mrow>
          <mo>[</mo>
          <msub> <mi>I</mi> <mn>0</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <msub> <mi>I</mi> <mn>2</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>}</mo>
      </mrow>
    </mrow>,
  </math>
  <math display="block">
    <mfrac>
      <mrow> <mtext>d</mtext> <msub> <mi>L</mi> <mo>&perp;</mo> </msub> </mrow>
      <mrow>
        <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt>
        <mspace width="3pt"/>
        <mtext>d</mtext> <mi>y</mi>
      </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>,</mo>
      <mi>y</mi>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup> <mi>π</mi> <mn>2</mn> </msup>
    <msqrt> <mi>s</mi> </msqrt>
    <mrow>
      <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
      <msub> <mi>b</mi> <mn>1</mn> </msub>
      <mtext>d</mtext> <msub> <mi>b</mi> <mn>1</mn> </msub>
      <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
      <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mtext>d</mtext> <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mspace width="3pt"/>
      <mi>n</mi>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>1</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mi>y</mi> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <mi>n</mi>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>2</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
        <mo>)</mo>
      </mrow>
      <mrow>
        <mo>{</mo>
        <mn>1</mn>
        <mo>-</mo>
        <mn>2</mn>
        <msup>
          <mn>e</mn>
          <mrow>
            <mo>-</mo>
            <mfrac>
              <mrow>
                <msubsup> <mi>b</mi> <mn>1</mn> <mn>2</mn> </msubsup>
                <mo>+</mo>
                <msubsup> <mi>b</mi> <mn>2</mn> <mn>2</mn> </msubsup>
              </mrow>
              <mrow> <mn>2</mn> <mi>B</mi> </mrow>
            </mfrac>
          </mrow>
        </msup>
        <mrow>
          <mo>[</mo>
          <msub> <mi>I</mi> <mn>0</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>-</mo>
          <msub> <mi>I</mi> <mn>2</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>+</mo>
        <msup>
          <mn>e</mn>
          <mrow>
            <mo>-</mo>
            <mfrac>
              <mrow>
                <msubsup> <mi>b</mi> <mn>1</mn> <mn>2</mn> </msubsup>
                <mo>+</mo>
                <msubsup> <mi>b</mi> <mn>2</mn> <mn>2</mn> </msubsup>
              </mrow>
              <mi>B</mi>
            </mfrac>
          </mrow>
        </msup>
        <mrow>
          <mo>[</mo>
          <msub> <mi>I</mi> <mn>0</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>-</mo>
          <msub> <mi>I</mi> <mn>2</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>}</mo>
      </mrow>
    </mrow>.
  </math>
  Here <code>B</code> is the elastic slope of the cross section. See
  <code><a href="#pp_elastic_slope">pp_elastic_slope</a></code>.
</div>
 
<div id="ppx_luminosity_fid_b" class="def">
  <span class="def"><code>ppx_luminosity_fid_b</code></span>
  <pre>
    <a href="#Luminosity_fid_b">Luminosity_y_b</a> ppx_luminosity_fid_b(
      <a href="#Spectrum">Spectrum</a>   spectrum, <span class="comment">// optional --- when provided might speed up calculations</span>
      <a href="#Spectrum_b">Spectrum_b</a> spectrum_b,
      <span class="type">double</span> B, <span class="comment">// = <a href="#pp_elastic_slope">pp_elastic_slope</a>(collision_energy)</span>
      <span class="type">const</span> std::function&lt;<a href="#Integrator">Integrator</a> (<span class="type">unsigned</span>)&gt;&amp; integrator_generator = <a href="#default_integrator">default_integrator</a>,
      <span class="type">unsigned</span> integration_level = <span class="literal">0</span>
    )
  </pre>
  Photon-photon luminosity with parameterized bounds for the rapidity integral
  in ultraperipheral collisions of two identical particles with the same
  probability to avoid strong interactions as protons but with arbitrary
  spectrum. Use this function if you want to try non-default proton spectrum.
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mrow> <mi>A</mi> <mi>B</mi> </mrow> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>,</mo>
      <mrow>
        <mo>{</mo>
        <msub> <mi>p</mi> <mo>&parallel;</mo> </msub>
        <mo>,</mo>
        <msub> <mi>p</mi> <mo>&perp;</mo> </msub>
        <mo>}</mo>
      </mrow>
      <mo>,</mo>
      <msub> <mi>y</mi> <mtext>min</mtext> </msub>
      <mo>,</mo>
      <msub> <mi>y</mi> <mtext>max</mtext> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msub> <mi>p</mi> <mo>&parallel;</mo> </msub>
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>)</mo>
    </mrow>
    <mo>+</mo>
    <msub> <mi>p</mi> <mo>&perp;</mo> </msub>
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mo>&perp;</mo> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>,</mo>
      <msub> <mi>y</mi> <mtext>min</mtext> </msub>
      <mo>,</mo>
      <msub> <mi>y</mi> <mtext>max</mtext> </msub>
      <mo>)</mo>
    </mrow>,
  </math>
  <math display="block">
    <mfrac>
      <mrow>
        <mtext>d</mtext>
        <msub> <mi>L</mi> <mo>&parallel;</mo> </msub>
      </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>,</mo>
      <msub> <mi>y</mi> <mtext>min</mtext> </msub>
      <mo>,</mo>
      <msub> <mi>y</mi> <mtext>max</mtext> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup> <mi>π</mi> <mn>2</mn> </msup>
    <msqrt> <mi>s</mi> </msqrt>
    <mrow>
      <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
      <msub> <mi>b</mi> <mn>1</mn> </msub>
      <mtext>d</mtext> <msub> <mi>b</mi> <mn>1</mn> </msub>
      <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
      <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mtext>d</mtext> <msub> <mi>b</mi> <mn>2</mn> </msub>
      <msubsup>
        <mo>&int;</mo>
        <mrow> <mo>-</mo> <msub> <mi>y</mi> <mtext>min</mtext> </msub> </mrow> 
        <msub> <mi>y</mi> <mtext>max</mtext> </msub>
      </msubsup>
      <mtext>d</mtext> <mi>y</mi>
      <mspace width="3pt"/>
      <mi>n</mi>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>1</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mi>y</mi> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <mi>n</mi>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>2</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
        <mo>)</mo>
      </mrow>
      <mrow>
        <mo>{</mo>
        <mn>1</mn>
        <mo>-</mo>
        <mn>2</mn>
        <msup>
          <mn>e</mn>
          <mrow>
            <mo>-</mo>
            <mfrac>
              <mrow>
                <msubsup> <mi>b</mi> <mn>1</mn> <mn>2</mn> </msubsup>
                <mo>+</mo>
                <msubsup> <mi>b</mi> <mn>2</mn> <mn>2</mn> </msubsup>
              </mrow>
              <mrow> <mn>2</mn> <mi>B</mi> </mrow>
            </mfrac>
          </mrow>
        </msup>
        <mrow>
          <mo>[</mo>
          <msub> <mi>I</mi> <mn>0</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <msub> <mi>I</mi> <mn>2</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>+</mo>
        <msup>
          <mn>e</mn>
          <mrow>
            <mo>-</mo>
            <mfrac>
              <mrow>
                <msubsup> <mi>b</mi> <mn>1</mn> <mn>2</mn> </msubsup>
                <mo>+</mo>
                <msubsup> <mi>b</mi> <mn>2</mn> <mn>2</mn> </msubsup>
              </mrow>
              <mi>B</mi>
            </mfrac>
          </mrow>
        </msup>
        <mrow>
          <mo>[</mo>
          <msub> <mi>I</mi> <mn>0</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <msub> <mi>I</mi> <mn>2</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>}</mo>
      </mrow>
    </mrow>,
  </math>
  <math display="block">
    <mfrac>
      <mrow> <mtext>d</mtext> <msub> <mi>L</mi> <mo>&perp;</mo> </msub> </mrow>
      <mrow> <mtext>d</mtext> <msqrt> <mi>s</mi> </msqrt> </mrow>
    </mfrac>
    <mrow>
      <mo>(</mo>
      <msqrt> <mi>s</mi> </msqrt>
      <mo>,</mo>
      <msub> <mi>y</mi> <mtext>min</mtext> </msub>
      <mo>,</mo>
      <msub> <mi>y</mi> <mtext>max</mtext> </msub>
      <mo>)</mo>
    </mrow>
    <mo>=</mo>
    <msup> <mi>π</mi> <mn>2</mn> </msup>
    <msqrt> <mi>s</mi> </msqrt>
    <mrow>
      <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
      <msub> <mi>b</mi> <mn>1</mn> </msub>
      <mtext>d</mtext> <msub> <mi>b</mi> <mn>1</mn> </msub>
      <msubsup> <mo>&int;</mo> <mn>0</mn> <mn>∞</mn> </msubsup>
      <msub> <mi>b</mi> <mn>2</mn> </msub>
      <mtext>d</mtext> <msub> <mi>b</mi> <mn>2</mn> </msub>
      <msubsup>
        <mo>&int;</mo>
        <mrow> <mo>-</mo> <msub> <mi>y</mi> <mtext>min</mtext> </msub> </mrow>
        <msub> <mi>y</mi> <mtext>max</mtext> </msub>
      </msubsup>
      <mtext>d</mtext> <mi>y</mi>
      <mspace width="3pt"/>
      <mi>n</mi>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>1</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mi>y</mi> </msup>
        <mo>)</mo>
      </mrow>
      <mspace width="3pt"/>
      <mi>n</mi>
      <mrow>
        <mo>(</mo>
        <msub> <mi>b</mi> <mn>2</mn> </msub>
        <mo>,</mo>
        <mfrac> <msqrt> <mi>s</mi> </msqrt> <mn>2</mn> </mfrac>
        <msup> <mn>e</mn> <mrow> <mo>-</mo> <mi>y</mi> </mrow> </msup>
        <mo>)</mo>
      </mrow>
      <mrow>
        <mo>{</mo>
        <mn>1</mn>
        <mo>-</mo>
        <mn>2</mn>
        <msup>
          <mn>e</mn>
          <mrow>
            <mo>-</mo>
            <mfrac>
              <mrow>
                <msubsup> <mi>b</mi> <mn>1</mn> <mn>2</mn> </msubsup>
                <mo>+</mo>
                <msubsup> <mi>b</mi> <mn>2</mn> <mn>2</mn> </msubsup>
              </mrow>
              <mrow> <mn>2</mn> <mi>B</mi> </mrow>
            </mfrac>
          </mrow>
        </msup>
        <mrow>
          <mo>[</mo>
          <msub> <mi>I</mi> <mn>0</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>-</mo>
          <msub> <mi>I</mi> <mn>2</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>+</mo>
        <msup>
          <mn>e</mn>
          <mrow>
            <mo>-</mo>
            <mfrac>
              <mrow>
                <msubsup> <mi>b</mi> <mn>1</mn> <mn>2</mn> </msubsup>
                <mo>+</mo>
                <msubsup> <mi>b</mi> <mn>2</mn> <mn>2</mn> </msubsup>
              </mrow>
              <mi>B</mi>
            </mfrac>
          </mrow>
        </msup>
        <mrow>
          <mo>[</mo>
          <msub> <mi>I</mi> <mn>0</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>-</mo>
          <msub> <mi>I</mi> <mn>2</mn> </msub>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <msub> <mi>b</mi> <mn>1</mn> </msub>
                <msub> <mi>b</mi> <mn>2</mn> </msub>
              </mrow>
              <mi>B</mi>
            </mfrac>
            <mo>)</mo>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>}</mo>
      </mrow>
    </mrow>.
  </math>
  Here <code>B</code> is the elastic slope of the cross section. See
  <code><a href="#pp_elastic_slope">pp_elastic_slope</a></code>.
</div>

<div id="pp_luminosity_b" class="def">
  <span class="def"><code>pp_luminosity_b</code></span>
  <pre>
  <a href="#Luminosity_b">Luminosity_b</a> pp_luminosity_b(
    <span class="type">double</span> collision_energy,
    <span class="type">const</span> std::function&lt;<a href="#Integrator">Integrator</a> (<span class="type">unsigned</span>)&gt;&amp; integrator_generator = default_integrator,
    <span class="type">unsigned</span> integration_level = <span class="literal">0</span>
  )
  </pre>
  Photon-photon luminosity in ultraperipheral collisions of two protons. This
  function calls <code><a href="#ppx_luminosity_b">ppx_luminosity_b</a></code>
  passing it the results of 
  <code><a href="#proton_dipole_spectrum_Dirac">proton_dipole_spectrum_Dirac</a></code>
  and
  <code><a href="#proton_dipole_spectrum_b_Dirac">proton_dipole_spectrum_b_Dirac</a></code>.
</div>

<div id="pp_luminosity_y_b" class="def">
  <span class="def"><code>pp_luminosity_y_b</code></span>
  <pre>
  <a href="#Luminosity_y_b">Luminosity_y_b</a> pp_luminosity_y_b(
    <span class="type">double</span> collision_energy,
    <span class="type">const</span> std::function&lt;<a href="#Integrator">Integrator</a> (<span class="type">unsigned</span>)&gt;&amp; integrator_generator = default_integrator,
    <span class="type">unsigned</span> integration_level = <span class="literal">0</span>
  )
  </pre>
  Photon-photon luminosity differentiated with respect to the system rapidity
  <math><mi>y</mi></math> in ultraperipheral collisions of two protons. This
  function calls <code><a href="#ppx_luminosity_b">ppx_luminosity_y_b</a></code>
  passing it the results of 
  <code><a href="#proton_dipole_spectrum_Dirac">proton_dipole_spectrum_Dirac</a></code>
  and
  <code><a href="#proton_dipole_spectrum_b_Dirac">proton_dipole_spectrum_b_Dirac</a></code>.
</div>

<div id="pp_luminosity_fid_b" class="def">
  <span class="def"><code>pp_luminosity_fid_b</code></span>
  <pre>
    <a href="#Luminosity_fid_b">Luminosity_fid_b</a> pp_luminosity_fid_b(
      <span class="type">double</span> collision_energy,
      <span class="type">const</span> std::function&lt;<a href="#Integrator">Integrator</a> (<span class="type">unsigned</span>)&gt;&amp; integrator_generator = default_integrator,
      <span class="type">unsigned</span> integration_level = <span class="literal">0</span>
    )
  </pre>
  Photon-photon luminosity with parameterized bounds of the rapidity integral
  in ultraperipheral collisions of two protons. This function calls
  <code><a href="#ppx_luminosity_fid_b">ppx_luminosity_fid_b</a></code>
  passing it the results of 
  <code><a href="#proton_dipole_spectrum_Dirac">proton_dipole_spectrum_Dirac</a></code>
  and
  <code><a href="#proton_dipole_spectrum_b_Dirac">proton_dipole_spectrum_b_Dirac</a></code>.
</div>

<h5 id="proton-xsection">Cross sections</h5>

In the following, <code>l</code> denotes the produced fermion and it stands for
"lepton": it is assumed that the produced particles do not rescatter on the
protons and, in particular, do not participate in strong interactions, hence
the name.

<div id="pp_to_ppll" class="def">
  <span class="def"><code>pp_to_ppll</code></span>
  <div class="def">
    <pre>
    <a href="#XSection">XSection</a> pp_to_ppll(
      <span class="type">double</span> collision_energy,
      <span class="type">double</span> mass,   <span class="comment">// of the produced particle</span>
      <span class="type">double</span> charge, <span class="comment">// of the produced partice</span>
      <a href="#Integrator">Integrator</a> = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>)
    )
    </pre>
    Differential cross section
    <math>
      <mtext>d</mtext>
      <mi>σ</mi>
      <mo>/</mo>
      <mtext>d</mtext>
      <msqrt>
      <mi>s</mi>
      </msqrt>
    </math>
    for the production of a fermion pair in ultraperipheral collisions of
    protons. Non-electromagnetic interactions of protons are neglected.
  </div>

  <div class="def">
    <pre>
    <a href="#XSection">XSection</a> pp_to_ppll(
      <span class="type">double</span> collision_energy,
      <span class="type">double</span> mass,   <span class="comment">// of the produced particle</span>
      <a href="#Integrator">Integrator</a> = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>)
    )
    </pre>
    Equivalent to above with <code>charge = 1</code>.
  </div>

  <div class="def">
    <pre>
    <a href="#XSection">XSection</a> pp_to_ppll(
      <span class="type">double</span> collision_energy,
      <span class="type">double</span> mass,    <span class="comment">// of the produced particle</span>
      <span class="type">double</span> charge   <span class="comment">// of the produced particle</span>
      <span class="type">double</span> pT_min   <span class="comment">// minimal transverse momentum of the produced particle</span>
      <span class="type">double</span> eta_max  <span class="comment">// maximal pseudorapidity of the produced particle</span>
      <span class="type">const</span> std::function&lt;<a href="#Integrator">Integrator</a> (<span class="type">unsigned</span>)&gt;&amp; integrator_generator = <a href="#default_integrator">default_integrator</a>,
      <span class="type">unsigned</span> integration_level
    )
    </pre>
    Differential fiducial cross section
    <math>
      <mtext>d</mtext>
      <mi>σ</mi>
      <mo>/</mo>
      <mtext>d</mtext>
      <msqrt> <mi>s</mi> </msqrt>
    </math>
    for the production of a fermion pair in ultraperipheral collisions of
    protons with the constraints 
    <math>
      <msub> <mi>p</mi> <mi>T</mi> </msub> <mo>&gt;</mo>
      <msub> <mi>p</mi> <mrow> <mi>T</mi> <mtext>min</mtext> </mrow> </msub>,
    </math>
    <math>
      <mrow> <mo>|</mo> <mi>η</mi> <mo>|</mo> </mrow>
      <mo>&lt;</mo>
      <msub> <mi>η</mi> <mtext>max</mtext> </msub>
    </math>
    where <math> <msub> <mi>p</mi> <mi>T</mi> </msub> </math> and <math>
    <mi>η</mi> </math> are the transverse momentum and pseudorapidity of the
    produced particle.
  </div>

  <div class="def">
    <pre>
    <a href="#XSection">XSection</a> pp_to_ppll(
      <span class="type">double</span> collision_energy,
      <span class="type">double</span> mass,    <span class="comment">// of the produced particle</span>
      <span class="type">double</span> pT_min   <span class="comment">// minimal transverse momentum of the produced particle</span>
      <span class="type">double</span> eta_max  <span class="comment">// maximal pseudorapidity of the produced particle</span>
      <span class="type">const</span> std::function&lt;<a href="#Integrator">Integrator</a> (<span class="type">unsigned</span>)&gt;&amp; integrator_generator = <a href="#default_integrator">default_integrator</a>,
      <span class="type">unsigned</span> integration_level
    )
    </pre>
    Equivalent to above with <code>charge = 1</code>.
  </div>
</div>

<div id="pp_to_ppll_b" class="def">
  <span class="def"><code>pp_to_ppll_b</code></span>
  <div class="def">
    <pre>
    <a href="#XSection">XSection</a> pp_to_ppll_b(
      <span class="type">double</span> collision_energy,
      <span class="type">double</span> mass,   <span class="comment">// of the produced particle</span>
      <span class="type">double</span> charge, <span class="comment">// of the produced partice</span>
      <a href="#Integrator">Integrator</a> = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>)
    )
    </pre>
    Differential cross section
    <math>
      <mtext>d</mtext>
      <mi>σ</mi>
      <mo>/</mo>
      <mtext>d</mtext>
      <msqrt> <mi>s</mi> </msqrt>
    </math>
    for the production of a fermion pair in ultraperipheral collisions of
    protons. Strong and electromagnetic interactions of protons are taken into
    account.
  </div>

  <div class="def">
    <pre>
    <a href="#XSection">XSection</a> pp_to_ppll_b(
      <span class="type">double</span> collision_energy,
      <span class="type">double</span> mass,   <span class="comment">// of the produced particle</span>
      <a href="#Integrator">Integrator</a> = <a href="#default_integrator">default_integrator</a>(<span class="literal">0</span>)
    )
    </pre>
    Equivalent to above with <code>charge = 1</code>.
  </div>

  <div class="def">
    <pre>
    <a href="#XSection">XSection</a> pp_to_ppll_b(
      <span class="type">double</span> collision_energy,
      <span class="type">double</span> mass,    <span class="comment">// of the produced particle</span>
      <span class="type">double</span> charge,  <span class="comment">// of the produced partice</span>
      <span class="type">double</span> pT_min,  <span class="comment">// minimal transverse momentum of the produced particle</span>
      <span class="type">double</span> eta_max, <span class="comment">// maximal pseudorapidity of the produced particle</span>
      <span class="type">const</span> std::function&lt;<a href="#Integrator">Integrator</a> (<span class="type">unsigned</span>)&gt;&amp; integrator_generator = <a href="#pp_to_ppll_b_integrator">pp_to_ppll_b_integrator</a>(<span class="literal">0</span>),
      <span class="type">unsigned</span> integration_level = <span class="literal">0</span>
    )
    </pre>
    Fiducial cross section
    <math>
      <mtext>d</mtext>
      <mi>σ</mi>
      <mo>/</mo>
      <mtext>d</mtext>
      <msqrt> <mi>s</mi> </msqrt>
    </math>
    for the production of a fermion pair in ultraperipheral collisions of
    protons. Strong and electromagnetic interactions of protons are taken into
    account.
  </div>

  <div class="def">
    <pre>
    <a href="#XSection">XSection</a> pp_to_ppll_b(
      <span class="type">double</span> collision_energy,
      <span class="type">double</span> mass,    <span class="comment">// of the produced particle</span>
      <span class="type">double</span> pT_min,  <span class="comment">// minimal transverse momentum of the produced particle</span>
      <span class="type">double</span> eta_max, <span class="comment">// maximal pseudorapidity of the produced particle</span>
      <span class="type">const</span> std::function&lt;<a href="#Integrator">Integrator</a> (<span class="type">unsigned</span>)&gt;&amp; integrator_generator = <a href="#pp_to_ppll_b_integrator">pp_to_ppll_b_integrator</a>(<span class="literal">0</span>),
      <span class="type">unsigned</span> integration_level = <span class="literal">0</span>
    )
    </pre>
    Equivalent to above with <code>charge = 1</code>.
  </div>
</div>

<div id="pp_to_ppll_b_integrator" class="def">
  <span class="def"><code>pp_to_ppll_b_integrator</code></span>
  <pre>
    std::function&lt;<a href="#Integrator">Integrator</a> (<span class="type">unsigned</span>)&gt; pp_to_ppll_b_integrator(<span class="type">unsigned</span> level = <span class="literal">0</span>);
  </pre>
  Default integrator for <a href="#pp_to_ppll_b">pp_to_ppll_b</a>. Uses CQUAD for integration level <code>level</code> and QAG for other levels.
</div>

  </body>
</html>
